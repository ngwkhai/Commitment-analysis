sha,author,author_date,committer,committer_date,message,year,month
9903f11cc3a4face9e4690d8b40af966ea84c3d1,Luc Leray,2023-12-21 19:21:53+00:00,GitHub,2023-12-21 19:21:53+00:00,"[examples] Fix `ERR_PNPM_OUTDATED_LOCKFILE` when deploying SvelteKit example (#10984)

Currently, [the SvelteKit (v1)](https://vercel.com/new/clone?b=main&s=https%3A%2F%2Fgithub.com%2Fvercel%2Fvercel%2Ftree%2Fmain%2Fexamples%2Fsveltekit-1&showOptionalTeamCreation=false&template=sveltekit-1&teamCreateStatus=hidden) example fails with:
```
ERR_PNPM_OUTDATED_LOCKFILE‚Äâ Cannot install with ""frozen-lockfile"" because pnpm-lock.yaml is not up to date with package.json
```

This fixes the lockfile, and therefore fixes the example.

---

As a side-quest, I also fixed the ""unmet peer"" warnings:
```
‚îî‚îÄ‚î¨ @vercel/style-guide 4.0.2
  ‚îú‚îÄ‚îÄ ‚úï unmet peer eslint@^8.24.0: found 8.14.0
  ‚îú‚îÄ‚îÄ ‚úï unmet peer prettier@^2.7.0: found 2.6.2
  ‚îî‚îÄ‚î¨ eslint-plugin-unicorn 43.0.2
    ‚îî‚îÄ‚îÄ ‚úï unmet peer eslint@>=8.18.0: found 8.14.0
```",2023,12
04f5f3f3d2f14399124d8bc1cc3b4e34c73b05f6,Luc Leray,2023-12-21 19:04:26+00:00,GitHub,2023-12-21 19:04:26+00:00,"[examples] Fix TypeScript error in ionic react example (#10985)

The ionic react build currently fails with:
```
$ react-scripts build
09:06:23.084 | Creating an optimized production build...
09:06:45.231 | Failed to compile.
09:06:45.231 | ¬†
09:06:45.232 | /vercel/path0/node_modules/@types/babel__traverse/index.d.ts
09:06:45.232 | TypeScript error in /vercel/path0/node_modules/@types/babel__traverse/index.d.ts(314,13):
09:06:45.232 | Type expected.  TS1110
09:06:45.232 | ¬†
09:06:45.232 | 312 \|         // too complex for TS. So we type it as a general visitor only if the key contains `\|`
09:06:45.232 | 313 \|         // this is good enough for non-visitor traverse options e.g. `noScope`
09:06:45.232 | > 314 \|         [k: `${string}\|${string}`]: VisitNode<S, Node>;
09:06:45.232 | \|             ^
09:06:45.232 | 315 \|     };
09:06:45.232 | 316 \|
09:06:45.232 | 317 \| export type VisitNode<S, P extends Node> = VisitNodeFunction<S, P> \| VisitNodeObject<S, P>;
09:06:45.232
```

Upgrading to TypeScript 4 fixes the issue.

---------

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,12
5e3c077b6b99166f4d7f3652b4d7581f9ee7d3d5,Trek Glowacki,2023-12-21 17:01:52+00:00,GitHub,2023-12-21 17:01:52+00:00,"[static-build] update ionic/angular to latest v7 (#10986)

update ionic/angular to latest v7. Needed to add and `overrides` entry.
Some packages just specify angular >= 14 and this bumps us to angular
17, which we're not ready for yet.",2023,12
2cc2fac8195790969cd31ff09ebc32cd6df15144,Trek Glowacki,2023-12-21 16:17:38+00:00,GitHub,2023-12-21 16:17:38+00:00,"Revert #10980 (#10989)

Undoes #10980 (mostly). This appears to be some kind of caching issue. Works locally until you run `eslint` without `--cache` and then it will reproduce. Hopefully this is the last time and we're not playing whack-a-mole with these pragmas every day?",2023,12
c536a74bc9e7188a87b292615fa88d6fc506b105,Seiya Nuta,2023-12-21 10:11:34+00:00,GitHub,2023-12-21 10:11:34+00:00,"[node] Await waitUntil promises to resolve before exiting (#10915)

Say you have a middleware (`middleware.js`) that looks like this:

```js
export async default function middleware(req, ctx) {
  ctx.waitUntil(tooLongFunction())
}

async function tooLongFunction() {
  console.log('tooLongFunction started')
  await new Promise((resolve) => setTimeout(resolve, 10000))
  console.log('tooLongFunction finished')
}
```

When you run this middleware locally with `vercel dev`, you won't see the `tooLongFunction finished` message because the server process is killed right after finishing the response. While Edge Runtime's `server.close()`, which awaits all `waitUntil` promises, is called, but `exit-hook`'s callback in CLI doesn't wait for the `close` promise to resolve.

This PR fixes this by allowing an optional graceful shutdown callback instead of killing the process immediately.",2023,12
838d56c31caaf4a57435aa33e75f2144fe8fe2ec,Trek Glowacki,2023-12-20 21:25:04+00:00,GitHub,2023-12-20 21:25:04+00:00,"[static-build] Add Angular 17 fixture (#10969)

Add Angular 17 fixture",2023,12
77585013dec5fc406b8b7ea00918e49fdb8f10ec,Nathan Rajlich,2023-12-20 19:35:12+00:00,GitHub,2023-12-20 19:35:12+00:00,"[go] Remove `VERCEL_USE_GO_PROVIDED_RUNTIME` env var check (#10968)

Feature flag has been rolled out for long enough now. Remove this check.",2023,12
44569e692933f853c4c7cd7055a19bb5997a4957,Trek Glowacki,2023-12-20 18:14:10+00:00,GitHub,2023-12-20 18:14:10+00:00,"Remove unneeded global directives (#10980)

An update to latest `turbo` somehow made these no longer required? ü§∑

---------

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,12
6194e8ca8daabd0cc5fd8a9c8691730cc7dbd78c,Vercel Release Bot,2023-12-20 14:34:34+00:00,GitHub,2023-12-20 14:34:34+00:00,"Version Packages (#10971)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,12
7b0adf371bae64d33ed0a1b966fc50b1f7c9639b,Wyatt Johnson,2023-12-19 21:03:18+00:00,GitHub,2023-12-19 21:03:18+00:00,"[next] App Pages Prerender Manifest Update (#10978)

Previously routes that did not have a `dataRoute` key in the `prerender-manifest.json` would be treated as an App Route. The logic has been updated (for partial prerendering support) to also consider the new `prefetchDataRoute`. Entries with either of these keys are treated as an App Page instead of an App Route.

This also addressed the scenerio where a app route (`route.ts`) with a dynamic segment (`/api/[slug]/route.ts`) which doesn't emit a `.body` during build doesn't cause the build to fail by checking for the file first.",2023,12
471bdd5b4506f1410afd7bca6efae3bc696cd939,S3Prototype,2023-12-19 20:29:59+00:00,GitHub,2023-12-19 20:29:59+00:00,"Update nuxt logo (#10977)

We're using an out of date Nuxt logo, and the team has requested an update. This PR updates it",2023,12
67fa2f3dd6a6d5a3504b7f9081e56deff7b36eab,Nathan Rajlich,2023-12-18 23:45:45+00:00,GitHub,2023-12-18 23:45:45+00:00,"[build-utils] Extend Node v16 discontinue date to 2024-06-15 (#10967)

AWS has extended the discontinue date for `nodejs16.x` Lambda runtime, so we will follow suit.",2023,12
b67b97023b884a5a37fad420945979e2683d1e6f,Vercel Release Bot,2023-12-18 19:25:56+00:00,GitHub,2023-12-18 19:25:56+00:00,"Version Packages (#10944)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@33.0.0

### Major Changes

- [cli] replace `--deprecated` with `--update-required` in `vc project
ls` ([#10965](https://github.com/vercel/vercel/pull/10965))

### Patch Changes

- Fix `vercel bisect` selecting too many deployments
([#10956](https://github.com/vercel/vercel/pull/10956))

- Updated dependencies
\[[`6a9002f22`](https://github.com/vercel/vercel/commit/6a9002f2296c5ccce4522c0fa9a8938c3d7a4849),
[`4d63d9e95`](https://github.com/vercel/vercel/commit/4d63d9e954549d811063d259250d1865b7de2ba1)]:
    -   @vercel/remix-builder@2.0.15
    -   @vercel/build-utils@7.4.0
    -   @vercel/static-build@2.0.15
    -   @vercel/node@3.0.13

## @vercel/build-utils@7.4.0

### Minor Changes

- Adds new helper `getPathForPackageManager()`
([#10918](https://github.com/vercel/vercel/pull/10918))

## @vercel/client@13.0.11

### Patch Changes

- Updated dependencies
\[[`4d63d9e95`](https://github.com/vercel/vercel/commit/4d63d9e954549d811063d259250d1865b7de2ba1)]:
    -   @vercel/build-utils@7.4.0

## @vercel/gatsby-plugin-vercel-builder@2.0.13

### Patch Changes

- Add support for ""rewrites""
([#10954](https://github.com/vercel/vercel/pull/10954))

- Updated dependencies
\[[`4d63d9e95`](https://github.com/vercel/vercel/commit/4d63d9e954549d811063d259250d1865b7de2ba1)]:
    -   @vercel/build-utils@7.4.0

## @vercel/node@3.0.13

### Patch Changes

- Updated dependencies
\[[`4d63d9e95`](https://github.com/vercel/vercel/commit/4d63d9e954549d811063d259250d1865b7de2ba1)]:
    -   @vercel/build-utils@7.4.0

## @vercel/remix-builder@2.0.15

### Patch Changes

- Update `@remix-run/dev` fork to v2.4.0
([#10943](https://github.com/vercel/vercel/pull/10943))

## @vercel/static-build@2.0.15

### Patch Changes

- Updated dependencies
\[[`652a31275`](https://github.com/vercel/vercel/commit/652a3127533974c426ea8e5b1047af1aecddb57e)]:
    -   @vercel/gatsby-plugin-vercel-builder@2.0.13

## @vercel-internals/types@1.0.18

### Patch Changes

- Updated dependencies
\[[`4d63d9e95`](https://github.com/vercel/vercel/commit/4d63d9e954549d811063d259250d1865b7de2ba1)]:
    -   @vercel/build-utils@7.4.0

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,12
9146885f80f342c18671b3bc1c28e08cb217c2f1,Ethan Arrowood,2023-12-18 19:10:07+00:00,GitHub,2023-12-18 19:10:07+00:00,"[cli] replace `--deprecated` with `--update-required` in `vc project ls` (#10965)

Replaces the new `--deprecated` option with `--update-required` in the `vc project ls` command.",2023,12
98bc41d49a58c0b932bbd355138ba372b8b25a55,Mitch (a.k.a Voz),2023-12-18 16:59:19+00:00,GitHub,2023-12-18 16:59:19+00:00,"fix: Doc links in auth files (#10955)

Fixed the links in the auth files to reflect what the doc links currently are.",2023,12
a38c102208204b27b63de85a7048fff7200749e4,Vercel Release Bot,2023-12-18 16:39:28+00:00,GitHub,2023-12-18 16:39:28+00:00,"[tests] Upgrade Turbo to version 1.11.2 (#10960)

This auto-generated PR updates Turbo to version 1.11.2",2023,12
211c74a7d2a3a65fa2a7a4bcf1cf0154067a394d,Trek Glowacki,2023-12-15 18:58:29+00:00,GitHub,2023-12-15 18:58:29+00:00,"[static-build] Add vite@5 test fixture (#10953)

Add vite@5 test fixture",2023,12
2a40ff564e5ae25e735893c4d29b6b81827dbf37,Trek Glowacki,2023-12-15 18:32:14+00:00,GitHub,2023-12-15 18:32:14+00:00,"[static-build] update ember-v5 fixture to latest minor (#10957)

Update ember-v5 fixture to latest minor.",2023,12
d4cf2b9ae6c168d81d0a6f83bdee3024302b9896,Trek Glowacki,2023-12-15 18:07:55+00:00,GitHub,2023-12-15 18:07:55+00:00,"[static-build] Update astro-v3 to fixture to latest (#10952)

Update astro-v3 to fixture to latest",2023,12
7695316cd4150170b8fa31a99473b5bdf746f3d0,Trek Glowacki,2023-12-15 16:22:00+00:00,GitHub,2023-12-15 16:22:00+00:00,"[examples] Update sveltekit1 fixture to latest 1.x (#10948)

Update sveltekit1 fixture to latest 1.x",2023,12
7ecb146fdb82a18997ffd00f208e8a6fd947c0c6,Trek Glowacki,2023-12-15 09:02:18+00:00,GitHub,2023-12-15 09:02:18+00:00,"[examples] Update ionic-react to latest (#10949)

Update ionic-react example to latest minor of its current major.",2023,12
ec3d6ad640b2f5ba313b133e7502e97b2b4a1a05,Trek Glowacki,2023-12-15 08:38:45+00:00,GitHub,2023-12-15 08:38:45+00:00,"[static-build] Update storybook-v7 fixture to latest (#10951)

Update storybook-v7 fixture to latest",2023,12
5d521af586e0691c8b61b3138bf159b64d9d5be1,Nathan Rajlich,2023-12-15 08:17:29+00:00,GitHub,2023-12-15 08:17:29+00:00,[cli] Fix `vc bisect` selecting too many deployments (#10956),2023,12
652a3127533974c426ea8e5b1047af1aecddb57e,Nathan Rajlich,2023-12-15 01:08:07+00:00,GitHub,2023-12-15 01:08:07+00:00,"[gatsby-plugin-vercel-builder] Add support for ""rewrites"" (#10954)",2023,12
bd516c505b3d30b92dcef294dd9809f876efd37b,Trek Glowacki,2023-12-14 17:18:43+00:00,GitHub,2023-12-14 17:18:43+00:00,"[static-build] Update test fixture stencil-v4 to latest (#10950)

Update test fixture stencil-v4 to latest",2023,12
4d63d9e954549d811063d259250d1865b7de2ba1,Felix Haus,2023-12-14 15:17:20+00:00,GitHub,2023-12-14 15:17:20+00:00,"[build-utils] Add getPathForPackageManager  (#10918)

To use this outside of CLI we want a way to suppress the `console.log`s in `getEnvForPackageManager`.
For achieving this, we introduce a new helper `getPathForPackageManager()` which contains the core logic.

Best to review commit by commit + hide whitespace.

**X-Ref**
- [Internal Context](https://vercel.slack.com/archives/C03F2CMNGKG/p1701970097725689)",2023,12
6a9002f2296c5ccce4522c0fa9a8938c3d7a4849,Vercel Release Bot,2023-12-14 04:05:10+00:00,GitHub,2023-12-14 04:05:10+00:00,"[remix] Update `@remix-run/dev` to v2.4.0 (#10943)

This auto-generated PR updates `@remix-run/dev` to version 2.4.0.",2023,12
2829d541b80c9deb6e3ccdb62b50ccb709912bba,Vercel Release Bot,2023-12-13 14:46:11+00:00,GitHub,2023-12-13 14:46:11+00:00,Version Packages (#10939),2023,12
6880dcb3c34f2a621cecb8f44273770c3ab71c05,Ethan Arrowood,2023-12-13 07:22:10+00:00,GitHub,2023-12-13 07:22:10+00:00,"[cli] Use new `deprecated` query param in projects api for `vc project ls --deprecated` (#10938)

Uses the new `deprecated` query param for the GET /projects API instead of client-side filtering.

This enables a better UX so that results are properly paginated. 

Here are some example runs:

Pagination works as expected:
<img width=""831"" alt=""Screenshot 2023-12-12 at 20 59 57"" src=""https://github.com/vercel/vercel/assets/16144158/c592752d-bf49-41a0-8dae-8b8e233052f8"">

Usage without the flag results in different output (as expected!)
<img width=""830"" alt=""Screenshot 2023-12-12 at 21 04 52"" src=""https://github.com/vercel/vercel/assets/16144158/c65461e0-b4a0-4725-aaae-a63739e6c8e9"">",2023,12
832ba4b69a4618765ab4172e17b6975c1d8b593f,Trek Glowacki,2023-12-12 21:08:12+00:00,GitHub,2023-12-12 21:08:12+00:00,"[tests] Add ""Summary"" Step to release workflow (#10936)",2023,12
9a250d528c82caa58785567ef9abd7fd6aedf1ce,Vercel Release Bot,2023-12-12 17:31:23+00:00,GitHub,2023-12-12 17:31:23+00:00,"Version Packages (#10935)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@32.7.1

### Patch Changes

- [cli] double page limit for vc project ls --deprecated
([#10932](https://github.com/vercel/vercel/pull/10932))

- Updated dependencies
\[[`d09dd1794`](https://github.com/vercel/vercel/commit/d09dd1794b5ffa28c15d3ad2880b90db2f4c06f0)]:
    -   @vercel/remix-builder@2.0.14

## @vercel/remix-builder@2.0.14

### Patch Changes

- Reinstall dependencies during `prepareCache()`
([#10922](https://github.com/vercel/vercel/pull/10922))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,12
382ff2f526a04e5b16a0c861ca2243d90f5ef6f6,Vercel Release Bot,2023-12-12 16:52:07+00:00,GitHub,2023-12-12 16:52:07+00:00,"[tests] Update Gatsby fixture versions (#10931)

Automatically generated PR to update Gatsby fixture versions in
`@vercel/static-build`

---------

Co-authored-by: Ethan Arrowood <ethan.arrowood@vercel.com>",2023,12
f80a59c73fbab90981abc15e87292611518e766f,Ethan Arrowood,2023-12-12 15:27:25+00:00,GitHub,2023-12-12 15:27:25+00:00,"[cli] double page limit for vc project ls --deprecated (#10932)

As titled. Increases api page size for `vc project ls` when
`--deprecated` is used.

This is a temporary workaround since we do the filtering ""client-side"".
We will eventually update the API itself to support this and then we can
remove the client-based filter and reduce the page limit back to the
ideal `20`.

---------

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,12
d09dd1794b5ffa28c15d3ad2880b90db2f4c06f0,Nathan Rajlich,2023-12-12 00:41:51+00:00,GitHub,2023-12-12 00:41:51+00:00,"[remix] Reinstall dependencies during `prepareCache()` (#10922)

https://github.com/vercel/vercel/pull/10819 introduced a bug causing the `prepareCache()` function to fail (due to `@remix-run/dev` no longer being require-able). Even if it were not failing, the deps installed are not a valid representation of the user's `package.json` / lockfile. So to have more truthful cache contents, run `npm install` once again during `prepareCache()` to fix both issues at the same time.",2023,12
ab34a262054d34999796b80629b413d0ee8abc86,Zack Tanner,2023-12-12 00:24:43+00:00,GitHub,2023-12-12 00:24:43+00:00,"[tests] fix brittle next rewrite probe test (#10934)

It seems the intention of this test was to verify that the rewritten
file matches the original file, but it does so by just asserting on
arbitrary script text, which is brittle and broke as a result of
https://github.com/vercel/next.js/pull/56294

The right way to test this would be to fetch the original script and
compare the contents with the rewritten script, but this relies on
`__NEXT_SCRIPT__` magic which is only available in probe checks. For now
this just asserts on a valid status code, as a chunk that isn't properly
rewritten should 404 in this case.",2023,12
7582571d943b1e5cfa2cea01b03493eee78c135f,Vercel Release Bot,2023-12-11 16:39:34+00:00,GitHub,2023-12-11 16:39:34+00:00,"Version Packages (#10913)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,12
e6aaf79d04fafd032d9a28143b02d28766add415,John Pham,2023-12-08 19:25:42+00:00,GitHub,2023-12-08 19:25:42+00:00,"Update Next.js screenshot preview (#10921)

This new screenshot matches the template. It removes the version number
so this screenshot will not go stale.",2023,12
a1df25a197f5562dea7735c885f4adfba298cde4,Ethan Arrowood,2023-12-08 17:55:24+00:00,GitHub,2023-12-08 17:55:24+00:00,"[cli] Clean up `project ls --deprecate` (#10926)

Follow up to #10919

Removes console.log statements and changes log into warning.",2023,12
dfe47f6e6c1d395ae24d802f4b7c98e39b9f90f4,Ethan Arrowood,2023-12-08 17:09:18+00:00,GitHub,2023-12-08 17:09:18+00:00,"[cli] add `--deprecated` option to `vc project ls` command (#10919)

Adds a `--deprecated` option to the `vc project ls` command that will only show projects currently running on a soon-to-be-deprecated Node.js version.

It also adds additional output providing more information to the user about what versions and a link to our documentation so they can learn more.

Example:

<img width=""836"" alt=""Screenshot 2023-12-07 at 15 01 22"" src=""https://github.com/vercel/vercel/assets/16144158/3b7f7b13-802e-4af1-a76e-a158a477beb4"">",2023,12
3a584316956d97865c4d6b930055b7fa522657f3,Vercel Release Bot,2023-12-08 10:17:39+00:00,GitHub,2023-12-08 10:17:39+00:00,"[examples][tests] Upgrade Next.js to version 14.0.4 (#10923)

This auto-generated PR updates 7 packages to Next.js version 14.0.4",2023,12
204c3592c78fc544e62f0210b0e7e1e4cd382a0c,Vercel Release Bot,2023-12-07 01:29:54+00:00,GitHub,2023-12-07 01:29:54+00:00,"[remix] Update `@remix-run/dev` to v2.3.1 (#10908)

This auto-generated PR updates `@remix-run/dev` to version 2.3.1.",2023,12
3cede43ca7ea3aec3ff33864b7d33da57891ddb2,Nathan Rajlich,2023-12-07 01:28:17+00:00,GitHub,2023-12-07 01:28:17+00:00,[ruby] Remove `VERCEL_ALLOW_RUBY32` env var check (#10910),2023,12
1dbb22bb6d33657faa78376f527fe350188c5257,Nathan Rajlich,2023-12-07 00:57:10+00:00,GitHub,2023-12-07 00:57:10+00:00,[ruby] Use Ruby 3.2 in test fixtures (#10909),2023,12
f124779b35bce740e61a8797e4a547d4b9ba068b,Matt Straka,2023-12-02 19:23:03+00:00,GitHub,2023-12-02 19:23:03+00:00,Update README.md (#10898),2023,12
371c7a08f2b79a69c64f818fd26313e8d9ca41d7,Vercel Release Bot,2023-12-01 19:43:49+00:00,GitHub,2023-12-01 19:43:49+00:00,Version Packages (#10896),2023,12
447c20fb99de5b7709641541b48ced0343e38352,Ethan Arrowood,2023-12-01 19:39:07+00:00,GitHub,2023-12-01 19:39:07+00:00,"Add GitHub Runner Image Version to turbo-cache-key.json (#10887)

Add GitHub Runner Image Version to turbo-cache-key.json",2023,12
0fe8c07194631b64cb054de5819032dbb69c0dbf,Nathan Rajlich,2023-12-01 19:35:04+00:00,GitHub,2023-12-01 19:35:04+00:00,"[cli] Revert ""forbids globally installed @vercel/speed-insights and @vercel/analytics (#10848)"" (#10895)

This reverts commit 6afdd7fb0b6172ae3a37e60162d9e9f1e8a7098e.",2023,12
78d1d548d910de9b6edd2107d53262fdf48557d7,Vercel Release Bot,2023-11-30 19:01:27+00:00,GitHub,2023-11-30 19:01:27+00:00,Version Packages (#10865),2023,11
c41ff450c0420047a3e6988dd964647fb81520f6,Trek Glowacki,2023-11-29 14:15:17+00:00,GitHub,2023-11-29 14:15:17+00:00,"[cli] Fix behavior for combination of northstar user + team scope provided to cli as an argument. (#10884)

Fixes a neat little bug with the intersection of northstar users, teams, and the behavior of `Array#find_index`:

When selecting an org for various cli actions _non_ northstar users will see a select list with their user in the 0th position, and their teams in the 1..nth positions, like so:

```
// user: Logan
// teams: [Avengers, X-Men]
‚óã Logan
‚óã Avengers
‚óã X-Men
``` 

We'd like to preselect either a team referenced in `client.config.currentTeam` or if said team cannot be found in the collection of a user's teams, preselect the user. So if `X-Men` is `currentTeam`, we find that item (element `1` in the teams array) and increment that value by `1` to account for the user being element `0` in the list of choices:

```
// currentTeam: X-Men
// user: Logan
// teams: [Avengers, X-Men]
‚óã Logan
‚óã Avengers
‚óè X-Men
``` 

If we _can't_ find the `currentTeam` in the list of teams (or one isn't provided), `Array#find_index` returns `-1`, which we increment to by `1` to get the 0th element in the list of choices:

```
// currentTeam: undefined
// user: Logan
// teams: [Avengers, X-Men]
‚óè Logan
‚óã Avengers
‚óã X-Men
``` 

Neat trick!

However, Northstar users _don't_ use the user account as the 0th element in the list of choices. Northstar users will in fact have a team that represents a hidden default team with the same name as their `user.name` and this will be the 0th element in their teams:

```
// user: Logan
// teams: [Logan, Avengers, X-Men]
‚óã Logan
‚óã Avengers
‚óã X-Men
``` 

This of course means the trick of `+1` to index of the team selects the wrong item _and_ can result in `undefined` in cases where the `currentTeam` references the last team.

```
// currentTeam: X-Men
// user: Logan
// teams: [Logan, Avengers, X-Men]
‚óã Logan
‚óã Avengers
‚óã X-Men
``` 

‚óè how'd we get out here?!?! üëÄ 

To address the issue this PR:
1. calls `findIndex` on the array of _choices_ checking for matches to `currentTeam`
2. wraps that in `Math.max` to set to `0` if `find_index` returns `-1` when a `currentTeam` can't be found.",2023,11
ca2cbf06fbf252e23aff6e007d0df5ffc243b56e,Chris Barber,2023-11-28 23:22:36+00:00,GitHub,2023-11-28 23:22:36+00:00,[remix] Resolve static dir using non-parent `publicPath` segments (#10685),2023,11
2d86a2d4ba109176b8152925101cc45b07371b81,Trek Glowacki,2023-11-28 23:21:32+00:00,GitHub,2023-11-28 23:21:32+00:00,"[tests] tidy and make select-org tests more realistic (#10882)

Tracking down a bug with ""northstar"" users and have a little prefactor that 

a) isolates setup code so it's less repeated
b) makes the ""northstar"" tests more reflective of actual execution.

Northstar users will always have a `currentTeam` value on their `client.config`:

https://github.com/vercel/vercel/blob/aa0f3d712b6be4aa1af2f28acb0f4c7a6cdf9f16/packages/cli/src/util/get-scope.ts#L18-L20

And finally c) add tests for the case of a non-northstar users where a team scope is supplied.

The final hypothetical matching group (northstart users with team scope provided) is the bug that I'll fix with a refactor.",2023,11
4edfcd74b6dfd8e9cbc05a71d47578051a2a7d63,Nathan Rajlich,2023-11-28 22:41:39+00:00,GitHub,2023-11-28 22:41:39+00:00,"[remix] Fix issue where `npm install` was not properly injecting forked compiler (#10819)

User reported a scenario in which npm was ignoring the second `npm install` command to replace the Remix compiler with our forked version. This seems like a bug in npm. Workaround that seems to work is to remove `@remix-run/dev` entirely and install our forked version as a ""standard"" dependency (instead of using the `npm:` syntax). The `bin` entry for `remix` should at that point be our forked compiler.",2023,11
c52bdf77585dfa41b25cabe2f9403827d0964169,Nathan Rajlich,2023-11-28 22:38:37+00:00,GitHub,2023-11-28 22:38:37+00:00,"[go] Set Lambda runtime to ""provided.al2"" behind env var (#10880)

This is a re-land of https://github.com/vercel/vercel/pull/10856, but with the addition of the env var check so that we can feature flag this change.",2023,11
bc5ac1ec508998432cf134e2d7f01fd0efb4e11d,Nathan Rajlich,2023-11-28 18:49:02+00:00,GitHub,2023-11-28 18:49:02+00:00,"[static-build] Add `yarn.lock` and force jsdom@22 to fix ""umi-v2"" test fixture  (#10881)

`jsdom@23` does not work with Node 16, but UmiJS v2 does not work with Node 18. So use the lower common denominator and force a older version of jsdom that still works with 16.x.",2023,11
aa0f3d712b6be4aa1af2f28acb0f4c7a6cdf9f16,Lee Robinson,2023-11-28 01:40:30+00:00,GitHub,2023-11-28 01:40:30+00:00,"chore: update Nuxt example (#10869)

This updates the default Nuxt example to start with a static route, plus
updates dependencies with the latest version.

Demo: https://nuxt-vercel-inky.vercel.app/

---------

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,11
e02212ae80af095abc1a660f39e4646c7763aca9,Csaba Palfi,2023-11-28 00:38:02+00:00,GitHub,2023-11-28 00:38:02+00:00,Fix changeset lint for forks (#10737),2023,11
a8934da6232b66a98e9ce43ebf5342eac664d40d,Lee Robinson,2023-11-27 16:54:49+00:00,GitHub,2023-11-27 16:54:49+00:00,"Update placeholder for Nuxt to be correct command. (#10873)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,11
0e9bb30fd285492beadc365bece2ab1df67b387b,Vercel Release Bot,2023-11-27 14:56:18+00:00,GitHub,2023-11-27 14:56:18+00:00,"[tests] Update Gatsby fixture versions (#10875)

Automatically generated PR to update Gatsby fixture versions in `@vercel/static-build`",2023,11
6afdd7fb0b6172ae3a37e60162d9e9f1e8a7098e,Damien Simonin Feugas,2023-11-22 08:29:40+00:00,GitHub,2023-11-22 08:29:40+00:00,[cli] forbids globally installed @vercel/speed-insights and @vercel/analytics (#10848),2023,11
fdef0339f2d4a6d55507ad7c52fe91721e291467,Vercel Release Bot,2023-11-21 21:59:05+00:00,GitHub,2023-11-21 21:59:05+00:00,Version Packages (#10861),2023,11
4636ae54c6c17709c1a058169cdca19c3df73ddb,Nathan Rajlich,2023-11-21 21:57:23+00:00,GitHub,2023-11-21 21:57:23+00:00,"[ruby] Enable `ruby3.2` runtime (#10859)

Allows for Ruby 3.2 Serverless Functions to be created.

**Note:** New test fixtures will be added after this is deployed to production.",2023,11
61a23f13824d6b6c836cedc0e78e32003ae483fb,Nathan Rajlich,2023-11-21 21:13:24+00:00,GitHub,2023-11-21 21:13:24+00:00,"Revert ""[go] Set Lambda runtime to `provided.al2`"" (#10864)

This reverts commit 4b8b4992c4524eb8bb97e90a72c137e329dbbeb1.

We'll re-land this after Thanksgiving.",2023,11
4b8b4992c4524eb8bb97e90a72c137e329dbbeb1,Nathan Rajlich,2023-11-21 19:29:53+00:00,GitHub,2023-11-21 19:29:53+00:00,"[go] Set Lambda runtime to ""provided.al2"" (#10856)

Migrate from the deprecated `go1.x` runtime to the `provided.al2` runtime, [as suggested by AWS in their migration guide](https://aws.amazon.com/blogs/compute/migrating-aws-lambda-functions-from-the-go1-x-runtime-to-the-custom-runtime-on-amazon-linux-2/).",2023,11
611fbdd5ac55c74f58388f831a452c26de2ecbc0,Zack Tanner,2023-11-21 16:21:56+00:00,GitHub,2023-11-21 16:21:56+00:00,"Revert ""[cli][tests] Work around Yarn + Corepack issue in tests"" (#10860)",2023,11
ffd2f34c6c3d53bbb673aa3241845abc50e67c5e,Zack Tanner,2023-11-21 00:44:46+00:00,GitHub,2023-11-21 00:44:46+00:00,"[next] ensure function configs apply to route groups (#10855)

`getSourceFilePathFromPage` attempts to match patterns found in `vercel.json` with source files. However, the `page` argument to this function is stripped of route groups, so these files are erroneously skipped and function settings are not applied. 

For app-dir routes which might contain route groups, this checks an internal mapping which maps the ""normalized"" paths (e.g. `app/dashboard/[slug]/page.js`) to the file-system path (e.g. `app/dashboard/[slug]/(group)/page.js`)",2023,11
8feaa9c3b35fae5f7aa5b475c08b362d273f8765,Nathan Rajlich,2023-11-20 21:47:39+00:00,GitHub,2023-11-20 21:47:39+00:00,"[cli][tests] Work around Yarn + Corepack issue in tests (#10858)

CI started failing on corepack related tests with error:

```
error This project's package.json defines ""packageManager"": ""yarn@npm@8.1.0"". However the current global version of Yarn is 1.22.21.
```

This appears to be a bug in the Yarn v1.22.21, which was released a week ago: https://github.com/yarnpkg/yarn/releases/tag/v1.22.21

Setting the `SKIP_YARN_COREPACK_CHECK` env var disables this new check which fixes the issue for us.

**NOTE:** Review with [whitespace changes disabled](https://github.com/vercel/vercel/pull/10858/files?w=1) for an easier view.",2023,11
31daff66affc115e0a3087b9dfefd28230c83e8b,Vercel Release Bot,2023-11-19 18:54:04+00:00,GitHub,2023-11-19 18:54:04+00:00,[examples][tests] Upgrade Next.js to version 14.0.3 (#10847),2023,11
48c6b2dcc3bb4817498efcee5daa80037c162af2,Simon H,2023-11-19 04:43:16+00:00,GitHub,2023-11-19 04:43:16+00:00,"[docs] mention nodejs20.x in LambdaRuntime (#10849)

The error message when trying to deploy with an invalid runtime value
leads you there, where `nodejs20.x` is missing currently",2023,11
6f3ae1a0edb89c5e263bcff17b8fb1d72660acd8,Vercel Release Bot,2023-11-16 05:19:35+00:00,GitHub,2023-11-16 05:19:35+00:00,"Version Packages (#10836)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,11
88da7463ce12df91d49fbde85cb617030d55f558,Nathan Rajlich,2023-11-15 22:04:36+00:00,GitHub,2023-11-15 22:04:36+00:00,"[build-utils] Remove Node v20 env var check (#10834)

It's safe to remove this env var check, because #10822 makes it explicit on which versions of Node are actually present in the build environment.",2023,11
142aa55a5d884e358c4bc5df6438f17618be102a,Ethan Arrowood,2023-11-15 20:12:05+00:00,GitHub,2023-11-15 20:12:05+00:00,"Add .node-version file (#10820)

This a small QOL change. Essentially if you have a tool like `fnm` on your machine for using multiple versions of Node.js, they will look for files like this one and automatically switch your terminal session node version to the value in it. 

The `vercel/front` repo uses this too",2023,11
7bc8b65d13bb1b4c71b4b55ed8c9d9c418fde460,Vercel Release Bot,2023-11-15 00:45:19+00:00,GitHub,2023-11-15 00:45:19+00:00,"Version Packages (#10832)

This PR was opened by the [Changesets release](https://github.com/changesets/action) GitHub action. When you're ready to do a release, you can merge this and the packages will be published to npm automatically. If you're not ready to do a release yet, that's fine, whenever you add more changesets to main, this PR will be updated.


# Releases
## @vercel/build-utils@7.2.4

### Patch Changes

-   Select Node.js version based on what's available in build-container ([#10822](https://github.com/vercel/vercel/pull/10822))

## vercel@32.5.4

### Patch Changes

-   Updated dependencies \[[`65dec5b7e`](https://github.com/vercel/vercel/commit/65dec5b7e752f4da8fe0ffdb25215170453f6f8b)]:
    -   @vercel/build-utils@7.2.4
    -   @vercel/node@3.0.10
    -   @vercel/static-build@2.0.11

## @vercel/client@13.0.8

### Patch Changes

-   Updated dependencies \[[`65dec5b7e`](https://github.com/vercel/vercel/commit/65dec5b7e752f4da8fe0ffdb25215170453f6f8b)]:
    -   @vercel/build-utils@7.2.4

## @vercel/gatsby-plugin-vercel-builder@2.0.10

### Patch Changes

-   Updated dependencies \[[`65dec5b7e`](https://github.com/vercel/vercel/commit/65dec5b7e752f4da8fe0ffdb25215170453f6f8b)]:
    -   @vercel/build-utils@7.2.4

## @vercel/node@3.0.10

### Patch Changes

-   Updated dependencies \[[`65dec5b7e`](https://github.com/vercel/vercel/commit/65dec5b7e752f4da8fe0ffdb25215170453f6f8b)]:
    -   @vercel/build-utils@7.2.4

## @vercel/static-build@2.0.11

### Patch Changes

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@2.0.10

## @vercel-internals/types@1.0.15

### Patch Changes

-   Updated dependencies \[[`65dec5b7e`](https://github.com/vercel/vercel/commit/65dec5b7e752f4da8fe0ffdb25215170453f6f8b)]:
    -   @vercel/build-utils@7.2.4",2023,11
65dec5b7e752f4da8fe0ffdb25215170453f6f8b,Nathan Rajlich,2023-11-14 23:08:27+00:00,GitHub,2023-11-14 23:08:27+00:00,"[build-utils] Select Node.js version based on what's available in build-container (#10822)

Makes `getLatestNodeVersion()` and `getSupportedNodeVersion()` (and thus by extension - `getNodeVersion()`) be aware of the available Node.js versions when running inside the build-container. This is to address the situation with the new AL2023 build-container image which has different Node versions installed compared to the existing AL2 build image.

### Project Settings `20.x` with package.json `""engines"": ""18.x""`

If the Project Settings Node Version is set to `20.x`, but the package.json has `""engines"": ""18.x""`, then the build will fail like so, because Node 18 is not present on the AL2023 build image:

<img width=""1044"" alt=""Screenshot 2023-11-09 at 1 25 41 PM"" src=""https://github.com/vercel/vercel/assets/71256/572c544b-6574-4eb1-98f7-787075a60000"">

### Project Settings `18.x` with package.json `""engines"": ""20.x""`

If the Project Settings Node Version is set to `18.x`, but the package.json has `""engines"": ""20.x""`, then the build will fail like so, because Node 20 is not present on the AL2 build image:

<img width=""1042"" alt=""Screenshot 2023-11-09 at 1 34 43 PM"" src=""https://github.com/vercel/vercel/assets/71256/c6a2d955-9453-4ef5-a99d-b49a6d9af766"">

### Project Settings `18.x` with no package.json `""engines""`

If Project Settings Node Version is set to `18.x`, but the package.json has no ""engines"" (and thus wants ""latest""), then the latest available Node version in the build-container, which would be Node 18.",2023,11
f3b62d8ea2e5e2475dcc52dcd1aeb55f9bb61fbc,Brooks Lybrand,2023-11-13 20:10:57+00:00,GitHub,2023-11-13 20:10:57+00:00,"chore: Update Remix example README (#10830)

Not sure the best spot to put this command in the Readme, but I thought having a `create-remix` command might be useful for people trying to get going.

If there's a more preferred way to scaffold this project on your machine, I'm open to that, just using what I know",2023,11
9472c22bf7192da264bcff8184ab651d3e726a49,Wyatt Johnson,2023-11-09 23:45:35+00:00,GitHub,2023-11-09 23:45:35+00:00,"[next] Added more PPR tests (#10823)

This adds additional regression tests for PPR support for Next.js.",2023,11
493185709aa9a1ceedeaad021bb677f1ecefabd8,Vercel Release Bot,2023-11-08 17:36:37+00:00,GitHub,2023-11-08 17:36:37+00:00,"Version Packages (#10809)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@32.5.3

### Patch Changes

- Handle `TooManyProjects` error in places where projects are created
([#10807](https://github.com/vercel/vercel/pull/10807))

- Updated dependencies
\[[`89c1e0323`](https://github.com/vercel/vercel/commit/89c1e032335d9ec0fcfc84fe499cf004fe73fafc),
[`fd29b966d`](https://github.com/vercel/vercel/commit/fd29b966d39776318b0e11a53909edb43d1fc5f2)]:
    -   @vercel/node@3.0.9
    -   @vercel/next@4.0.14

## @vercel/next@4.0.14

### Patch Changes

- Fixed headers for static routes when PPR is enabled
([#10808](https://github.com/vercel/vercel/pull/10808))

## @vercel/node@3.0.9

### Patch Changes

- Replace usage of `fetch` with `undici.request`
([#10767](https://github.com/vercel/vercel/pull/10767))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,11
89c1e032335d9ec0fcfc84fe499cf004fe73fafc,Ethan Arrowood,2023-11-08 17:31:03+00:00,GitHub,2023-11-08 17:31:03+00:00,"[node] swap `undici.fetch` for `undici.request` in `serverless-handler.mts`  (#10767)

In a recent undici update, setting the `host` header for fetch requests became invalid (https://github.com/nodejs/undici/pull/2322). 

We relied on this in order to proxy serverless dev server requests via `@vercel/node`. 

This PR replaces the usage of `undici.fetch` with `undici.request`. 

It is blocked by an `undici` type change: https://github.com/nodejs/undici/pull/2373",2023,11
ebd7e3ac391d1eb6e2d4312e5fe6dae9c7d76a5b,Zach Ward,2023-11-08 16:48:12+00:00,GitHub,2023-11-08 16:48:12+00:00,"Project limits error handling (#10807)

This PR adds improved error handling for the 200 project limit error
that will start being returned for free tier teams/accounts. The
following changes have been made:
- improve error message format by using `client.output.prettyError` so
that the docs link
(https://vercel.com/docs/limits/overview#general-limits) returned with
the error response is included with the error message
- add explicit error handling of this error from any places where
`createProject` is called, which includes the following commands:
  - `vc project add`
  - `vc link` (indirectly called via `ensureLink`)
  - `vc list` (indirectly called via `ensureLink`)
  - `vc git connect` (indirectly called via `ensureLink`)

### Testing
- sign in to a vercel account that is associated with your work email
(ends in `@vercel.com`), this is necessary for creating a team with the
proper conditions to artificially trigger the error message
- create a Pro Trial team and make sure to prefix the name with:
`vtest314 too many projects `, for example `vtest314 too many projects
test 1`
- check out this branch and cd to `vercel/vercel/packages/cli`
- run: `pnpm dev add [project-name] --cwd=/path/to/some/project`
- the project should fail to be created and you should see the expected
error message (screenshot below) in the terminal output

**Screenshot of error message when attempting to add project from cli**
<img width=""798"" alt=""image""
src=""https://github.com/vercel/vercel/assets/14896430/43e6ac2c-ae1c-4367-8d57-0aeb7fbddf33"">

---------

Co-authored-by: Nathan Rajlich <n@n8.io>",2023,11
fd29b966d39776318b0e11a53909edb43d1fc5f2,Wyatt Johnson,2023-11-08 16:21:51+00:00,GitHub,2023-11-08 16:21:51+00:00,"tests: added tests for PPR (#10808)

This adds some tests to the PPR implementation for Next.js. This also
fixes a bug where the static pages were incorrectly generating a header
that falsly indicated that it postponed.",2023,11
2bd92164039764732fa12d78895fda4ed832c0ec,Vercel Release Bot,2023-11-07 19:20:58+00:00,GitHub,2023-11-07 19:20:58+00:00,"Version Packages (#10805)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@32.5.2

### Patch Changes

- Updated dependencies
\[[`c94a082f6`](https://github.com/vercel/vercel/commit/c94a082f6bb1b84eaf420ac47ea83640dc83668e)]:
    -   @vercel/next@4.0.13

## @vercel/next@4.0.13

### Patch Changes

- Added `getRequestHandlerWithMetadata` export
([#10753](https://github.com/vercel/vercel/pull/10753))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,11
c94a082f6bb1b84eaf420ac47ea83640dc83668e,Wyatt Johnson,2023-11-07 18:32:03+00:00,GitHub,2023-11-07 18:32:03+00:00,"Added `getRequestHandlerWithMetadata` export (#10753)

This adds a new `getRequestHandlerWithMetadata` export if enabled and
available to the exported method.

---------

Co-authored-by: Joe Haddad <timer@vercel.com>
Co-authored-by: JJ Kasper <jj@jjsweb.site>",2023,11
66cd626d1c8ca5b39c2cd34446bc14f878ca9001,Vercel Release Bot,2023-11-07 17:51:39+00:00,GitHub,2023-11-07 17:51:39+00:00,"Version Packages (#10765)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## @vercel/build-utils@7.2.3

### Patch Changes

- Add experimental flag to allow Node.js v20
([#10802](https://github.com/vercel/vercel/pull/10802))

## vercel@32.5.1

### Patch Changes

- Debug log load user exceptions
([#10773](https://github.com/vercel/vercel/pull/10773))

- bump: edge-runtime
([#10712](https://github.com/vercel/vercel/pull/10712))

- Updated dependencies
\[[`fc90a3dc0`](https://github.com/vercel/vercel/commit/fc90a3dc0bd998453f6527c03d211c35bb0d5770),
[`644b8a52c`](https://github.com/vercel/vercel/commit/644b8a52cb2cc8f05e215e2230f95f902cdf8ae8),
[`0861dc8fb`](https://github.com/vercel/vercel/commit/0861dc8fbcea1037626b00664a4b6c22f1b0a7ed),
[`33cc8e0ac`](https://github.com/vercel/vercel/commit/33cc8e0acf1b3466d50d45b2e5bbe66b89a87c14),
[`f5296c3c0`](https://github.com/vercel/vercel/commit/f5296c3c06e620a39c5f88287ac94e58703bdaac),
[`d9065c210`](https://github.com/vercel/vercel/commit/d9065c2102223e9cdb5b22df14db41c363cf7828)]:
    -   @vercel/next@4.0.12
    -   @vercel/node@3.0.8
    -   @vercel/build-utils@7.2.3
    -   @vercel/remix-builder@2.0.11
    -   @vercel/static-build@2.0.10

## @vercel/client@13.0.7

### Patch Changes

- Updated dependencies
\[[`0861dc8fb`](https://github.com/vercel/vercel/commit/0861dc8fbcea1037626b00664a4b6c22f1b0a7ed)]:
    -   @vercel/build-utils@7.2.3

## @vercel/edge@1.1.1

### Patch Changes

- bump: edge-runtime
([#10712](https://github.com/vercel/vercel/pull/10712))

## @vercel/error-utils@2.0.2

### Patch Changes

- use Node.js `util.types.isNativeError` for `isError` method
([#10764](https://github.com/vercel/vercel/pull/10764))

## @vercel/frameworks@2.0.3

### Patch Changes

- update Angular output path discovery
([#10678](https://github.com/vercel/vercel/pull/10678))

- Updated dependencies
\[[`34dd9c091`](https://github.com/vercel/vercel/commit/34dd9c0918585cf6d3b04bddd9158978b0b4192f)]:
    -   @vercel/error-utils@2.0.2

## @vercel/fs-detectors@5.1.3

### Patch Changes

- Updated dependencies
\[[`306f653da`](https://github.com/vercel/vercel/commit/306f653da9de96ddf583cce35603229aa55c4e53),
[`34dd9c091`](https://github.com/vercel/vercel/commit/34dd9c0918585cf6d3b04bddd9158978b0b4192f)]:
    -   @vercel/frameworks@2.0.3
    -   @vercel/error-utils@2.0.2

## @vercel/gatsby-plugin-vercel-builder@2.0.9

### Patch Changes

- Fix nested SSR routes
([#10751](https://github.com/vercel/vercel/pull/10751))

- Updated dependencies
\[[`0861dc8fb`](https://github.com/vercel/vercel/commit/0861dc8fbcea1037626b00664a4b6c22f1b0a7ed)]:
    -   @vercel/build-utils@7.2.3

## @vercel/next@4.0.12

### Patch Changes

- fix re-mapping logic for index prefetches
([#10750](https://github.com/vercel/vercel/pull/10750))

- Fixes a case where using `basePath` along with static generation would
output a lambda that conflicts with the root route.
([#10738](https://github.com/vercel/vercel/pull/10738))

- Rework prefetch route handling
([#10779](https://github.com/vercel/vercel/pull/10779))

## @vercel/node@3.0.8

### Patch Changes

- bump: edge-runtime
([#10712](https://github.com/vercel/vercel/pull/10712))

- Updated dependencies
\[[`0861dc8fb`](https://github.com/vercel/vercel/commit/0861dc8fbcea1037626b00664a4b6c22f1b0a7ed),
[`34dd9c091`](https://github.com/vercel/vercel/commit/34dd9c0918585cf6d3b04bddd9158978b0b4192f)]:
    -   @vercel/build-utils@7.2.3
    -   @vercel/error-utils@2.0.2

## @vercel/remix-builder@2.0.11

### Patch Changes

- Update `@remix-run/dev` fork to v2.2.0
([#10788](https://github.com/vercel/vercel/pull/10788))

## @vercel/static-build@2.0.10

### Patch Changes

- Updated dependencies
\[[`efd3cc05d`](https://github.com/vercel/vercel/commit/efd3cc05dcf3993a68eb2ac41f39d42ed905b036)]:
    -   @vercel/gatsby-plugin-vercel-builder@2.0.9

## @vercel-internals/types@1.0.14

### Patch Changes

- Updated dependencies
\[[`0861dc8fb`](https://github.com/vercel/vercel/commit/0861dc8fbcea1037626b00664a4b6c22f1b0a7ed)]:
    -   @vercel/build-utils@7.2.3

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,11
0861dc8fbcea1037626b00664a4b6c22f1b0a7ed,Nathan Rajlich,2023-11-07 13:43:29+00:00,GitHub,2023-11-07 13:43:29+00:00,"[build-utils] Add experimental flag to allow Node.js v20 (#10802)

Similar to #8836, but now for Node.js v20.",2023,11
7b553c70328ffee579b131032283211fccab8bb1,JJ Kasper,2023-11-07 05:04:29+00:00,GitHub,2023-11-07 05:04:29+00:00,"Disable deployment SSO protection for tests (#10799)

Our tests rely on not being behind deployment protection which is now enabled by default so this adds a step to tests to disable this setting to allow tests to continue working as expected.",2023,11
644b8a52cb2cc8f05e215e2230f95f902cdf8ae8,Kiko Beats,2023-11-06 08:58:22+00:00,GitHub,2023-11-06 08:58:22+00:00,bump: edge-runtime (#10712),2023,11
33cc8e0acf1b3466d50d45b2e5bbe66b89a87c14,Bryce Kalow,2023-11-03 20:25:56+00:00,GitHub,2023-11-03 20:25:56+00:00,"fix(next): do not generate conflicting lambdas when using basePath with app router (#10738)

When using `basePath` with statically generated routes, the builder
currently generates lambdas for the root route that conflict with the
prerender functions generated.

E.g. if we have `basePath: ""test""` and a root route at: `app/page.js`,
this is currently the output:

```
test
test.rsc
test/index
test/index.rsc
```

The result is that visiting the deployed app at `/test` renders an
incomplete page. On the other hand visiting `/test/index` outputs the
expected markup.

It seems like the intent is that we want to delete the lambdas that
conflict with the prerender functions. I've updated the lambda name
generation logic when doing the deleting to line up with how the lambda
names are generated initially.",2023,11
c0efce29adcc0508f194f35e9510ebe081947fbc,Steven,2023-10-31 23:01:48+00:00,GitHub,2023-10-31 23:01:48+00:00,chore: remove styfle from codeowners (#10790),2023,10
b4d115b24ad54419549d6b5be59425f327aff78e,Ethan Arrowood,2023-10-31 21:08:28+00:00,GitHub,2023-10-31 21:08:28+00:00,[error-utils] fix jest coverage issue (#10789),2023,10
34dd9c0918585cf6d3b04bddd9158978b0b4192f,Ethan Arrowood,2023-10-31 19:39:30+00:00,GitHub,2023-10-31 19:39:30+00:00,"[error-utils] use Node.js `util.types.isNativeError` for `isError` method (#10764)

I recently learned about https://nodejs.org/api/util.html#utiltypesisnativeerrorvalue which is pretty great. It will return `true` for all errors including subclasses (`class MyError extends Error {}`)",2023,10
f5296c3c06e620a39c5f88287ac94e58703bdaac,JJ Kasper,2023-10-31 18:15:13+00:00,GitHub,2023-10-31 18:15:13+00:00,"Rework prefetch route handling (#10779)

Follow-up to https://github.com/vercel/vercel/pull/10750 this removes the underscore prefetching from all prefetch outputs and instead only applies it to the index route itself as this causes issues with PPR making these outputs prerenders and being able to interpolate the route param values. 

There is the edge case of a user returning the literal value `index` from `generateStaticParams` but we can tolerate that more than ppr not working as expected.",2023,10
d9065c2102223e9cdb5b22df14db41c363cf7828,Vercel Release Bot,2023-10-31 17:59:35+00:00,GitHub,2023-10-31 17:59:35+00:00,"[remix] Update `@remix-run/dev` to v2.2.0 (#10788)

This auto-generated PR updates `@remix-run/dev` to version 2.2.0.",2023,10
0ad37829dafadb73da26f925df39dca9612e747f,Vercel Release Bot,2023-10-30 14:12:31+00:00,GitHub,2023-10-30 14:12:31+00:00,"[tests] Update Gatsby fixture versions (#10745)

Automatically generated PR to update Gatsby fixture versions in `@vercel/static-build`",2023,10
67748b520798e629a8c7d6906a1ac22a28b30fde,Vercel Release Bot,2023-10-29 15:59:56+00:00,GitHub,2023-10-29 15:59:56+00:00,"[examples][tests] Upgrade Next.js to version 14.0.0 (#10774)

This auto-generated PR updates 7 packages to Next.js version 14.0.0",2023,10
306f653da9de96ddf583cce35603229aa55c4e53,Alan Agius,2023-10-27 13:54:24+00:00,GitHub,2023-10-27 13:54:24+00:00,Update Angular output path discovery (#10678),2023,10
9e2120a32599f83f54a308ca1cf5373671c7dd40,Chris Barber,2023-10-26 16:12:16+00:00,GitHub,2023-10-26 16:12:16+00:00,"[cli] Debug log load user exceptions (#10773)

When `getUser(client)` throws an exception, the actual error is never printed. This is useful information, so we should write it to the debug log output.",2023,10
a6463d26368f37775dfcb44e9f3422de403e6002,Vercel Release Bot,2023-10-26 15:55:22+00:00,GitHub,2023-10-26 15:55:22+00:00,"[tests] Upgrade Turbo to version 1.10.16 (#10744)

This auto-generated PR updates Turbo to version 1.10.16",2023,10
429a111b50834895e661986475b30675cbd70b0d,Trek Glowacki,2023-10-26 15:30:56+00:00,GitHub,2023-10-26 15:30:56+00:00,[tests] Add package-lock.json file to dev-server-and-routes vc dev fixture (#10771),2023,10
431dde5fa88bb04884d9a702514d698f70d11ade,Trek Glowacki,2023-10-25 14:19:23+00:00,GitHub,2023-10-25 14:19:23+00:00,[tests] Migrate docusaurus vc dev test to package-lock.json file (#10769),2023,10
1f09979c6f36e6f6962abac07677a0cfe4ccefd8,Trek Glowacki,2023-10-24 22:12:11+00:00,GitHub,2023-10-24 22:12:11+00:00,"[examples] Migrate hydrogen example from yarn.lock to package-lock.json (#10766)

This example occasionally fails with `ERROR: Command ""yarn install""
exited with 1 at nowDeploy`. We've noticed errors at the yarn registry
being a root cause of lots of tests failures. This migrates the example
to use the npm registry instead.

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,10
fc90a3dc0bd998453f6527c03d211c35bb0d5770,Zack Tanner,2023-10-24 20:51:55+00:00,GitHub,2023-10-24 20:51:55+00:00,"[next] fix re-mapping logic for index prefetches (#10750)

Follow-up to https://github.com/vercel/vercel/pull/10734 -- but considers that the static prefetch associated with `/` might be inside of a dir such as `index/index.prefetch.rsc`. 

To avoid any future matching conflicts, this PR updates to prefix all static prefetches",2023,10
57541e230d7c72c90b8fe76c2288ab37dc4aa20b,Trek Glowacki,2023-10-24 20:33:04+00:00,GitHub,2023-10-24 20:33:04+00:00,"[examples] Update Saber to use npm registry (#10755)

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,10
efd3cc05dcf3993a68eb2ac41f39d42ed905b036,Nathan Rajlich,2023-10-24 20:15:46+00:00,GitHub,2023-10-24 20:15:46+00:00,"[gatsby-plugin-vercel-builder] Fix nested SSR routes (#10751)

Fixes SSR / DSG pages that are nested deeper than the root path for Gatsby projects.

Also introduces unit tests for the logic related to determining which page name to use.",2023,10
a732b64c02895fff0458313d7ce93d7b1496368c,Trek Glowacki,2023-10-24 17:44:53+00:00,GitHub,2023-10-24 17:44:53+00:00,[examples][tests] Update fixture test names to be concretely named (#10752),2023,10
f8320417a8b92f2e7f27da99771ae0b7ea28227e,Zack Tanner,2023-10-24 16:41:54+00:00,GitHub,2023-10-24 16:41:54+00:00,"[next] replace `next export` with `output: export` in tests (#10756)

`next export` has been deprecated on the latest Next.js canary so these
tests will no longer pass.

This changes it to use `output: export` from `next.config.js` instead.

---------

Co-authored-by: JJ Kasper <jj@jjsweb.site>",2023,10
50791803b6467c3cc6c203c3fa248ff464ea3ea4,Trek Glowacki,2023-10-24 16:17:48+00:00,GitHub,2023-10-24 16:17:48+00:00,[examples] Migrate Sanity to use npm over yarn (#10754),2023,10
7504bfbe26779c963808bf4035749acf8692a743,Vercel Release Bot,2023-10-20 18:51:02+00:00,GitHub,2023-10-20 18:51:02+00:00,"Version Packages (#10668)

This PR was opened by the [Changesets release](https://github.com/changesets/action) GitHub action. When you're ready to do a release, you can merge this and the packages will be published to npm automatically. If you're not ready to do a release yet, that's fine, whenever you add more changesets to main, this PR will be updated.


# Releases
## vercel@32.5.0

### Minor Changes

-   Indicates whether @vercel/speed-insights or @vercel/analytics are used ([#10623](https://github.com/vercel/vercel/pull/10623))

-   [cli] update env var validation rule to allow name start with underscore ([#10697](https://github.com/vercel/vercel/pull/10697))

### Patch Changes

-   Updated dependencies \[[`da300030c`](https://github.com/vercel/vercel/commit/da300030c999b3555c608a321c9d0a4d36923a5a), [`de84743e1`](https://github.com/vercel/vercel/commit/de84743e10d4c9701d409355c0fe057f35e6e435), [`913608de4`](https://github.com/vercel/vercel/commit/913608de4dd4e37557533d732ca8449a5737d4a6), [`7fa08088e`](https://github.com/vercel/vercel/commit/7fa08088ea0d5df6955ea4af7f08513cf4027bb3)]:
    -   @vercel/next@4.0.11
    -   @vercel/python@4.1.0
    -   @vercel/remix-builder@2.0.10
    -   @vercel/redwood@2.0.5
    -   @vercel/static-build@2.0.9

## @vercel/python@4.1.0

### Minor Changes

-   Add support for pip3.10 and pip3.11 ([#10648](https://github.com/vercel/vercel/pull/10648))

## @vercel/routing-utils@3.1.0

### Minor Changes

-   Adds support for statusCode property on rewrites ([#10495](https://github.com/vercel/vercel/pull/10495))

## @vercel/client@13.0.6

### Patch Changes

-   Updated dependencies \[[`9e9fac019`](https://github.com/vercel/vercel/commit/9e9fac0191cb1428ac9e5479c3d5c8afd7b7d357)]:
    -   @vercel/routing-utils@3.1.0

## @vercel/fs-detectors@5.1.2

### Patch Changes

-   Updated dependencies \[[`9e9fac019`](https://github.com/vercel/vercel/commit/9e9fac0191cb1428ac9e5479c3d5c8afd7b7d357)]:
    -   @vercel/routing-utils@3.1.0

## @vercel/gatsby-plugin-vercel-builder@2.0.8

### Patch Changes

-   Updated dependencies \[[`9e9fac019`](https://github.com/vercel/vercel/commit/9e9fac0191cb1428ac9e5479c3d5c8afd7b7d357)]:
    -   @vercel/routing-utils@3.1.0

## @vercel/next@4.0.11

### Patch Changes

-   fix `build` in appDir on Windows ([#10708](https://github.com/vercel/vercel/pull/10708))

-   Fix RSC prefetch for index route with catch-all ([#10734](https://github.com/vercel/vercel/pull/10734))

## @vercel/redwood@2.0.5

### Patch Changes

-   Updated dependencies \[[`9e9fac019`](https://github.com/vercel/vercel/commit/9e9fac0191cb1428ac9e5479c3d5c8afd7b7d357)]:
    -   @vercel/routing-utils@3.1.0

## @vercel/remix-builder@2.0.10

### Patch Changes

-   Update `@remix-run/dev` fork to v2.1.0 ([#10732](https://github.com/vercel/vercel/pull/10732))

## @vercel/static-build@2.0.9

### Patch Changes

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@2.0.8

## @vercel-internals/types@1.0.13

### Patch Changes

-   Updated dependencies \[[`9e9fac019`](https://github.com/vercel/vercel/commit/9e9fac0191cb1428ac9e5479c3d5c8afd7b7d357)]:
    -   @vercel/routing-utils@3.1.0",2023,10
7fa08088ea0d5df6955ea4af7f08513cf4027bb3,Vercel Release Bot,2023-10-20 18:00:14+00:00,GitHub,2023-10-20 18:00:14+00:00,"[remix] Update `@remix-run/dev` to v2.1.0 (#10732)

This auto-generated PR updates `@remix-run/dev` to version 2.1.0.",2023,10
5d40da17babbf473dd0edacd0e236407dc4e668a,Chris Barber,2023-10-20 17:41:15+00:00,GitHub,2023-10-20 17:41:15+00:00,[python] Mock Python for tests running on machines without Python actually installed (#10742),2023,10
de84743e10d4c9701d409355c0fe057f35e6e435,JJ Kasper,2023-10-20 15:05:30+00:00,GitHub,2023-10-20 15:05:30+00:00,"Fix RSC prefetch for index route with catch-all (#10734)

When matching outputs and we have an `index.{ext}` file it will take priority over dynamic routes which we don't want to match prefetch RSC index outputs unless it's specifically a prefetch request so this remaps this specific file to avoid the overlap. 

x-ref: [slack thread](https://vercel.slack.com/archives/C061DMGDXQW/p1697664158904469?thread_ts=1697647520.783419&cid=C061DMGDXQW)",2023,10
39ce9166ba959159a8d6d13cd95ef70dc3e9dca1,JJ Kasper,2023-10-20 14:36:50+00:00,GitHub,2023-10-20 14:36:50+00:00,"Update to run Next.js integration with Node.js v18 (#10740)

Co-authored-by: Chris Barber <chris.barber@vercel.com>
Co-authored-by: Steven <steven@ceriously.com>",2023,10
ce54ca631bc4a64e46f2d8c39f37fc6059586c5c,Vercel Release Bot,2023-10-19 00:31:38+00:00,GitHub,2023-10-19 00:31:38+00:00,"[examples][tests] Upgrade Next.js to version 13.5.6 (#10735)

This auto-generated PR updates 7 packages to Next.js version 13.5.6",2023,10
d6ca05d97583b496ed8cd21929ac85fcc08cf19b,Ethan Arrowood,2023-10-18 14:40:56+00:00,GitHub,2023-10-18 14:40:56+00:00,"[static-build] remove old gatsby tests and merge into new gatsby-v2 (#10727)

Removes some old Gatsby tests and merge's their relevant probes into the newer `gatsby-v2` fixture. 

No point having 3 separate Gatsby v2 tests when they can all be in one.",2023,10
f8c893bb156d12284866c801dcd3e5fe3ef08e20,Chris Barber,2023-10-17 21:40:30+00:00,GitHub,2023-10-17 21:40:30+00:00,Add Zero Config Team to 'edge' codeowners (#10729),2023,10
5e6ef3d56984e8d2b86c5e810acd3023fa73a1ce,Chris Barber,2023-10-17 15:15:29+00:00,GitHub,2023-10-17 15:15:29+00:00,"Enable source maps in tests (#10725)

The `tsconfig` files were unified with a common configuration in https://github.com/vercel/vercel/pull/10667 including disabling source maps. The source maps greatly increase the distribution size, but they are invaluable when the tests run, so this PR enables source maps for tests including adding a `tsconfig.json` where absent.

Linear: https://linear.app/vercel/issue/ZERO-364/enable-sourcemaps-in-all-testtsconfigjson-files",2023,10
88715ad598e6a7bf2906953c0a33229c7341c1fe,Vercel Release Bot,2023-10-16 22:55:18+00:00,GitHub,2023-10-16 22:55:18+00:00,"[examples][tests] Upgrade Next.js to version 13.5.5 (#10718)

This auto-generated PR updates 7 packages to Next.js version 13.5.5",2023,10
ed19b26603ccdd0e5fac2d18a272b87f0d872a11,Trek Glowacki,2023-10-16 18:55:43+00:00,GitHub,2023-10-16 18:55:43+00:00,[cli] Migrate 30-next-image-optimization fixture to use npm install (#10720),2023,10
9c4589ed282b1cf7a3a79f16034f8b7ed1278047,Trek Glowacki,2023-10-16 17:33:13+00:00,GitHub,2023-10-16 17:33:13+00:00,"[cli] autoconfirm in CI to domain buys (#10703)

The `try to purchase a domain` CLI test starting failing on  11 October when the API became slightly slower to respond. This is because `vercel domains buy example.com` displays a prompt asking the user to `y` into agreeing to the purchase. We interacted with this in tests by spamming `y` on STDIN for a few seconds. The timing required is now a bit longer but I think we can skip that pattern entirely by passing the `--yes` option to the subcommand.

I don't _think_ we want this anywhere but in CI and let people unintentionally buy domains , so I've gated the use based on that, but happy to make it available always.

Ironically this issue went away on 13 October when the API response times improved and we could just unskip the test https://github.com/vercel/vercel/pull/10707",2023,10
da300030c999b3555c608a321c9d0a4d36923a5a,Zack Tanner,2023-10-16 14:57:38+00:00,GitHub,2023-10-16 14:57:38+00:00,"[next] fix `build` in appDir on windows (#10708)

On Windows, `globPath` is a non-POSIX path (ie `'favicon.ico\\route.js'`) which won't match the paths generated by the `glob` util, since it normalizes Windows separators to Unix separators ([ref](https://github.com/vercel/vercel/blob/main/packages/build-utils/src/fs/normalize-path.ts#L6-L8))",2023,10
90b14b689d4f136b0e97cd0a7752aebe29692430,Vercel Release Bot,2023-10-15 19:28:50+00:00,GitHub,2023-10-15 19:28:50+00:00,"[tests] Update Gatsby fixture versions (#10710)

Automatically generated PR to update Gatsby fixture versions in `@vercel/static-build`",2023,10
e0ed2d1e761b75eef32b3982b290a993d18dcb66,Ethan Arrowood,2023-10-13 19:34:08+00:00,GitHub,2023-10-13 19:34:08+00:00,"[static-build] update astro-v2 fixture (#10706)

Astro-v2 fixture was using the wrong major version",2023,10
e7516f8002c1bd5d3b2b0f3e2fdb4770db04a131,Shohei Maeda,2023-10-13 14:52:47+00:00,GitHub,2023-10-13 14:52:47+00:00,"[cli] update env var validation rule to allow name start with underscore (#10697)

internal ref: https://github.com/vercel/api/pull/20129

Vercel now accepts env var names that start with underscore.",2023,10
9e9fac0191cb1428ac9e5479c3d5c8afd7b7d357,Felix Haus,2023-10-13 10:03:36+00:00,GitHub,2023-10-13 10:03:36+00:00,"[routing-utils] Adds support for `statusCode` property on `rewrites` (#10495)

Allows to define a `statusCode` property on `rewrites` in the same way as we already have it for `redirects`.
This is still blocked internally as it requires a feature flag to build with that setting.

So it would allow to set the status in `vercel.json` like this:
```json
{
  ""rewrites"": [
    {
      ""source"": ""/*"",
      ""destination"": ""not-found.html"",
      ""statusCode"": 404
    }
  ]
}

```

Once released, I'll update the documentation on that as well.

### Requirements
> Cause once router sees a status code is set, it stops routing.
> So it wont run the `miss` and `rewrite` sections again once it has a status.
> So just need to make sure wherever status code is set, its at the end of its routing.
> [[internal ref](https://vercel.slack.com/archives/C01A2M9R8RZ/p1691594782351809?thread_ts=1691540814.244679&cid=C01A2M9R8RZ)]",2023,10
00f26b35713adbac9179c5c237364e63a0611046,Trek Glowacki,2023-10-13 00:54:18+00:00,GitHub,2023-10-13 00:54:18+00:00,[cli] Add lockfile mistakenly missed due to gitignore (#10699),2023,10
68b45167229adffce412ea4b8277ef16ac1b8133,Trek Glowacki,2023-10-12 22:22:46+00:00,GitHub,2023-10-12 22:22:46+00:00,"Remove svelte v5 fixture (#10698)

I originally created with following the instructions on the site `npm create svelte@latest` but got confused seeing a version `5.1.1` but that's for `create-svelte`, not `svelte` itself. It creates a svelte 4 app still.",2023,10
7bf7591dd383aca74dc94b40f6019be603ff99f6,Ethan Arrowood,2023-10-12 21:57:07+00:00,GitHub,2023-10-12 21:57:07+00:00,[static-build] add angular v16 (#10683),2023,10
a012a1e7496e8c20933ce34db2658405961493b4,Ethan Arrowood,2023-10-12 21:30:56+00:00,GitHub,2023-10-12 21:30:56+00:00,[static-build] ember-v5 (#10696),2023,10
6dbeb5c3eea819a3c961382857e8c7d965547a8d,Ethan Arrowood,2023-10-12 21:05:50+00:00,GitHub,2023-10-12 21:05:50+00:00,[static-build] stencil-v4 (#10695),2023,10
853a570384c3eda6e978a03a90418df9bef0a335,Ethan Arrowood,2023-10-12 20:42:34+00:00,GitHub,2023-10-12 20:42:34+00:00,[static-build] nuxt-v3 (#10694),2023,10
353a7ddfcd8fdcdb51447a4af84e9a1dfb74051b,Trek Glowacki,2023-10-12 20:25:56+00:00,GitHub,2023-10-12 20:25:56+00:00,Disable failing e2e test (#10700),2023,10
6fcbdb90c753f3f927b42fa975e0d04ffd9d0331,Ethan Arrowood,2023-10-12 18:20:25+00:00,GitHub,2023-10-12 18:20:25+00:00,[static-build] scully-v2 (#10693),2023,10
80a6960dc906aae113b7fe313f2e370e9451e05a,Ethan Arrowood,2023-10-11 23:25:12+00:00,GitHub,2023-10-11 23:25:12+00:00,[static-build] hydrogen-v2023 (#10688),2023,10
b52741b1bb045412b15723b5dc021dc2d9f2b5aa,Ethan Arrowood,2023-10-11 22:59:44+00:00,GitHub,2023-10-11 22:59:44+00:00,[static-build] blitz-v2 (#10690),2023,10
1d4c86d0f873a3c63267c4c462db208b98d75c4b,Ethan Arrowood,2023-10-11 22:35:18+00:00,GitHub,2023-10-11 22:35:18+00:00,[static-build] storybook-v7 (#10686),2023,10
913608de4dd4e37557533d732ca8449a5737d4a6,Chris Barber,2023-10-11 19:53:54+00:00,GitHub,2023-10-11 19:53:54+00:00,[python] Add support for pip3.10 and pip3.11 in `vc build` (#10648),2023,10
d595db6294c99ed8d3befe17d36f67dfcb74fe3b,Steven,2023-10-11 18:40:11+00:00,GitHub,2023-10-11 18:40:11+00:00,"[ci] update codeowners (#10691)

Remove styfle from a few examples and static-build",2023,10
ae489687d211b9130c9c6ee54193599c0d0c3ac4,Trek Glowacki,2023-10-11 14:06:10+00:00,Trek Glowacki,2023-10-11 14:06:10+00:00,"Revert ""Remove comment (testing branch protection)""

This reverts commit 6fc2872794b5b6e2464a214542ba92a3d9950171.",2023,10
6fc2872794b5b6e2464a214542ba92a3d9950171,Trek Glowacki,2023-10-10 23:04:31+00:00,Trek Glowacki,2023-10-10 23:04:31+00:00,Remove comment (testing branch protection),2023,10
6697a0e846beafbaf99087fc7635943f44d341b1,Ethan Arrowood,2023-10-10 22:52:47+00:00,GitHub,2023-10-10 22:52:47+00:00,[static-build] vite-v4 (#10675),2023,10
ed9ef486a80e8b71a55e0f10d661e6e6e1dd26cc,Ethan Arrowood,2023-10-10 22:44:10+00:00,Ethan Arrowood,2023-10-10 22:44:10+00:00,"Revert ""[static-build] hydrogen-v2023""

This reverts commit 213ec69db34bc6c010be25fdc74360d000130ae3.",2023,10
213ec69db34bc6c010be25fdc74360d000130ae3,Ethan Arrowood,2023-10-10 22:41:59+00:00,Ethan Arrowood,2023-10-10 22:41:59+00:00,[static-build] hydrogen-v2023,2023,10
7512bf64b1a94602a5484efaa6d39c70563b6675,Ethan Arrowood,2023-10-10 20:42:44+00:00,GitHub,2023-10-10 20:42:44+00:00,[static-build] hexo-v6 fixture (#10684),2023,10
00e12792d8e195c9579561b739ff60a94a5cecd2,Trek Glowacki,2023-10-10 19:54:49+00:00,GitHub,2023-10-10 19:54:49+00:00,"[static-build] Add basic Middleman v4 fixture (#10682)

Adding a new fixture for middleman. Currently missing.",2023,10
469d38aad80ee25f4085869b28e3e5d4b16df76c,Vercel Release Bot,2023-10-10 19:26:06+00:00,GitHub,2023-10-10 19:26:06+00:00,"[tests] Upgrade Turbo to version 1.10.15 (#10677)

This auto-generated PR updates Turbo to version 1.10.15",2023,10
0e84a6775d10d81fc02cee924328f0576dfb387e,Chris Barber,2023-10-10 17:58:36+00:00,GitHub,2023-10-10 17:58:36+00:00,"Run workflows using Node 16 (#10680)

Align the `lint` and `update-remix-run-dev` workflows to use Node 16 since all other workflows use Node 16.

Linear: https://linear.app/vercel/issue/ZERO-997/update-node-version-in-workflows",2023,10
3029af5a2bffbff018e7bba456b6997704f84e30,Trek Glowacki,2023-10-10 16:50:55+00:00,GitHub,2023-10-10 16:50:55+00:00,"[static-build] add umi-4 fixture (#10659)

Added new umi-v4 fixture by following the [new project directions for `npm`](https://umijs-org.translate.goog/docs/guides/getting-started?_x_tr_sl=auto&_x_tr_tl=en&_x_tr_hl=en&_x_tr_pto=wapp&_x_tr_hist=true)",2023,10
4422eee5c4a2bdc12b39014d7b0b9e929604a813,Trek Glowacki,2023-10-09 12:23:46+00:00,GitHub,2023-10-09 12:23:46+00:00,"Add vue-3 (#10660)

Adds a fixture test for vue@3",2023,10
222710f612800624037fd8bc6abba114403a00b7,Chris Barber,2023-10-09 11:58:23+00:00,GitHub,2023-10-09 11:58:23+00:00,"Add `type-check` and unify tsconfig (#10667)

This adds a new `pnpm type-check` that leverages `turbo` to validate the TypeScript code. This can be run at the top-level or for an individual package.

The `test-lint` workflow will run it after linting and doing the prettier check.

As apart of this effort, each package's `tsconfig.json` has been simplified. There's a new top-level `tsconfig.base.json` file that extends the Vercel Style Guide for TypeScript. Each package's `tsconfig.json` has been audited and previously suppressed rules that no longer apply have been removed. The result is each package's `tsconfig.json` is greatly simplified and we can control common settings in the base config while keeping the flexibility of package-level overrides.

Lastly, in `package/cli`, `pnpm build` calls `scripts/build.mjs` which calls `scripts/compile-templates.mjs`. The `compile-templates.mjs` file was generating invalid TypeScript code. I've fixed it and now it's happier than ever.

Note: In order to run `pnpm type-check`, you must first `pnpm build` because we need the `.d.ts` definition files.",2023,10
d8179032e26b4c6c30659d35b8c150d422336579,Ethan Arrowood,2023-10-06 17:07:27+00:00,GitHub,2023-10-06 17:07:27+00:00,"[static-build] add parcel v2 fixture (#10674)

Kinda simple. Not sure how else to improve this. Parcel is a pretty
basic build tool I think.",2023,10
f2d7f3f444e184dc0dddb2676f0009d0d9f583ce,Trek Glowacki,2023-10-05 21:05:12+00:00,GitHub,2023-10-05 21:05:12+00:00,Move existing framework fixtures to numeric-free prefix (#10670),2023,10
60929bb1afe39bdc5975e30e73806de08c543da8,Trek Glowacki,2023-10-05 18:55:51+00:00,GitHub,2023-10-05 18:55:51+00:00,"[static-build] Add fixtures for latest versions of tested frameworks (#10656)

Adds `preact@10`, `eleventy@2` and `jekyll@4` fixtures.",2023,10
4ef0b19508d958095bc9ecb721939382d7f9c505,Damien Simonin Feugas,2023-10-05 14:08:13+00:00,GitHub,2023-10-05 14:08:13+00:00,[cli] indicates whether @vercel/speed-insights or @vercel/analytics are used (#10623),2023,10
6041a3f6c87b5ce5d40d59ea333ad00283221d51,Trek Glowacki,2023-10-04 21:58:36+00:00,GitHub,2023-10-04 21:58:36+00:00,"[cli] Remove unused test helpers (#10663)

These helpers are unused in the project.",2023,10
5ee94e0dceedf950216394914de85ab390a95236,Trek Glowacki,2023-10-04 21:39:54+00:00,GitHub,2023-10-04 21:39:54+00:00,"[cli] Remove unused options to testFixtureStdio test helper (#10662)

Auditing for options use of `testFixtureStdio`:

* `{ skipDeploy: true }` is used frequently.
* `{ readyTimeout: 2000 }` is used once in `'[vercel dev] 08-hugo'`
* `{ projectSettings: { directoryListing: true } }` is used once in `'[vercel dev] 00-list-directory'`

Both `isExample` and `expectedCode` have stopped being used.",2023,10
9bc5bb4afc2656f958ce16405c6f4d9f702505e3,Trek Glowacki,2023-10-04 17:31:08+00:00,GitHub,2023-10-04 17:31:08+00:00,"[cli] Move from yarn to npm for fixtures and ensure lockfiles to speed up installs (#10619)

Some of our tests take quite some time to run and occasionally timeout when accessing https://yarnpkg.com/. We decided to make sure there is a lockfile for this _and_ just move over to `npm`. Shifting the `packages/cli` fixtures over in this PR.

I possibly missed one but I changed the install commands in tests and ran

* pnpm test
* pnpm test-unit
* pnpm test-dev
* pnpm test-e2e",2023,10
cf6152d16b4c3936396f3a8c30a0e7da16cd3d9f,Trek Glowacki,2023-10-04 16:04:39+00:00,GitHub,2023-10-04 16:04:39+00:00,"[static-build] Update existing fixtures to latest of their currently pinned framework dependency (#10652)

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,10
0f5ec80cc69023a90d48376567fa716f0085a2fe,Vercel Release Bot,2023-10-03 22:13:03+00:00,GitHub,2023-10-03 22:13:03+00:00,"Version Packages (#10647)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,10
c523a755f8e4bc41f7c353ebc0b939c21703df00,Steven,2023-10-03 22:07:56+00:00,GitHub,2023-10-03 22:07:56+00:00,"Revert ""[next] Correct output file tracing and limit calculation (#10631)"" (#10651)

This reverts commit e9026c7a692937122e60e73b91100cf7009e022d.

This was causing some builds using Turbo + Next.js to fail with:

```
...writing to cache...
--
17:02:42.820 | Traced Next.js server files in: 169.874ms
17:02:42.871 | Error: Config file was not found at ""/vercel/output/config.json""
17:02:42.871 | at f3 (/var/task/sandbox.js:239:2647)
17:02:42.872 | at async TCe (/var/task/sandbox.js:245:4681)
17:02:42.872 | at async WBt (/var/task/sandbox.js:261:1990)
17:02:42.872 | at async zBt (/var/task/sandbox.js:261:1791)
```

INC-442",2023,10
fa8e3132225de73ba007dee994de82c9925c8acd,Steven,2023-10-03 21:22:30+00:00,GitHub,2023-10-03 21:22:30+00:00,"[next] fix test missing `yarn.lock` file (#10642)

- Follow up to https://github.com/vercel/vercel/pull/10630

Was passing in the PR
https://github.com/vercel/vercel/actions/runs/6386018083/job/17332012211#step:9:269

But is failing on main
https://github.com/vercel/vercel/actions/runs/6386371621/job/17332970210

Looks like the `yarn.lock` was removed right before merging so this PR
adds it back.

INC-442",2023,10
0c1603f41bcea262bf1fe57a4c78f7cc718e8c6f,Trek Glowacki,2023-10-03 15:26:37+00:00,GitHub,2023-10-03 15:26:37+00:00,"[static-build] Add Svelte 5 fixture (#10645)

Adds Svelte 5 fixture for testing as we expand our test matrix. This is an updated version of `11-svelte`",2023,10
18b04b3589b7a0510d103069cf64dcaa65fdd12a,Trek Glowacki,2023-10-03 15:06:46+00:00,GitHub,2023-10-03 15:06:46+00:00,"[static-build] Add fixture for svelte 4 apps (#10637)

Adds Svelte 4 fixture for testing as we expand our test matrix. This is an updated version of `11-svelte`",2023,10
58215906f9ee28da3a7f2f3f4aeb862ab53bf55e,Jimmy Lai,2023-10-03 14:46:00+00:00,GitHub,2023-10-03 14:46:00+00:00,"next: bump minimal version for bundled server usage (#10646)

There was a bug that we caught in the bundled server when using the instrumentation hook that we fixed in https://github.com/vercel/next.js/pull/56318 . This PR bumps the version that we check so that we don't use it if the Next version is not up to date.",2023,10
1feb4d797e1c196c7b74953a8651e6a6f0eafb9f,Vercel Release Bot,2023-10-03 14:24:44+00:00,GitHub,2023-10-03 14:24:44+00:00,"[examples][tests] Upgrade Next.js to version 13.5.4 (#10643)

This auto-generated PR updates 5 packages to Next.js version 13.5.4

Co-authored-by: Steven <steven@ceriously.com>",2023,10
45ae16e37103860fa339bcf5d8b229d491ad084a,Vercel Release Bot,2023-10-03 11:38:27+00:00,GitHub,2023-10-03 11:38:27+00:00,"Version Packages (#10576)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@32.4.0

### Minor Changes

- Restore unsetting teamId for non-team accounts
([#10612](https://github.com/vercel/vercel/pull/10612))

### Patch Changes

- remove unused source map pkg
([#10577](https://github.com/vercel/vercel/pull/10577))

- disable source map for prod build
([#10575](https://github.com/vercel/vercel/pull/10575))

- Better rendering upon authentication error in `vc cert ls`
([#10551](https://github.com/vercel/vercel/pull/10551))

- Updated dependencies
\[[`e9026c7a6`](https://github.com/vercel/vercel/commit/e9026c7a692937122e60e73b91100cf7009e022d),
[`ea5bc8806`](https://github.com/vercel/vercel/commit/ea5bc8806276abf5ba14bdb4a966267497e5d14d),
[`a4996e1c5`](https://github.com/vercel/vercel/commit/a4996e1c5a7e6986d5410b662014dc584c0f7c54),
[`a18ed98f2`](https://github.com/vercel/vercel/commit/a18ed98f2df78fe1256410ea8676686564ed9b35),
[`2f5b0aeeb`](https://github.com/vercel/vercel/commit/2f5b0aeeb183ed3ea8cbc68cb3bc3c949c486ada),
[`09f1bbfa4`](https://github.com/vercel/vercel/commit/09f1bbfa41a87cf0063a3fb3022b7531d03862b5),
[`ce7e82fa7`](https://github.com/vercel/vercel/commit/ce7e82fa7aa6cec5f5d7b4953353b297b7ad1694)]:
    -   @vercel/next@4.0.9
    -   @vercel/go@3.0.3
    -   @vercel/build-utils@7.2.2
    -   @vercel/node@3.0.7
    -   @vercel/redwood@2.0.4
    -   @vercel/remix-builder@2.0.9
    -   @vercel/static-build@2.0.8

## @vercel/build-utils@7.2.2

### Patch Changes

- [cli] Update bun detection and add tests for projects with both
bunlock binary and yarn.lock text files
([#10583](https://github.com/vercel/vercel/pull/10583))

## @vercel/client@13.0.5

### Patch Changes

- Updated dependencies
\[[`2f5b0aeeb`](https://github.com/vercel/vercel/commit/2f5b0aeeb183ed3ea8cbc68cb3bc3c949c486ada)]:
    -   @vercel/build-utils@7.2.2

## @vercel/fs-detectors@5.1.1

### Patch Changes

- [cli] Update bun detection and add tests for projects with both
bunlock binary and yarn.lock text files
([#10583](https://github.com/vercel/vercel/pull/10583))

## @vercel/gatsby-plugin-vercel-builder@2.0.7

### Patch Changes

- Updated dependencies
\[[`2f5b0aeeb`](https://github.com/vercel/vercel/commit/2f5b0aeeb183ed3ea8cbc68cb3bc3c949c486ada)]:
    -   @vercel/build-utils@7.2.2

## @vercel/go@3.0.3

### Patch Changes

- Update broken documentation link
([#10579](https://github.com/vercel/vercel/pull/10579))

## @vercel/next@4.0.9

### Patch Changes

- Correct output file tracing and limit calculation
([#10631](https://github.com/vercel/vercel/pull/10631))

- Fix the instrumentation hook on Next.js Edge Functions
([#10608](https://github.com/vercel/vercel/pull/10608))

- [next] fix lambda creation for i18n edge pages
([#10630](https://github.com/vercel/vercel/pull/10630))

- Revert ""[next][node][redwood][remix] Update @vercel/nft (#10540)""
([#10633](https://github.com/vercel/vercel/pull/10633))

- Update `@vercel/nft` to 0.24.2
([#10644](https://github.com/vercel/vercel/pull/10644))

## @vercel/node@3.0.7

### Patch Changes

- Revert ""[next][node][redwood][remix] Update @vercel/nft (#10540)""
([#10633](https://github.com/vercel/vercel/pull/10633))

- Update `@vercel/nft` to 0.24.2
([#10644](https://github.com/vercel/vercel/pull/10644))

- Updated dependencies
\[[`2f5b0aeeb`](https://github.com/vercel/vercel/commit/2f5b0aeeb183ed3ea8cbc68cb3bc3c949c486ada)]:
    -   @vercel/build-utils@7.2.2

## @vercel/redwood@2.0.4

### Patch Changes

- Revert ""[next][node][redwood][remix] Update @vercel/nft (#10540)""
([#10633](https://github.com/vercel/vercel/pull/10633))

- Update `@vercel/nft` to 0.24.2
([#10644](https://github.com/vercel/vercel/pull/10644))

## @vercel/remix-builder@2.0.9

### Patch Changes

- Revert ""[next][node][redwood][remix] Update @vercel/nft (#10540)""
([#10633](https://github.com/vercel/vercel/pull/10633))

- Update `@vercel/nft` to 0.24.2
([#10644](https://github.com/vercel/vercel/pull/10644))

## @vercel/static-build@2.0.8

### Patch Changes

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@2.0.7

## @vercel-internals/types@1.0.12

### Patch Changes

- Updated dependencies
\[[`2f5b0aeeb`](https://github.com/vercel/vercel/commit/2f5b0aeeb183ed3ea8cbc68cb3bc3c949c486ada)]:
    -   @vercel/build-utils@7.2.2

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,10
ce7e82fa7aa6cec5f5d7b4953353b297b7ad1694,Ethan Arrowood,2023-10-03 11:15:00+00:00,GitHub,2023-10-03 11:15:00+00:00,"[next][node][redwood][remix] Update @vercel/nft 0.24.2 (#10644)

Updates nft to 0.24.2 fixing a broken feature",2023,10
e9026c7a692937122e60e73b91100cf7009e022d,JJ Kasper,2023-10-03 00:00:20+00:00,GitHub,2023-10-03 00:00:20+00:00,"[next] Correct output file tracing and limit calculation (#10631)

While investigating build times noticed that our lambda creation times were increasing linearly with the number of pages which is unexpected since there are mostly shared dependencies. After further investigation it seems we were falling back to our legacy manual `nodeFileTrace` calls in the builder when we shouldn't have been.

Also noticed we were still doing the un-necessary reading/calculating for uncompressed lambda sizes which is as discussed previously isn't required and the only limit we need to keep enforcing is the uncompressed size which is a lot less expensive to compute. 

As a further optimization this adds proper usage of our lstat cache/sema where it wasn't previously and proper parallelizing where applicable. 

These changes reduce tracing/lambda creation times by 3-5x in larger applications and can fix edge cases where we weren't leveraging our more accurate traces from the build. 

Before: 

```sh
Traced Next.js server files in: 444.05ms
Created all serverless functions in: 1:36.311 (m:ss.mmm)
Collected static files (public/, static/, .next/static): 241.47ms
```

After: 

```sh
Traced Next.js server files in: 10.4ms
Created all serverless functions in: 43.684s
Collected static files (public/, static/, .next/static): 250.828ms
```",2023,10
a18ed98f2df78fe1256410ea8676686564ed9b35,Csaba Palfi,2023-10-02 22:57:50+00:00,GitHub,2023-10-02 22:57:50+00:00,"[next] fix lambda creation for i18n edge pages (#10630)

An issue similar to https://github.com/vercel/next.js/issues/44381
exists whereby vercel creates lambda functions for edge pages when i18n
is configured.

Fixes https://github.com/vercel/next.js/issues/42854

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,10
09f1bbfa41a87cf0063a3fb3022b7531d03862b5,Sean Massa,2023-10-02 21:14:29+00:00,GitHub,2023-10-02 21:14:29+00:00,"Revert ""[next][node][redwood][remix] Update @vercel/nft"" (#10633)

This reverts commit ab329f0fe88e9cb72607d0cba41f5e168d77e077.

@TooTallNate confirmed with a user that this revert fixed their issue: https://github.com/orgs/vercel/discussions/4231#discussioncomment-7102952",2023,10
13efc4f04f79c87ac924e764911dbaddcc733f86,Trek Glowacki,2023-10-02 19:56:59+00:00,GitHub,2023-10-02 19:56:59+00:00,"[static-build] Add Astro 2.x fixture (#10634)

Adds Astro 2 fixture for testing as we expand our test matrix. Not sure what all probes we'd want beyond a ""did it work"" one.",2023,10
08c5a9b0fc8852c5beedb2ce3cf9c03a7d83226d,Trek Glowacki,2023-10-02 19:32:42+00:00,GitHub,2023-10-02 19:32:42+00:00,"[static-build] Add Astro 3.x fixture (#10632)

Adds Astro 3 fixture for testing as we expand our test matrix. Not sure what all probes we'd want beyond a ""did it work"" one.",2023,10
5349fb9181f79ab6491f15807a9e0719cd7e40b1,Trek Glowacki,2023-10-02 18:05:07+00:00,GitHub,2023-10-02 18:05:07+00:00,"[tests] *Also* run Determine HIT or MISS step regardless of sucess status (#10638)

The `if:` ""condition"" for ""Upload Test Report to Datadog"" will always be false if ""Determine Turbo HIT or MISS"" does not run.

Added a forced-fail test to verify:
<img width=""544"" alt=""CleanShot 2023-10-02 at 12 43 57@2x"" src=""https://github.com/vercel/vercel/assets/9736/ce18bfa4-9cc5-4eae-b223-04a4ca4cb009"">",2023,10
2f51171a173ad0d1c1763e0e46a80e036e88e343,Ethan Arrowood,2023-09-29 16:11:17+00:00,GitHub,2023-09-29 16:11:17+00:00,[tests] improve gatsby fixtures in static-build (#10620),2023,9
63c010a7f428dd8b2da0d3b2f32a7519f8064738,Trek Glowacki,2023-09-29 13:31:00+00:00,GitHub,2023-09-29 13:31:00+00:00,Move full GitHub Actions expression into curlies in test workflow (#10622),2023,9
7128a65ccd95a4accb2d8140a80fe04461c358c3,Trek Glowacki,2023-09-28 16:25:41+00:00,GitHub,2023-09-28 16:25:41+00:00,"[cli] Restore setting of `currentTeam` (#10612)

As part of a refactor in #10535, we lost the ‚Äì admittedly untested ‚Äì behavior of 

1. setting the new `teamId` from a login `result`
2. removing this value if it was `undefined` ensuring we didn't write `""currentTeam"": undefined` to `config.json`.

This resulted in subsequent calls to `vc login` keeping the last known defined `teamId`.

This should restore that behavior but also retain the behavior of calling `updateCurrentTeamAfterLogin` to check if the user has a new `defaultTeamId` to be stored.

Not a fan of just how much mutation exists on `client.config` in this flow, but that predates this change and I wanted to keep this bugfix as small as possible.",2023,9
d402c4350a25ef37d4600d2482f36772171b1b50,Ethan Arrowood,2023-09-28 15:29:39+00:00,GitHub,2023-09-28 15:29:39+00:00,"[tests] Reduce ionic fixture sizes to improve test timing (#10605)

This PR regenerates the ionic-angular and ionic-react fixtures to be significantly smaller and simpler. 

I don't know why the lock files are so massive. If anyone has ideas to reduce the size of those (I've tried ripping out a bunch of dependencies).",2023,9
f88afba733bb159b8e6d9cc132463bdadad6bac5,Trek Glowacki,2023-09-28 14:44:12+00:00,GitHub,2023-09-28 14:44:12+00:00,Report tests to DataDog even on failed runs (#10616),2023,9
ea5bc8806276abf5ba14bdb4a966267497e5d14d,Andrew Gadzik,2023-09-27 18:25:27+00:00,GitHub,2023-09-27 18:25:27+00:00,"[next] fix next.js edge functions that use the instrumentation hook (#10608)

Fixes a issue when a Next.js app uses app router + edge runtime + instrumentation hook deployed out on Vercel.  The issue is that the code to register the instrumentation hook in Next.js expects `_ENTRIES` to be defined on `globalThis`.

```ts
async function registerInstrumentation() {
  console.log(""'_ENTRIES' in globalThis:"", '_ENTRIES' in globalThis)
  console.log(
    '_ENTRIES.middleware_instrumentation:',
    Boolean(_ENTRIES.middleware_instrumentation)
  )
  console.log(
    '_ENTRIES.middleware_instrumentation.register:',
    Boolean(_ENTRIES.middleware_instrumentation.register)
  )

  if (
    '_ENTRIES' in globalThis &&
    _ENTRIES.middleware_instrumentation &&
    _ENTRIES.middleware_instrumentation.register
  ) {
    try {
      console.log('registering middleware instrumentation...')
      await _ENTRIES.middleware_instrumentation.register()
      console.log('registered middleware instrumentation!')
    } catch (err: any) {
      err.message = `An error occurred while loading instrumentation hook: ${err.message}`
      console.error(err)
      throw err
    }
  }
}
```

produced the following output,

![image](https://github.com/vercel/vercel/assets/1278714/d0a3a536-5579-4a63-a726-2e34a575e713)

This PR fixes this by changing `let _ENTRIES = {}'` to `globalThis._ENTRIES = {};`

![image](https://github.com/vercel/vercel/assets/1278714/7ba558ac-7364-4d91-869e-920662161022)",2023,9
eb06bd262b0c32d40a2471fd6281e8233fb0d1ad,Ethan Arrowood,2023-09-27 16:52:17+00:00,GitHub,2023-09-27 16:52:17+00:00,Fix internal-dependency-trace script by handling commands/secrets/index.js (#10599),2023,9
cb37ff2c894d9d9e7ee83796ec62ee8c28957908,Trek Glowacki,2023-09-27 12:05:24+00:00,GitHub,2023-09-27 12:05:24+00:00,"Fix incorrect comment (#10603)

Fixes an errant comment from #10583.",2023,9
2f5b0aeeb183ed3ea8cbc68cb3bc3c949c486ada,Trek Glowacki,2023-09-26 21:11:57+00:00,GitHub,2023-09-26 21:11:57+00:00,"[cli] Update bun detection and add tests for projects with both `bunlock.b` and `yarn.lock` files (#10583)

Updates package manager detection to account for two lock files. All other managers will only have the one lock file. Bun, however, may have both a `bun.lockb` _and_ a `yarn.lock` file. To ensure bun is properly detected, the presence of `bun.lockb` with `yarn.lock` must occur before `yarn.lock` so we don't mistake the presence of a `yarn.lock` to mean ""Yarn"".

This PR also adds a test for this situation in `fs-detectors`. The behavior is currently correct there, but was not tested initially. It is now to avoid future regressions.",2023,9
ab0160878566d4e155ca89ebdadf15594a9ec9f0,Steven,2023-09-25 20:11:40+00:00,GitHub,2023-09-25 20:11:40+00:00,"Revert ""[ci] use `--output-logs=new-only` to only list tests that changed"" (#10584)

Reverts vercel/vercel#10570

This was causing a bug because my assumption about turbo cache hit/miss was incorrect. 

I thought `turbo run test-e2e --listTests` would be use the same cache as `turbo run test-e2e` but it does not. So what was happening is that tests were not running on a second push to a PR because turbo already ""cached"" the result of `--listTests` so that `new-only` was saying there are no new tests and nothing to run ü§¶",2023,9
905c7b6ad49ba2b797fe3c4831ef4cbd075f87b5,balazs4,2023-09-25 16:25:46+00:00,GitHub,2023-09-25 16:25:46+00:00,"[vc cert ls] remove error shallowing (#10551)

During [project-level-rbac bug bash](https://linear.app/vercel/issue/IAM-1267/vc-certs-ls-fails-with-typeerror-for-contributors) we were facing a runtime error 

```
Error: An unexpected error occurred in certs: TypeError: Cannot read properties of undefined (reading 'length')
```

The reason for that is because the API responded with `403`, which was expected in our test. However the CLI should not exit with a generic runtime error in this case.

This PR removes the `.catch(err => err)` error shallowing instruction.",2023,9
717dd82c515fba6df1e896b5463b0dd617bc2e70,Vercel Release Bot,2023-09-25 15:58:07+00:00,GitHub,2023-09-25 15:58:07+00:00,"[examples][tests] Upgrade Next.js to version 13.5.3 (#10581)

This auto-generated PR updates 5 packages to Next.js version 13.5.3",2023,9
a4996e1c5a7e6986d5410b662014dc584c0f7c54,Jack Wilson,2023-09-25 13:36:09+00:00,GitHub,2023-09-25 13:36:09+00:00,"Update broken documentation link (#10579)

The error link for the Go runtime documentation was broken. This PR updates the link.",2023,9
c147ead1bce041543e3d482ecf3d85b7e98454f6,Steven,2023-09-23 03:25:28+00:00,GitHub,2023-09-23 03:25:28+00:00,"[cli] remove unused source map pkg (#10577)

This PR removes a [deprecated package](https://www.npmjs.com/package/@zeit/source-map-support) that was originally added in PR https://github.com/vercel/vercel/pull/1205

The comment said:

```js
// we only enable source maps while developing, since
// they have a small performance hit. for this, we
// look for `pkg`, which is only present in the final bin
```

Some time along the way this was changed from development only, to always being installed.

However, no longer need this package because we can enable source maps for development by using [`--enable-source-map`](https://nodejs.org/docs/latest-v18.x/api/cli.html#--enable-source-maps) which has been available since Node.js 12",2023,9
2ab5ce5d9079f68a133832618b4a19a1a311a023,Steven,2023-09-23 02:12:03+00:00,GitHub,2023-09-23 02:12:03+00:00,"[cli] disable source map for prod build (#10575)

I noticed the latest release got [larger in size](https://packagephobia.com/result?p=vercel@32.3.1) when we were expecting it to get smaller.

This is because a 14MB source map was published to npm as [`dist/index.js.map`](https://unpkg.com/browse/vercel@32.3.1/dist/).

This PR disables source maps by default and you can optionally enable when running locally to debug.",2023,9
33e43e103a6101b3fe9e08ac5016649f3b51ff68,Steven,2023-09-22 17:14:57+00:00,GitHub,2023-09-22 17:14:57+00:00,"[ci] use `--output-logs=new-only` to only list tests that changed (#10570)

This PR effectively reverts the change in https://github.com/vercel/vercel/pull/9172 since it is safe to skip tests that are not part of the turbo cache miss results. Previously, we were unable to do this because all of those jobs/checks were marked as required on the github repo settings. But now we have a single [""Summary"" job](https://github.com/vercel/vercel/blob/f6e863d4bbdeb755eb89f1c621bf38dddc7399e1/.github/workflows/test.yml#L111-L128) that is marked as required at the repo level so now we don't need to create jobs anymore just to see the turbo cache hit go green.

- [15f90b0](https://github.com/vercel/vercel/pull/10570/commits/15f90b057da8c31ba860ca87ffad5750120007c1) correctly skipped all e2e tests since none of the packages changed
- [2613963](https://github.com/vercel/vercel/pull/10570/commits/26139634fb7ba1f65aabe0cfdc76f4bdb32df1e0) correctly ran the `vercel` e2e tests since the cli package was changed
- [8488b05](https://github.com/vercel/vercel/pull/10570/commits/8488b0543b6c261d2433ba5f3de4af8a9caabe99) correctly runs tests for all packages since build-utils was changed and all packages depend on it

Also see [Turbo `-output-logs` docs](https://turbo.build/repo/docs/reference/command-line-reference/run#--output-logs) for more.",2023,9
3dbc75580daabfc7807fd413819b9e95980d25ab,Steven,2023-09-22 16:50:21+00:00,GitHub,2023-09-22 16:50:21+00:00,"[ci] increase concurrency for e2e tests (#10569)

 Increase concurrency for e2e tests so they finish faster",2023,9
f6e863d4bbdeb755eb89f1c621bf38dddc7399e1,Vercel Release Bot,2023-09-22 15:54:57+00:00,GitHub,2023-09-22 15:54:57+00:00,"Version Packages (#10565)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@32.3.1

### Patch Changes

- Use ""esbuild"" to build CLI
([#10555](https://github.com/vercel/vercel/pull/10555))

- Updated dependencies
\[[`9f63ca60a`](https://github.com/vercel/vercel/commit/9f63ca60ad914af0f7ba18c9bbe1656eeea68a0a),
[`e3f9faf51`](https://github.com/vercel/vercel/commit/e3f9faf513bd97900d8966f2f1116fc3ca07221b)]:
    -   @vercel/next@4.0.8
    -   @vercel/remix-builder@2.0.8

## @vercel/next@4.0.8

### Patch Changes

- Fix edge case for setting `__NEXT_PRIVATE_PREBUNDLED_REACT`
([#10568](https://github.com/vercel/vercel/pull/10568))

## @vercel/remix-builder@2.0.8

### Patch Changes

- Update `@remix-run/dev` fork to v2.0.1
([#10566](https://github.com/vercel/vercel/pull/10566))",2023,9
9f63ca60ad914af0f7ba18c9bbe1656eeea68a0a,Nathan Rajlich,2023-09-22 15:40:54+00:00,GitHub,2023-09-22 15:40:54+00:00,"[next] Fix a couple issues with server-build template injecting (#10568)

(Includes e2e thanks to @feedthejim)",2023,9
873327e9bdb56be5dbfcf3ca45308d9f8308debc,Nathan Rajlich,2023-09-22 13:57:20+00:00,GitHub,2023-09-22 13:57:20+00:00,Remove `@vercel/ncc` dependency from all packages (#10559),2023,9
e3f9faf513bd97900d8966f2f1116fc3ca07221b,Vercel Release Bot,2023-09-22 13:25:08+00:00,GitHub,2023-09-22 13:25:08+00:00,"[remix] Update `@remix-run/dev` to v2.0.1 (#10566)

This auto-generated PR updates `@remix-run/dev` to version 2.0.1.",2023,9
1a5bd6c5b9f579bb339264fc411a2a7cb2c5fcb1,Nathan Rajlich,2023-09-22 12:25:26+00:00,GitHub,2023-09-22 12:25:26+00:00,"[cli] Use ""esbuild"" (#10555)",2023,9
6d312d85b26652bd5c02a3c9f7d8617dde52500a,Vercel Release Bot,2023-09-21 17:59:12+00:00,GitHub,2023-09-21 17:59:12+00:00,"Version Packages (#10542)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@32.3.0

### Minor Changes

- [cli] Support northstar users
([#10535](https://github.com/vercel/vercel/pull/10535))

### Patch Changes

- Internal variants
([#10549](https://github.com/vercel/vercel/pull/10549))

- [speed insights] Prepare for migration to new speed insights package
([#10500](https://github.com/vercel/vercel/pull/10500))

- Updated dependencies
\[[`b0898a665`](https://github.com/vercel/vercel/commit/b0898a66591d5296dc38ffcf0e8345c9338b72f3),
[`10d4e51ac`](https://github.com/vercel/vercel/commit/10d4e51ac57b76f05ddc0bf3adf220e2490244fc),
[`decdf27fb`](https://github.com/vercel/vercel/commit/decdf27fb5ca914fe50a9320c4fd50ef79d2fbb3),
[`f5ca497b7`](https://github.com/vercel/vercel/commit/f5ca497b7522a2dad637cef238da9716ac133057),
[`ab329f0fe`](https://github.com/vercel/vercel/commit/ab329f0fe88e9cb72607d0cba41f5e168d77e077),
[`d0d052011`](https://github.com/vercel/vercel/commit/d0d0520111264434d57d5920de0f622f6a2588dc),
[`9bb3067de`](https://github.com/vercel/vercel/commit/9bb3067de28be77f3ce268a31a7aa6184836dfb1)]:
    -   @vercel/static-build@2.0.7
    -   @vercel/node@3.0.6
    -   @vercel/build-utils@7.2.1
    -   @vercel/next@4.0.7
    -   @vercel/python@4.0.2
    -   @vercel/redwood@2.0.3
    -   @vercel/remix-builder@2.0.7
    -   @vercel/go@3.0.2

## @vercel/edge@1.1.0

### Minor Changes

- Add flag to geolocation
([#10443](https://github.com/vercel/vercel/pull/10443))

    Usage

        const { flag } = geolocation(req)

## @vercel/build-utils@7.2.1

### Patch Changes

- Internal variants
([#10549](https://github.com/vercel/vercel/pull/10549))

## @vercel/client@13.0.4

### Patch Changes

- Updated dependencies
\[[`decdf27fb`](https://github.com/vercel/vercel/commit/decdf27fb5ca914fe50a9320c4fd50ef79d2fbb3)]:
    -   @vercel/build-utils@7.2.1

## @vercel/gatsby-plugin-vercel-analytics@1.0.11

### Patch Changes

- Remove ""babel"" compilation
([#10546](https://github.com/vercel/vercel/pull/10546))

## @vercel/gatsby-plugin-vercel-builder@2.0.6

### Patch Changes

- Use ""esbuild"" to build package
([#10508](https://github.com/vercel/vercel/pull/10508))

- Updated dependencies
\[[`decdf27fb`](https://github.com/vercel/vercel/commit/decdf27fb5ca914fe50a9320c4fd50ef79d2fbb3)]:
    -   @vercel/build-utils@7.2.1

## @vercel/go@3.0.2

### Patch Changes

- Add support for Go v1.21.0
([#10552](https://github.com/vercel/vercel/pull/10552))

## @vercel/next@4.0.7

### Patch Changes

- Internal variants
([#10549](https://github.com/vercel/vercel/pull/10549))

- Update `@vercel/nft` to v0.24.1.
([#10540](https://github.com/vercel/vercel/pull/10540))

- Build package using ""esbuild""
([#10482](https://github.com/vercel/vercel/pull/10482))

## @vercel/node@3.0.6

### Patch Changes

- Use ""esbuild"" to build package
([#10553](https://github.com/vercel/vercel/pull/10553))

- Update `@vercel/nft` to v0.24.1.
([#10540](https://github.com/vercel/vercel/pull/10540))

- Updated dependencies
\[[`decdf27fb`](https://github.com/vercel/vercel/commit/decdf27fb5ca914fe50a9320c4fd50ef79d2fbb3)]:
    -   @vercel/build-utils@7.2.1

## @vercel/python@4.0.2

### Patch Changes

- Fix docs URL in error message
([#10544](https://github.com/vercel/vercel/pull/10544))

## @vercel/redwood@2.0.3

### Patch Changes

- Update `@vercel/nft` to v0.24.1.
([#10540](https://github.com/vercel/vercel/pull/10540))

## @vercel/remix-builder@2.0.7

### Patch Changes

- Update `@vercel/nft` to v0.24.1.
([#10540](https://github.com/vercel/vercel/pull/10540))

## @vercel/static-build@2.0.7

### Patch Changes

- Mark `@vercel/static-config` and `ts-morph` as externals
([#10543](https://github.com/vercel/vercel/pull/10543))

- Updated dependencies
\[[`4b376a564`](https://github.com/vercel/vercel/commit/4b376a564a09679dc1085d3bfcd6290c6f15760e),
[`b8bc682d3`](https://github.com/vercel/vercel/commit/b8bc682d3eef0e6033fd6e8db2089c6c4ca671af)]:
    -   @vercel/gatsby-plugin-vercel-builder@2.0.6
    -   @vercel/gatsby-plugin-vercel-analytics@1.0.11

## @vercel-internals/types@1.0.11

### Patch Changes

- Updated dependencies
\[[`decdf27fb`](https://github.com/vercel/vercel/commit/decdf27fb5ca914fe50a9320c4fd50ef79d2fbb3)]:
    -   @vercel/build-utils@7.2.1

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,9
10d4e51ac57b76f05ddc0bf3adf220e2490244fc,Nathan Rajlich,2023-09-20 21:35:57+00:00,GitHub,2023-09-20 21:35:57+00:00,"[node] Use ""esbuild"" to build package (#10553)",2023,9
57231a0d603fdba6315ddb331d0dbe5f3ee99c9f,Tobias Lins,2023-09-20 21:06:12+00:00,GitHub,2023-09-20 21:06:12+00:00,"[speed insights] Prepare for migration to new speed insights package (#10500)

During `vc build` do following when `@vercel/speed-insights` package is in dependencies:
- Show a warning when `VERCEL_ANALYTICS_ID` is set in environment variables
- Unset it in process.env to prevent auto-injecting old speed insights in Next.js

Durning `vc env pull` prevent pulling internal environment variables `VERCEL_ANALYTICS_ID`, `VERCEL_SPEED_INSIGHTS_ID` & `VERCEL_WEB_ANALYTICS_ID`. They are never required in the frontend",2023,9
e0e9cffc8d23d58b4b2e885354daf7b9b07a9979,Vercel Release Bot,2023-09-20 20:19:36+00:00,GitHub,2023-09-20 20:19:36+00:00,"[examples][tests] Upgrade Next.js to version 13.5.2 (#10554)

This auto-generated PR updates 4 packages to Next.js version 13.5.2",2023,9
d0d0520111264434d57d5920de0f622f6a2588dc,Nathan Rajlich,2023-09-20 20:01:03+00:00,GitHub,2023-09-20 20:01:03+00:00,"[next] Use ""esbuild"" to build package (#10482)

### Before

```
$ time pnpm run build

> @vercel/next@4.0.6 build /Users/nrajlich/Code/vercel/vercel/packages/next
> node build.js

ncc: Version 0.24.0
ncc: Compiling file index.js
ncc: Using typescript@4.9.5 (local user-provided)
1506kB  dist/main/index.js
1506kB  [3345ms] - ncc 0.24.0

real    0m5.210s
user    0m9.083s
sys     0m0.506s

$ ls -l dist/
total 1700
-rw-r--r-- 1 nrajlich staff    2176 Sep 20 15:18 ___get-nextjs-edge-function.js
-rw-r--r-- 1 nrajlich staff    3283 Sep 20 15:18 create-serverless-config.js
drwxr-xr-x 6 nrajlich staff     192 Sep 20 15:18 edge-function-source/
-rw-r--r-- 1 nrajlich staff 1542314 Sep 20 15:18 index.js
-rw-r--r-- 1 nrajlich staff     728 Sep 20 15:18 legacy-launcher.js
-rw-r--r-- 1 nrajlich staff    6807 Sep 20 15:18 legacy-versions.js
-rw-r--r-- 1 nrajlich staff   66662 Sep 20 15:18 server-build.js
-rw-r--r-- 1 nrajlich staff    1583 Sep 20 15:18 server-launcher.js
-rw-r--r-- 1 nrajlich staff    5167 Sep 20 15:18 sourcemapped.js
-rw-r--r-- 1 nrajlich staff    1003 Sep 20 15:18 templated-launcher-shared.js
-rw-r--r-- 1 nrajlich staff     799 Sep 20 15:18 templated-launcher.js
-rw-r--r-- 1 nrajlich staff   83876 Sep 20 15:18 utils.js

$ pnpm pack && ls -lh vercel-next-4.0.6.tgz 
-rw-r--r-- 1 nrajlich staff 373K Sep 20 15:19 vercel-next-4.0.6.tgz
```

### After

```
$ time pnpm run build

> @vercel/next@4.0.6 build /Users/nrajlich/Code/vercel/vercel/packages/next
> node build.mjs

real    0m1.144s
user    0m0.550s
sys     0m0.171s

$ ls -l dist/
total 540
-rw-r--r-- 1 nrajlich staff   2176 Sep 20 15:15 ___get-nextjs-edge-function.js
-rw-r--r-- 1 nrajlich staff 528575 Sep 20 15:15 index.js
-rw-r--r-- 1 nrajlich staff   1680 Sep 20 15:15 legacy-launcher.js
-rw-r--r-- 1 nrajlich staff    901 Sep 20 15:15 server-launcher.js
-rw-r--r-- 1 nrajlich staff    532 Sep 20 15:15 templated-launcher-shared.js
-rw-r--r-- 1 nrajlich staff    316 Sep 20 15:15 templated-launcher.js

$ pnpm pack && ls -lh vercel-next-4.0.6.tgz 
-rw-r--r-- 1 nrajlich staff 104K Sep 20 15:15 vercel-next-4.0.6.tgz
```",2023,9
9bb3067de28be77f3ce268a31a7aa6184836dfb1,Ethan Arrowood,2023-09-20 18:30:38+00:00,GitHub,2023-09-20 18:30:38+00:00,"[go] add support for Go 1.21.0 (#10552)

as titled

updates a test to check for runtime version

---------

Co-authored-by: Nathan Rajlich <n@n8.io>",2023,9
decdf27fb5ca914fe50a9320c4fd50ef79d2fbb3,Andy,2023-09-20 17:42:20+00:00,GitHub,2023-09-20 17:42:20+00:00,"[cli][next][build-utils] Variants (#10549)

Co-authored-by: Ethan Arrowood <ethan.arrowood@vercel.com>",2023,9
4b376a564a09679dc1085d3bfcd6290c6f15760e,Nathan Rajlich,2023-09-20 13:26:31+00:00,GitHub,2023-09-20 13:26:31+00:00,"[gatsby-plugin-vercel-builder] Use ""esbuild"" to build package (#10508)

Removes the two-staged `tsc` build into a single `esbuild` bundle. The `ssr-handler.ts` template file is moved to the root of the package and converted to JavaScript.",2023,9
b7e93524e3606223cc9fde254c8e67d5ec3c98e0,Shu Uesugi,2023-09-19 21:45:42+00:00,GitHub,2023-09-19 21:45:42+00:00,"[cli] Support northstar users (#10535)

Supports users who have `version === 'northstar'` and `defaultTeamId`.",2023,9
62283356b8fec88abeb85892b6b8259c111659f1,Paul Scanlon,2023-09-19 21:25:46+00:00,GitHub,2023-09-19 21:25:46+00:00,"feat: add flag to geolocation (#10443)

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,9
3305f5e83277f5b035137342dcd38956af665c98,Vercel Release Bot,2023-09-19 21:06:40+00:00,GitHub,2023-09-19 21:06:40+00:00,"[examples][tests] Upgrade Next.js to version 13.5.1 (#10545)

This auto-generated PR updates 4 packages to Next.js version 13.5.1",2023,9
a9387069161e1cdd206a2c2b116a36bc5daaf0b4,Jiachi Liu,2023-09-19 21:01:13+00:00,GitHub,2023-09-19 21:01:13+00:00,"update code owners for nextjs example (#10548)

Add @huozhi to nextjs example code owners

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,9
b8bc682d3eef0e6033fd6e8db2089c6c4ca671af,Nathan Rajlich,2023-09-19 20:45:26+00:00,GitHub,2023-09-19 20:45:26+00:00,"[gatsby-plugin-vercel-analytics] Remove ""babel"" compilation (#10546)

The ""babel"" build for this package essentially does nothing. The output is still using ESM and no transformation is done. Let's just remove the ""build"" script entirely.",2023,9
f5ca497b7522a2dad637cef238da9716ac133057,Nathan Rajlich,2023-09-19 18:07:43+00:00,GitHub,2023-09-19 18:07:43+00:00,[python] Fix docs URL in error message (#10544),2023,9
b0898a66591d5296dc38ffcf0e8345c9338b72f3,Nathan Rajlich,2023-09-19 17:47:05+00:00,GitHub,2023-09-19 17:47:05+00:00,"[static-build] Mark `@vercel/static-config` and `ts-morph` as externals (#10543)

To be consistent with the other packages that use `@vercel/static-config`/`ts-morph`, move these packages to ""dependencies"" so that they will be excluded from the bundle, and de-duped at the `node_modules` level when installing CLI.",2023,9
ab329f0fe88e9cb72607d0cba41f5e168d77e077,Chris Barber,2023-09-19 14:27:54+00:00,GitHub,2023-09-19 14:27:54+00:00,"[next][node][redwood][remix] Update @vercel/nft (#10540)

Updating `nft` to fix a bug. We're a couple version behind. Here's all cumulative changes:

- 0.24.1
  - resolve cjs deps as cjs instead of esm
- 0.24.0
  - drop node@14 
- 0.23.1
  - use builtinModules from module
- 0.23.0
  - resolve: export resolve() function
- 0.22.6
  - Make caching work correctly in async context",2023,9
8b35333446c81b4698c432459e7784e6901fd5c7,Nathan Rajlich,2023-09-18 19:32:30+00:00,GitHub,2023-09-18 19:32:30+00:00,"[examples] Update ""remix"" template to v2 (#10532)",2023,9
a92467719bc2927702a990398384495899b9498a,Vercel Release Bot,2023-09-18 18:44:07+00:00,GitHub,2023-09-18 18:44:07+00:00,"Version Packages (#10528)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@32.2.5

### Patch Changes

- Updated dependencies
\[[`849eedf0f`](https://github.com/vercel/vercel/commit/849eedf0f2841211e4175d374f1cf01330bf9611),
[`f6f16b034`](https://github.com/vercel/vercel/commit/f6f16b0347bac9f5c33c79ccb1fb9fd9d254cae5),
[`3035e18fb`](https://github.com/vercel/vercel/commit/3035e18fb67dfe7031e235a74136a41948f86d5a),
[`cb784aeb9`](https://github.com/vercel/vercel/commit/cb784aeb9c9e4eddf1c65b61849a87edb1117af1)]:
    -   @vercel/next@4.0.6
    -   @vercel/remix-builder@2.0.6

## @vercel/next@4.0.6

### Patch Changes

- Fix feature flag detection
([#10531](https://github.com/vercel/vercel/pull/10531))

## @vercel/remix-builder@2.0.6

### Patch Changes

- Fix ESM mode for Edge runtime
([#10530](https://github.com/vercel/vercel/pull/10530))

- Update `@remix-run/dev` fork to v2.0.0
([#10526](https://github.com/vercel/vercel/pull/10526))

- Fixes for Remix v2
([#10525](https://github.com/vercel/vercel/pull/10525))",2023,9
f6f16b0347bac9f5c33c79ccb1fb9fd9d254cae5,Nathan Rajlich,2023-09-18 18:26:53+00:00,GitHub,2023-09-18 18:26:53+00:00,"[remix] Fix ESM mode for Edge runtime, add Remix v2 E2E test (#10530)

Similar to the default import fix from #10525 which was for Node runtime, but this one fixes Edge runtime.

Also adds an E2E test for Remix v2, including both a Node route and Edge route.",2023,9
92ad73b8f3acbfaeda182391ffbeb8b00aa57369,Trek Glowacki,2023-09-18 16:43:16+00:00,GitHub,2023-09-18 16:43:16+00:00,"Restore datadog checking with logs not exit codes (#10527)

Restores DataDog flakey test detection. Briefly disabled because the old method of using exit codes would bail the entire workflow.

Taking the Turbo team's suggestion of looking at `runData.execution` values to avoid an extra loop. Now with unit tests!",2023,9
849eedf0f2841211e4175d374f1cf01330bf9611,Steven,2023-09-18 16:17:55+00:00,GitHub,2023-09-18 16:17:55+00:00,"[next] fix feature flag detection (#10531)

For feature flags, we use the string `1` for enabled and the string `0` for disabled.

So we need to check the value of the env var, not the presence of the env var.",2023,9
848a62e4a5beb9f369b51517aa4bd400822d9c32,Vercel Release Bot,2023-09-18 15:31:52+00:00,GitHub,2023-09-18 15:31:52+00:00,"[tests] Upgrade Turbo to version 1.10.14 (#10529)

This auto-generated PR updates Turbo to version 1.10.14",2023,9
cb784aeb9c9e4eddf1c65b61849a87edb1117af1,Nathan Rajlich,2023-09-18 14:32:08+00:00,GitHub,2023-09-18 14:32:08+00:00,"[remix] Fixes for Remix v2 (#10525)

The Remix v2 template now uses `""type"": ""module""` by default, so adjust our bundling logic to account for that possibility.",2023,9
3035e18fb67dfe7031e235a74136a41948f86d5a,Vercel Release Bot,2023-09-18 14:05:42+00:00,GitHub,2023-09-18 14:05:42+00:00,"[remix] Update `@remix-run/dev` to v2.0.0 (#10526)

This auto-generated PR updates `@remix-run/dev` to version 2.0.0.",2023,9
eb40c4c4a0320e56f4167ee787929cfe55349252,Vercel Release Bot,2023-09-15 19:13:54+00:00,GitHub,2023-09-15 19:13:54+00:00,"Version Packages (#10514)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## @vercel/fs-detectors@5.1.0

### Minor Changes

- Add support for bun detection in monorepo
([#10511](https://github.com/vercel/vercel/pull/10511))

## vercel@32.2.4

### Patch Changes

- Add support for bun detection in monorepo
([#10511](https://github.com/vercel/vercel/pull/10511))

- Updated dependencies
\[[`1b6f3a0f6`](https://github.com/vercel/vercel/commit/1b6f3a0f6534f71c7486a4e33ac199f1da330626)]:
    -   @vercel/static-build@2.0.6

## @vercel/static-build@2.0.6

### Patch Changes

- Add support for bun detection in monorepo
([#10511](https://github.com/vercel/vercel/pull/10511))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,9
c90ee12b1709087e24648e9184d0a867bbe5b044,Nathan Rajlich,2023-09-15 19:06:32+00:00,GitHub,2023-09-15 19:06:32+00:00,"Update bun changeset to bump static-build + CLI (#10516)

Also reverts https://github.com/vercel/vercel/pull/10515 since it didn't
work the way we were hoping.",2023,9
78be0200b4193a8437034db6a2d93095c39ae58c,Nathan Rajlich,2023-09-15 18:54:47+00:00,GitHub,2023-09-15 18:54:47+00:00,"Enable changesets experimental `updateInternalDependents: 'always'` config (#10515)

From the [sounds of
it](https://github.com/changesets/changesets/blob/main/docs/experimental-options.md#updateinternaldependents-type-out-of-range--always),
setting this config value to ""always"" will make it so that a patch
release will happen for a package that depends on another package which
is being bumped. This would normally happen anyways, but does not happen
when a dependency is a `devDependency` rather than a `dependency` (which
happens for the Builders and CLI, since those packages get bundled and
thus have their deps listed as devDependencies).",2023,9
1b6f3a0f6534f71c7486a4e33ac199f1da330626,Steven,2023-09-15 18:13:26+00:00,GitHub,2023-09-15 18:13:26+00:00,"[fs-detectors] Add support for bun detection in monorepo (#10511)

E2E test looks like:

```sh
bunx create-turbo@canary
cd my-turborepo
gh repo create
vc link --repo
vc deploy
```",2023,9
eceb15ace9adedd2b7393974d8198e641f13bdb4,Trek Glowacki,2023-09-15 17:49:24+00:00,GitHub,2023-09-15 17:49:24+00:00,"Revert skipping datadog reports (#10513)

Revert
[.github/workflows/test.yml](https://github.com/vercel/vercel/pull/10513/files#diff-faff1af3d8ff408964a57b2e475f69a6b7c7b71c9978cccc8f471798caac2c88)
to an earlier version.",2023,9
fa3f701e052bb69af410d8240d891717ee9e5fb2,Vercel Release Bot,2023-09-14 21:06:33+00:00,GitHub,2023-09-14 21:06:33+00:00,"Version Packages (#10505)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,9
9953fc765f3be98a578ea4c79d2f41c3ee8765a7,Trek Glowacki,2023-09-14 16:39:53+00:00,GitHub,2023-09-14 16:39:53+00:00,Complete the error message (#10509),2023,9
29ea1af971cfd7076c139c598da0778f6e2b8207,Trek Glowacki,2023-09-14 15:47:20+00:00,GitHub,2023-09-14 15:47:20+00:00,Skip DataDog reporting if Turbo cache indicates the uploaded files would be identical (#10501),2023,9
083aad448e45edae296da3201eec9f890a01d22d,Zack Tanner,2023-09-14 01:19:13+00:00,GitHub,2023-09-14 01:19:13+00:00,"[next] missed a prerender for experimentalBypassFor (#10504)

Missed this in https://github.com/vercel/vercel/pull/10497",2023,9
314a105ba178c85f79e6acfdb8165d0d660df0fa,Vercel Release Bot,2023-09-13 22:15:29+00:00,GitHub,2023-09-13 22:15:29+00:00,"Version Packages (#10493)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,9
1abda9ca871ce4fad98b260c9467fd5a7f294a40,Ikko Eltociear Ashimine,2023-09-13 13:26:51+00:00,GitHub,2023-09-13 13:26:51+00:00,"[cli] Fix typo in corepack.ts (#10499)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,9
7a0fed970c39cb8f4df70544ded3284d3538b06a,Zack Tanner,2023-09-12 22:40:49+00:00,GitHub,2023-09-12 22:40:49+00:00,[next] provide `experimentalBypassFor` to prerender from manifest (#10497),2023,9
2f461a8b0bcbdd05da0516395c2905c2d0242682,Jimmy Lai,2023-09-12 19:45:23+00:00,GitHub,2023-09-12 19:45:23+00:00,"next.js: add option to use bundled runtime (#10485)

This PR adds an environment variable that should allow us to test the bundled version for Next.js on Vercel, see https://github.com/vercel/next.js/pull/52997 for reference.

The changes include:
- a new environment variable `VERCEL_NEXT_BUNDLED_SERVER`
- some logic changes that will put app route handlers into their own lambda groups
- extra logic to require early the rendering runtimes (see PR above for details)",2023,9
ec894bdf7f167debded37183f11360756f577f14,Steven,2023-09-12 15:29:24+00:00,GitHub,2023-09-12 15:29:24+00:00,"[frameworks] Add `bun install` placeholder (#10492)

<img width=""899"" alt=""image""
src=""https://github.com/vercel/vercel/assets/229881/f37a3cfd-bbb9-4c33-88dc-cd19b9855a47"">",2023,9
009cea6d3050699b9ea6d2858476284e23df93f7,Andy,2023-09-12 15:25:02+00:00,GitHub,2023-09-12 15:25:02+00:00,"[examples] Use placeholder for API Key (#10490)

The Ionic example has an actual Google Maps API key by default and we'd
like to not have it displayed, so we'll replace it with a placeholder
instead. Considering it's commented out anyways, this will be a no-op.

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,9
1bab21026ec0bb8a4a8fbeac3d6e4a197f1030fd,Nathan Rajlich,2023-09-12 14:55:16+00:00,GitHub,2023-09-12 14:55:16+00:00,[remix] Fix usage with `bun install` (#10489),2023,9
bcebab7517a2d440bde4cfd486f68025e2408d5a,Vercel Release Bot,2023-09-11 21:30:02+00:00,GitHub,2023-09-11 21:30:02+00:00,"Version Packages (#10478)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## @vercel/build-utils@7.2.0

### Minor Changes

- Add new optional prerender field: experimentalStreamingLambdaPath
([#10476](https://github.com/vercel/vercel/pull/10476))

- [build-utils] Add zero config detection for bun package manager
([#10486](https://github.com/vercel/vercel/pull/10486))

### Patch Changes

- add `experimentalBypassFor` field to Prerender
([#10481](https://github.com/vercel/vercel/pull/10481))

## vercel@32.2.1

### Patch Changes

- Update @vercel/fun@1.1.0
([#10477](https://github.com/vercel/vercel/pull/10477))

- [node] upgrade edge-runtime
([#10451](https://github.com/vercel/vercel/pull/10451))

- Updated dependencies
\[[`6784e7751`](https://github.com/vercel/vercel/commit/6784e77516ba180a691e3c48323b32bb4506d7b6),
[`a8ad17626`](https://github.com/vercel/vercel/commit/a8ad176262ef822860ce338927e6f959961d2d32),
[`0ee089a50`](https://github.com/vercel/vercel/commit/0ee089a501ebb78901c4afe1658e794917998f8f),
[`f15cba614`](https://github.com/vercel/vercel/commit/f15cba6148a0cdb6975db7724775c35ab7d929b2),
[`b265e13d4`](https://github.com/vercel/vercel/commit/b265e13d40d541b77148fa79ac60b4c4dd10974c),
[`50e04dd85`](https://github.com/vercel/vercel/commit/50e04dd8584664c842a86c15d92d654f4ea8dcbb),
[`45b73c7e8`](https://github.com/vercel/vercel/commit/45b73c7e86458564dc0bab007f6f6365c4c4ab5d),
[`a732d30c8`](https://github.com/vercel/vercel/commit/a732d30c8409f96f59ea5406e974a6c4186cc130),
[`9d64312aa`](https://github.com/vercel/vercel/commit/9d64312aaaa875a4e193b7602c50e5dc68979aad),
[`6baefc825`](https://github.com/vercel/vercel/commit/6baefc825ad7cfc3a5edce31cb4244721452f753),
[`989f0d813`](https://github.com/vercel/vercel/commit/989f0d813910d8d67ed355de93018f1dcd91b6ba),
[`d8bc570f6`](https://github.com/vercel/vercel/commit/d8bc570f604950d97156d4f33c8accecf3b3b28f)]:
    -   @vercel/go@3.0.1
    -   @vercel/redwood@2.0.2
    -   @vercel/remix-builder@2.0.4
    -   @vercel/hydrogen@1.0.1
    -   @vercel/static-build@2.0.5
    -   @vercel/build-utils@7.2.0
    -   @vercel/next@4.0.3
    -   @vercel/node@3.0.5
    -   @vercel/python@4.0.1
    -   @vercel/ruby@2.0.2

## @vercel/client@13.0.3

### Patch Changes

- Updated dependencies
\[[`50e04dd85`](https://github.com/vercel/vercel/commit/50e04dd8584664c842a86c15d92d654f4ea8dcbb),
[`45b73c7e8`](https://github.com/vercel/vercel/commit/45b73c7e86458564dc0bab007f6f6365c4c4ab5d),
[`d8bc570f6`](https://github.com/vercel/vercel/commit/d8bc570f604950d97156d4f33c8accecf3b3b28f)]:
    -   @vercel/build-utils@7.2.0

## @vercel/edge@1.0.2

### Patch Changes

- [node] upgrade edge-runtime
([#10451](https://github.com/vercel/vercel/pull/10451))

## @vercel/gatsby-plugin-vercel-builder@2.0.5

### Patch Changes

- Updated dependencies
\[[`50e04dd85`](https://github.com/vercel/vercel/commit/50e04dd8584664c842a86c15d92d654f4ea8dcbb),
[`45b73c7e8`](https://github.com/vercel/vercel/commit/45b73c7e86458564dc0bab007f6f6365c4c4ab5d),
[`9d64312aa`](https://github.com/vercel/vercel/commit/9d64312aaaa875a4e193b7602c50e5dc68979aad),
[`d8bc570f6`](https://github.com/vercel/vercel/commit/d8bc570f604950d97156d4f33c8accecf3b3b28f)]:
    -   @vercel/build-utils@7.2.0
    -   @vercel/node@3.0.5

## @vercel/go@3.0.1

### Patch Changes

- Update to esbuild script
([#10468](https://github.com/vercel/vercel/pull/10468))

## @vercel/hydrogen@1.0.1

### Patch Changes

- Use `build-builder.mjs` script to bundle, and remove types and source
maps ([#10480](https://github.com/vercel/vercel/pull/10480))

## @vercel/next@4.0.3

### Patch Changes

- fix content-type for RSC prefetches
([#10487](https://github.com/vercel/vercel/pull/10487))

## @vercel/node@3.0.5

### Patch Changes

- [node] upgrade edge-runtime
([#10451](https://github.com/vercel/vercel/pull/10451))

- Updated dependencies
\[[`50e04dd85`](https://github.com/vercel/vercel/commit/50e04dd8584664c842a86c15d92d654f4ea8dcbb),
[`45b73c7e8`](https://github.com/vercel/vercel/commit/45b73c7e86458564dc0bab007f6f6365c4c4ab5d),
[`d8bc570f6`](https://github.com/vercel/vercel/commit/d8bc570f604950d97156d4f33c8accecf3b3b28f)]:
    -   @vercel/build-utils@7.2.0

## @vercel/python@4.0.1

### Patch Changes

- Update to esbuild script
([#10470](https://github.com/vercel/vercel/pull/10470))

## @vercel/redwood@2.0.2

### Patch Changes

- Update to esbuild script
([#10471](https://github.com/vercel/vercel/pull/10471))

## @vercel/remix-builder@2.0.4

### Patch Changes

- Use `build-builder.mjs` script to bundle, and remove types and source
maps ([#10479](https://github.com/vercel/vercel/pull/10479))

## @vercel/ruby@2.0.2

### Patch Changes

- Update to esbuild script
([#10472](https://github.com/vercel/vercel/pull/10472))

## @vercel/static-build@2.0.5

### Patch Changes

- Build package using ""esbuild""
([#10462](https://github.com/vercel/vercel/pull/10462))

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@2.0.5

## @vercel-internals/types@1.0.10

### Patch Changes

- Updated dependencies
\[[`50e04dd85`](https://github.com/vercel/vercel/commit/50e04dd8584664c842a86c15d92d654f4ea8dcbb),
[`45b73c7e8`](https://github.com/vercel/vercel/commit/45b73c7e86458564dc0bab007f6f6365c4c4ab5d),
[`d8bc570f6`](https://github.com/vercel/vercel/commit/d8bc570f604950d97156d4f33c8accecf3b3b28f)]:
    -   @vercel/build-utils@7.2.0

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,9
45b73c7e86458564dc0bab007f6f6365c4c4ab5d,Steven,2023-09-11 21:26:34+00:00,GitHub,2023-09-11 21:26:34+00:00,"[build-utils] Add zero config detection for bun package manager (#10486)

> [!IMPORTANT]  
> This PR will only support Bun as a package manager at build time. 
> Bun will **not** work at runtime with Serverless Functions or Edge
Functions at this time.

- Depends on https://github.com/vercel/api/pull/21869
- Fixes https://github.com/orgs/vercel/discussions/2021
- Closes https://github.com/vercel/vercel/pull/10244
- Related https://github.com/nodejs/corepack/issues/295
- Docs https://bun.sh/docs/install",2023,9
a732d30c8409f96f59ea5406e974a6c4186cc130,Zack Tanner,2023-09-11 19:04:16+00:00,GitHub,2023-09-11 19:04:16+00:00,"[next] fix content-type for RSC prefetches (#10487)

This ensures that the `.prefetch.rsc` requests respond with the correct `content-type` since this is used by Next.js to determine if a request is valid or not (and in the case it's invalid, an mpa navigation will occur)

Fixes: https://github.com/vercel/next.js/issues/54934",2023,9
85047358089177b7099d49a1345633a066e9df41,Lee Robinson,2023-09-11 16:29:54+00:00,GitHub,2023-09-11 16:29:54+00:00,"[examples] Update Astro starter (#10397)

Deployed https://astro.vercel.app/image.",2023,9
9d64312aaaa875a4e193b7602c50e5dc68979aad,Kiko Beats,2023-09-10 13:14:43+00:00,GitHub,2023-09-10 13:14:43+00:00,[node] upgrade edge-runtime (#10451),2023,9
a8ad176262ef822860ce338927e6f959961d2d32,Chris Barber,2023-09-09 01:48:54+00:00,GitHub,2023-09-09 01:48:54+00:00,[redwood] Use new esbuild script (#10471),2023,9
0ee089a501ebb78901c4afe1658e794917998f8f,Nathan Rajlich,2023-09-09 00:35:56+00:00,GitHub,2023-09-09 00:35:56+00:00,"[remix] Bundle, remove types and source maps (#10479)

For consistency with other Builders.",2023,9
d8bc570f604950d97156d4f33c8accecf3b3b28f,Zack Tanner,2023-09-08 23:33:59+00:00,GitHub,2023-09-08 23:33:59+00:00,"[build-utils] add `experimentalBypassFor` field to Prerender (#10481)

This adds an experimental flag to `Prerender` outputs as a way to programmatically bypass the cache and hit the lambda directly, using a similar interface to `has`. 

(Note: I copied over `HasField` from `@vercel/router-utils` since it wasn't available for import in `build-utils`, but can add it as a dep if that's preferred)

The specific use-case being targeted here relates to https://github.com/vercel/next.js/pull/51534 -- a Next.js page marked static should still be able to initiate server actions.",2023,9
f15cba6148a0cdb6975db7724775c35ab7d929b2,Nathan Rajlich,2023-09-08 22:55:03+00:00,GitHub,2023-09-08 22:55:03+00:00,"[hydrogen] Bundle, remove types and source maps (#10480)

Similar to #10479, but for `@vercel/hydrogen`.",2023,9
989f0d813910d8d67ed355de93018f1dcd91b6ba,Chris Barber,2023-09-08 22:27:17+00:00,GitHub,2023-09-08 22:27:17+00:00,[ruby] Use new esbuild script (#10472),2023,9
6784e77516ba180a691e3c48323b32bb4506d7b6,Chris Barber,2023-09-08 22:00:40+00:00,GitHub,2023-09-08 22:00:40+00:00,"[go] Update to esbuild script (#10468)

Co-authored-by: Nathan Rajlich <n@n8.io>",2023,9
6baefc825ad7cfc3a5edce31cb4244721452f753,Chris Barber,2023-09-08 21:23:23+00:00,GitHub,2023-09-08 21:23:23+00:00,"[python] Update to esbuild script (#10470)

Co-authored-by: Steven <steven@ceriously.com>",2023,9
0a08e4b23ec25d838f93d28c942a2a412511a0af,Chris Barber,2023-09-08 20:39:13+00:00,GitHub,2023-09-08 20:39:13+00:00,[cli] Update @vercel/fun@1.1.0 (#10477),2023,9
b265e13d40d541b77148fa79ac60b4c4dd10974c,Nathan Rajlich,2023-09-08 19:39:12+00:00,GitHub,2023-09-08 19:39:12+00:00,"[static-build] Use esbuild (#10462)

Switch to using esbuild to compile + bundle `@vercel/static-build`.",2023,9
50e04dd8584664c842a86c15d92d654f4ea8dcbb,Nabeel Sulieman,2023-09-08 18:42:06+00:00,GitHub,2023-09-08 18:42:06+00:00,"Add optional experimentalStreamingLambda field for prerender (#10476)

This adds a new `experimentalStreamingLambda` field to Prerender
outputs, allowing references to an optional streaming lambda path.",2023,9
82231058da85a9bab65940180718e0538da0d35b,Vercel Release Bot,2023-09-08 16:41:32+00:00,GitHub,2023-09-08 16:41:32+00:00,"Version Packages (#10400)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,9
61227bf7e32409493887738572008c5f23e416b1,Steven,2023-09-08 02:09:11+00:00,GitHub,2023-09-08 02:09:11+00:00,"fix .changeset/nice-lies-sip.md (#10474)

I think we need to remove `api` since its private so its not published to npm and therefore isn't versioned.",2023,9
6aa0aa4e65b81903f4fce677a198dcfaebee744b,Zack Tanner,2023-09-08 00:17:08+00:00,GitHub,2023-09-08 00:17:08+00:00,"[next] fix ENOENT on /404.html when `fallback: false` w/ `basePath` (#10473)

The following error occurs during build when `basePath` is present in conjunction with `fallback: false` in `getStaticPaths`:

> Error: ENOENT: no such file or directory, open '/vercel/path0/.next/server/pages/404.html'

`localePrefixed404` was incorrectly being set to `false` because it was looking for `/<basePath>/<locale>/404.html` (when it's actually `/<locale>/404.html`)

This meant that inside `onPrerenderRoute`, `htmlFsRef` was pointing to `/404.html` rather than `/en/404.html`.",2023,9
caaba0d6855eff4350b6a04acc3ea502025bff8f,JJ Kasper,2023-09-07 22:03:12+00:00,GitHub,2023-09-07 22:03:12+00:00,"[next] fix app dir edge functions with basePath (#10465)

x-ref: https://github.com/vercel/vercel/pull/10394",2023,9
335fd70a68e7d1207056858ec516a7d8ee411ce1,Steven,2023-09-07 14:20:20+00:00,GitHub,2023-09-07 14:20:20+00:00,"[ci] Update codeowners (#10467)

Update codeowners for Next.js",2023,9
c3c54d6e695ec078777c4b1f4f23acbeee3c3b09,Zack Tanner,2023-09-07 14:03:14+00:00,GitHub,2023-09-07 14:03:14+00:00,"[next]: Fix RSC rewrite behavior (#10415)

- Removes some of the hacks from #10388 that were attempting to resolve an issue with RSC prefetches to `pages` routes in favor of adding rsc rewrites for all dynamic paths, and letting it fall through to a 404 if there's no match
- Fixes an issue where RSC requests were matching the wrong path (filesystem rather than RSC variant) introduced in above mentioned change
  - Closes https://github.com/vercel/next.js/issues/54698",2023,9
43048a0dd87626438d0ff463ed81362c48d3ec3d,Shu Uesugi,2023-09-07 13:12:54+00:00,GitHub,2023-09-07 13:12:54+00:00,"[CLI] Fix team URL on `vercel help switch`  (#10466)

In `vercel help switch`, it suggests that team URL is of the format `vercel.com/teams/name`, but this will be 404. It should be `vercel.com/name`.",2023,9
60c75fd76cf45a53b8143c560e295a2aed62b450,Sean Massa,2023-09-06 23:46:44+00:00,GitHub,2023-09-06 23:46:44+00:00,"[CLI] show instant preview url on `vc deploy` and `vc redeploy` (#10458)

Show Instant Preview URLs immediately during `vc deploy`.

This does mean that we'll no longer show the nicer aliased URLs, but that's probably fine.

https://github.com/vercel/vercel/assets/41545/5d6d5695-60c3-49ca-a54d-a16828583070

---

- [Card](https://linear.app/vercel/issue/VCCLI-897/show-instant-preview-url-on-vc-deploy)",2023,9
bd1319d7a32e809489c7fdfe41c92308795ed0cc,Trek Glowacki,2023-09-06 20:58:57+00:00,GitHub,2023-09-06 20:58:57+00:00,"[cli] Update secrets.js to more current styles (#10461)

Updates the `secrets` command to be a bit more modern. Initially I was going to covert this to typescript but that change was quite large, so going stepwise for easier review.

1. Moves the command implementation into a directory like other commands
2. Shifts the command data structure into its own file
3. Adds a test.

Other relevant comments inline.",2023,9
1138f7e3d16719b154cff73bc31b05c40c1e5710,Nathan Rajlich,2023-09-06 19:49:50+00:00,GitHub,2023-09-06 19:49:50+00:00,"Use `esbuild` for non-ncc'd packages (#10430)

The intention is for this to be a drop-in replacement for compiling TypeScript to JavaScript, but using `esbuild` instead of `tsc`. `tsc` is still needed, but only for the cases where we want to generate type definitions.",2023,9
bb95cb9225df0a361a8f953333794ed30f84f2bf,Ethan Arrowood,2023-09-06 16:15:35+00:00,GitHub,2023-09-06 16:15:35+00:00,"[cli] migrate teams command (#10434)

Before:
<img width=""661"" alt=""Screenshot 2023-08-31 at 13 59 35"" src=""https://github.com/vercel/vercel/assets/16144158/7d16367a-662e-4ef1-8561-c197f4badf48"">

After:
<img width=""1036"" alt=""Screenshot 2023-08-31 at 14 00 23"" src=""https://github.com/vercel/vercel/assets/16144158/64431bdb-48ce-4bc1-8ed0-c719bdfbb350"">",2023,9
0048eb999e2b205ce4bc62ca5ea7451352a1340f,Trek Glowacki,2023-09-06 15:42:37+00:00,GitHub,2023-09-06 15:42:37+00:00,"[cli] N, not n. (#10460)

Followup to https://github.com/vercel/vercel/pull/10432#discussion_r1315482954",2023,9
1b4de4a986f7a612aac834ebae3ec7bb9e9b8cf8,Espen Hovlandsdal,2023-09-06 13:37:37+00:00,GitHub,2023-09-06 13:37:37+00:00,"chore(deps): upgrade semver dependency (#10411)

Addresses ReDoS vulnerability: https://security.snyk.io/vuln/SNYK-JS-SEMVER-3247795
Uses the latest unaffected versions in the respective major versions, to prevent having to deal with any other breaking changes.",2023,9
c9ad4084ee5e6eb51a41c17d5c69c92e60ebddac,JJ Kasper,2023-09-06 00:46:37+00:00,GitHub,2023-09-06 00:46:37+00:00,"[next] Update page config test (#10456)

Updates failing test in https://github.com/vercel/vercel/actions/runs/6090040294/job/16525842631?pr=10430 per changes in https://github.com/vercel/next.js/pull/54786",2023,9
98ee6e47281fe9eee6f9fab0532578f981d9c907,Trek Glowacki,2023-09-05 21:11:03+00:00,GitHub,2023-09-05 21:11:03+00:00,"[cli] Migrate `domains` to new command structure (#10427)

After:
<img width=""790"" alt=""CleanShot 2023-08-31 at 11 39 25@2x"" src=""https://github.com/vercel/vercel/assets/9736/b2e0e090-8c7c-4659-b1aa-1c59744d2eb1"">

Before:
<img width=""813"" alt=""CleanShot 2023-08-31 at 11 40 06@2x"" src=""https://github.com/vercel/vercel/assets/9736/731626a0-86f0-446d-8f77-436205acac87"">",2023,9
d7db0c57940febbd48a0d44d4cf2a79c7bc1caef,Vercel Release Bot,2023-09-05 20:28:17+00:00,GitHub,2023-09-05 20:28:17+00:00,"[tests] Upgrade Turbo to version 1.10.13 (#10404)

This auto-generated PR updates Turbo to version 1.10.13",2023,9
e90e922ee8a23c072642e3dd1ceb5001fea21a88,Sean Massa,2023-09-05 19:51:44+00:00,GitHub,2023-09-05 19:51:44+00:00,"migrate dev command structure for help output (#10433)

Migrates the `vc git` command to the command data structure for use in the help output.

---

<img width=""1891"" alt=""Screenshot 2023-08-31 at 1 35 07 PM"" src=""https://github.com/vercel/vercel/assets/41545/d3d63faa-9427-49e8-8137-a76d4c208cb3"">",2023,9
adb9ac87ce3e8f1660e6ac624bbbe6be91dfed8f,Trek Glowacki,2023-09-05 16:17:18+00:00,GitHub,2023-09-05 16:17:18+00:00,"[cli] Remove `mri` workaround (#10452)

As of https://github.com/vercel/vercel/pull/10389 the `mri` package is no longer used and this workaround can be removed.",2023,9
e43191b1866da70a3dab3815a3f2176942240ef3,Steven,2023-09-01 14:39:52+00:00,GitHub,2023-09-01 14:39:52+00:00,"[next] fix 404 enoent for i18n (#10416)

This PR fixes the following error:

```
Error: ENOENT: no such file or directory, open '/vercel/path0/.next/server/pages/en/404.html'
```


https://github.com/vercel/vercel/actions/runs/6030773334/job/16364078054?pr=10415#step:9:1352",2023,9
a962e84409c9878efab11a1702fae6942da19ee7,Dan Stowell,2023-08-31 23:10:28+00:00,GitHub,2023-08-31 23:10:28+00:00,"migrate `env` to command structure (#10429)

Migrates the `vc env` command to the command data structure for use in the help output.",2023,8
7593e219fd13972f0b94a1e6d9e3bb57382abee6,Trek Glowacki,2023-08-31 22:45:44+00:00,GitHub,2023-08-31 22:45:44+00:00,"[cli] Update `project` command to new structure (#10432)

Before:
<img width=""687"" alt=""CleanShot 2023-08-31 at 13 29 29@2x"" src=""https://github.com/vercel/vercel/assets/9736/87e0f445-701a-4851-b73f-c787db01abe3"">

After:
<img width=""868"" alt=""CleanShot 2023-08-31 at 13 31 50@2x"" src=""https://github.com/vercel/vercel/assets/9736/b6820654-3254-4a65-820a-30ff7b577a44"">",2023,8
ec9506668992c7db084c043f4928b4cfb37d30de,Dan Stowell,2023-08-31 22:17:51+00:00,GitHub,2023-08-31 22:17:51+00:00,migrate `vc secrets` to help command structure (#10435),2023,8
42a71416b963c15ba50608aa0be4c30b55503dc8,Sean Massa,2023-08-31 21:48:09+00:00,GitHub,2023-08-31 21:48:09+00:00,"migrate `init` command structure for help output (#10428)

Migrates the `vc init` command to the command data structure for use in the help output.

---

<img width=""1891"" alt=""Screenshot 2023-08-31 at 11 36 37 AM"" src=""https://github.com/vercel/vercel/assets/41545/1caeb203-470f-49a5-86b2-273b04bc0489"">",2023,8
80af30ce60dfa6819425241fa8df807df3b07802,Sean Massa,2023-08-31 21:02:49+00:00,GitHub,2023-08-31 21:02:49+00:00,migrate `git` command structure for help output (#10431),2023,8
74a15b5f324be3a242c7fd2b715ebf9753d5f051,Sean Massa,2023-08-31 19:09:59+00:00,GitHub,2023-08-31 19:09:59+00:00,"migrate `rollback` command structure for help output (#10426)

Migrates the `vc rollback` command to the command data structure for use in the help output.

---

<img width=""1891"" alt=""Screenshot 2023-08-31 at 11 25 49 AM"" src=""https://github.com/vercel/vercel/assets/41545/a6d802ac-3851-4641-b950-764fc65fa9d2"">",2023,8
c0416f7e95c2008011ec826488f4c9a143722faa,Sean Massa,2023-08-31 18:41:55+00:00,GitHub,2023-08-31 18:41:55+00:00,"migrate `promote` command structure for help output (#10425)

Migrates the `vc promote` command to the command data structure for use in the help output.

---

<img width=""1878"" alt=""Screenshot 2023-08-31 at 11 04 32 AM"" src=""https://github.com/vercel/vercel/assets/41545/b79c6aec-af03-4685-8ee4-9c0d89b2f236"">",2023,8
fc1e13c09928c654410b373fc1775c2b63c6ef4a,Kiko Beats,2023-08-31 14:34:27+00:00,GitHub,2023-08-31 14:34:27+00:00,fix: remove console.log (#10417),2023,8
0e9ec194a3346c843ba3d00d57dd5132dec2af42,Nathan Rajlich,2023-08-29 05:50:30+00:00,GitHub,2023-08-29 05:50:30+00:00,Keep `vercel@canary` up to date with `vercel@latest` (#10410),2023,8
5609a1187be9d6cf8d5f16825690c5ea72f17dc5,Sean Massa,2023-08-27 00:49:47+00:00,GitHub,2023-08-27 00:49:47+00:00,[build-utils] add descriptions to NodeVersion properties (#10403),2023,8
cff72e3129f369c62d1d39417445c2f6263a0e89,Sean Massa,2023-08-25 15:01:55+00:00,GitHub,2023-08-25 15:01:55+00:00,"[examples] fix redwood template and update examples to use at least node@16 (#10395)

The redwood template was broken because it would use node@18, which is not supported for the version of redwood used in the template. This PR updates that version to be node@16, which does work.

While we're at it, I also updated other examples to be at least node@16. I tested deployments of each of these and the all work.",2023,8
d3c84e5d2ab5addf057876ffaca12b389439d450,Vercel Release Bot,2023-08-24 21:04:39+00:00,GitHub,2023-08-24 21:04:39+00:00,"Version Packages (#10398)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
9e3827c785e1bc45f2bed421132167381481770f,Andrew Barba,2023-08-24 20:44:30+00:00,GitHub,2023-08-24 20:44:30+00:00,"[build-utils] Support serverless function architecture (#10392)

# Problem

Framework authors often produce build outputs from platforms like Github
Actions or M1 Macs where the arm64 architecture is being used. They then
deploy these outputs to Vercel using `vercel deploy`, bypassing Vercel's
build system. Today they must cross compile to x86_64 in order to deploy
compatible Serverless functions to Vercel.

# Solution

Allow Framework authors to detect the current architecture and specify
either x86_64 or arm64 when deploying a Serverless function to Vercel.

# Related PRs

https://github.com/vercel/api/pull/21559

https://github.com/vercel/proxy/pull/6901

https://github.com/vercel/front/pull/24924",2023,8
fb6d77afac7c951a22c834f14d4b2149d712bff0,Trek Glowacki,2023-08-24 20:09:13+00:00,GitHub,2023-08-24 20:09:13+00:00,[cli] Improve error messages for JSON parse issues (#10396),2023,8
cfc1bb180b80931417765e87426704c46bb1ef53,Vercel Release Bot,2023-08-24 18:56:29+00:00,GitHub,2023-08-24 18:56:29+00:00,"Version Packages (#10384)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
f06776468f2b680e146364071cd219080356d1f0,Trek Glowacki,2023-08-24 18:05:11+00:00,GitHub,2023-08-24 18:05:11+00:00,"[cli] Remove mri package (#10389)

`vc secrets` appears to be mostly deprecated but this was a fairly straightforward change that lets us drop `mri` today. Tested pretty extensively locally.",2023,8
597a8a81764c39e70c65b98e78bf4c3827a779a7,Kiko Beats,2023-08-24 14:52:49+00:00,GitHub,2023-08-24 14:52:49+00:00,upgrade edge-runtime (#10385),2023,8
3f6d99470db86681e006d66507f32afcea086b41,Kiko Beats,2023-08-24 08:06:33+00:00,GitHub,2023-08-24 08:06:33+00:00,[node] use `undici` instead of `node-fetch` (#10387),2023,8
44223268651f1bbd5c6f2b0b315239685dd5716e,JJ Kasper,2023-08-24 05:26:58+00:00,GitHub,2023-08-24 05:26:58+00:00,"Add handling to leverage RSC prefetch outputs (#10390)

Implements handling for the RSC prefetch outputs when available that
were added in https://github.com/vercel/next.js/pull/54403",2023,8
09446a8fe8b8201dbe3ead3ca645ef0aa1833b6b,Zack Tanner,2023-08-23 22:30:33+00:00,GitHub,2023-08-23 22:30:33+00:00,"[next] fix RSC matching behavior & 404 status code on `fallback: false` (#10388)

Fixes two separate issues for the Next builder:

- `pages` routes unexpectedly matching to RSC routes when prefetching from `app`. This update will attempt to match the route with the corresponding `pages` entry rather than falling back to a catch-all RSC
  - Fixes https://github.com/vercel/next.js/issues/53776
- `fallback: false` returning a successful status code when underlying page as a param (e.g. `/blog/[slug]` would 200 but `/blog/non-existent` would 404)
  - [slack x-ref](https://vercel.slack.com/archives/C03S8ED1DKM/p1692817762403579)",2023,8
37e93a91a8659934eac7f5cd441b310511bf5646,Vercel Release Bot,2023-08-22 20:49:48+00:00,GitHub,2023-08-22 20:49:48+00:00,"[remix] Update `@remix-run/dev` to v1.19.3 (#10381)

This auto-generated PR updates `@remix-run/dev` to version 1.19.3.",2023,8
eec6e4723235c9166785ad2a8e596515375964d5,Trek Glowacki,2023-08-22 20:24:19+00:00,GitHub,2023-08-22 20:24:19+00:00,"[cli] Update `dns` commands to new structure (#10379)

Before:
<img width=""795"" alt=""CleanShot 2023-08-22 at 10 46 34@2x"" src=""https://github.com/vercel/vercel/assets/9736/456faef8-6335-46ac-89ae-5ce13db4568e"">


After:
<img width=""815"" alt=""CleanShot 2023-08-22 at 10 48 04@2x"" src=""https://github.com/vercel/vercel/assets/9736/e78a9cc5-d9e9-4079-bd4a-81cd68917127"">",2023,8
3a0cfce669d63e79ac3e4f3eb690eb0a5c89866b,Vercel Release Bot,2023-08-22 19:43:00+00:00,GitHub,2023-08-22 19:43:00+00:00,"Version Packages (#10375)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
ae4a9535c12ce33c11cc18743ec1d17e29a7d92c,Maz,2023-08-22 19:27:29+00:00,GitHub,2023-08-22 19:27:29+00:00,"[cli] Add `--git-branch` to pull command help output (#10382)

Improves the help for pull command by adding --git-branch to the output.",2023,8
c615423a0b60ed64bf5e0e10bbc4ca997c31bd60,Sean Massa,2023-08-22 17:31:19+00:00,GitHub,2023-08-22 17:31:19+00:00,"[frameworks] move some `devDependencies` to `dependencies` (#10380)

Because `frameworks` isn't bundled with `ncc`, we need the runtime dependencies to exist in the `dependencies` section of `package.json`.",2023,8
96f99c714715651b85eb7a03f58ecc9e1316d156,Steven,2023-08-22 17:04:57+00:00,GitHub,2023-08-22 17:04:57+00:00,"[error-utils] fix `files` in package.json to use `dist` (#10378)

These packages were publishing unnecessary files to npm so we can reduce to only the `dist` directory.

- Example: https://unpkg.com/browse/@vercel/error-utils@2.0.0/
- Docs: https://docs.npmjs.com/cli/v9/configuring-npm/package-json#files",2023,8
8f318d44cb517abaf6f906450829e58a88e36f74,Trek Glowacki,2023-08-22 15:33:36+00:00,GitHub,2023-08-22 15:33:36+00:00,"Migrate `certs` to new command structure (#10377)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,8
ade5e4ea0a59f6f4e54c8b577245eae9390c8dc7,Vercel Release Bot,2023-08-21 23:55:07+00:00,GitHub,2023-08-21 23:55:07+00:00,"[examples][tests] Upgrade Next.js to version 13.4.19 (#10373)

This auto-generated PR updates 3 packages to Next.js version 13.4.19",2023,8
87dee36ef9f6405fcb76f555961ddf4fe07ee27e,Trek Glowacki,2023-08-21 21:31:02+00:00,GitHub,2023-08-21 21:31:02+00:00,"[cli] Update new `--help` structure to support subcommands (#10372)

Before:
<img width=""727"" alt=""CleanShot 2023-08-21 at 11 07 25@2x"" src=""https://github.com/vercel/vercel/assets/9736/1ff4b5b8-75e3-4fcb-b44a-7172e7612ecc"">

After:
<img width=""759"" alt=""CleanShot 2023-08-21 at 11 13 21@2x"" src=""https://github.com/vercel/vercel/assets/9736/acdd954a-6137-4535-8fbb-db025491156b"">

Some notes re: ""Before""

* We've dropped wrapping required args in `<>` some time ago.
* The command name for alias is optional (default is `set`) but was incorrectly still listed as required.",2023,8
c97407da49ab8997badfd9e6805d5db7ce671d70,Vercel Release Bot,2023-08-21 20:10:45+00:00,GitHub,2023-08-21 20:10:45+00:00,"Version Packages (#10361)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
37f5c6270058336072ca733673ea72dd6c56bd6a,Steven,2023-08-21 12:51:38+00:00,GitHub,2023-08-21 12:51:38+00:00,"BREAKING CHANGE: Drop Node.js 14, bump minimum to Node.js 16 (#10369)

https://vercel.com/changelog/node-js-14-and-16-are-being-deprecated


https://github.com/nodejs/Release/blob/main/README.md#end-of-life-releases",2023,8
104ab0332dd91d97d0ecd93b6f527b56548207f7,Trek Glowacki,2023-08-18 20:01:45+00:00,GitHub,2023-08-18 20:01:45+00:00,"[cli] Wrap description in help output (#10370)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,8
8ed71bea65dc43159a044f9bc34d28ffd1fb2066,Vercel Release Bot,2023-08-18 17:36:13+00:00,GitHub,2023-08-18 17:36:13+00:00,"[examples][tests] Upgrade Next.js to version 13.4.18 (#10366)

This auto-generated PR updates 3 packages to Next.js version 13.4.18",2023,8
bc7a5d38be1016e265fd19f3cf146aa5609fc4ec,Chris Barber,2023-08-18 17:10:40+00:00,GitHub,2023-08-18 17:10:40+00:00,"Exclude Gatsby from default 404 error route (#10365)

All static builds (except Next.js) have a default 404 error route. This PR add the exclusion of Gatsby from being assigned a 404 error route. The error routes are now introduced by the `gatsby-plugin-vercel-builder`.

Linear: https://linear.app/vercel/issue/VCCLI-749/fix-gatsby-404500-pages-directory-listing-bug",2023,8
09174df6cfbe697ea13e75468b9cd3c6ec7ad01c,Nathan Rajlich,2023-08-17 19:17:28+00:00,GitHub,2023-08-17 19:17:28+00:00,"[remix] Only add workspace check flag for Yarn v1 (#10364)

Yarn v2/v3 do not require this flag.",2023,8
6aa2dc6f510082e0bbb450660faf27f1e6375c35,Trek Glowacki,2023-08-17 15:31:16+00:00,GitHub,2023-08-17 15:31:16+00:00,"Connecting Datadog / GH Actions / Turbo / Jest to detect flakey tests (#10334)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>
Co-authored-by: Steven <steven@ceriously.com>",2023,8
9db3794735481881289c560baef9702c1710c70c,Vercel Release Bot,2023-08-17 14:09:28+00:00,GitHub,2023-08-17 14:09:28+00:00,"[examples][tests] Upgrade Next.js to version 13.4.17 (#10362)

This auto-generated PR updates 3 packages to Next.js version 13.4.17",2023,8
ed806d8a6b560b173ba80b24cbfafaa6f179d8b1,Nathan Rajlich,2023-08-17 07:30:32+00:00,GitHub,2023-08-17 07:30:32+00:00,"[frameworks][fs-detectors] Add ""supersedes"" prop to Framework interface (#10345)

The `supersedes` property on the `Framework` interface may be specified by a framework in which the superseded framework should _not_ be included in the resulting framework matches during detection.

For example, a Hydrogen v2 project matches both the ""remix"" and ""hydrogen"" framework detectors, but we really only want ""remix"" to be selected.",2023,8
de9a1dbab7d9e0729ff2e9a5b5ba4ec051750540,Vercel Release Bot,2023-08-17 03:34:05+00:00,GitHub,2023-08-17 03:34:05+00:00,"Version Packages (#10359)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@31.4.0

### Minor Changes

- Force-publish ([#10358](https://github.com/vercel/vercel/pull/10358))

### Patch Changes

- Updated dependencies
\[[`6e44757ff`](https://github.com/vercel/vercel/commit/6e44757ff5d7d80ba6db2ab5ea65213392ecf1cd)]:
    -   @vercel/static-build@1.4.0

## @vercel/static-build@1.4.0

### Minor Changes

- Force-publish ([#10358](https://github.com/vercel/vercel/pull/10358))",2023,8
ae9b33b801c259600e5536c652a824af2dc3e600,Nathan Rajlich,2023-08-17 03:12:12+00:00,Nathan Rajlich,2023-08-17 03:12:12+00:00,Force-publish on `@vercel/static-build`,2023,8
6e44757ff5d7d80ba6db2ab5ea65213392ecf1cd,Chris Barber,2023-08-16 23:19:43+00:00,GitHub,2023-08-16 23:19:43+00:00,"v31.4.0 (#10358)

https://github.com/vercel/vercel/pull/10356 didn't publish a new CLI release, so this PR should do the trick.",2023,8
8dcefe5e83d2db1f828d7a559ccdd26e05209899,Vercel Release Bot,2023-08-16 23:02:42+00:00,GitHub,2023-08-16 23:02:42+00:00,"Version Packages (#10356)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
65ab3b23e9db008ecc13b425a7adcf5a6c1ef568,Riz,2023-08-16 21:29:09+00:00,GitHub,2023-08-16 21:29:09+00:00,"[frameworks] Amend Hugo default `buildCommand` to exclude drafts enabled flag (#7326)

### Related Issues

Reported in https://github.com/vercel/community/discussions/194

Having the `-D` flag results in all draft content to be published (docs reference [here](https://gohugo.io/getting-started/usage/)).

### üìã Checklist

<!--
  Please keep your PR as a Draft until the checklist is complete
-->

#### Tests

- [ ] The code changed/added as part of this PR has been covered with tests
- [ ] All tests pass locally with `yarn test-unit`

#### Code Review

- [x] This PR has a concise title and thorough description useful to a reviewer
- [ ] Issue from task tracker has a link to this PR",2023,8
8f152a59398196bf2e70f9ad01047cb92fb95143,Nathan Rajlich,2023-08-16 20:59:14+00:00,GitHub,2023-08-16 20:59:14+00:00,[build-utils] Fix Node 14.x tests (#10355),2023,8
10a6aa55f928023dfa5be3ed12bf0e2b9bf728b5,Nathan Rajlich,2023-08-15 21:59:21+00:00,GitHub,2023-08-15 21:59:21+00:00,"[tests] Fix failures due to Node 14.x being discontinued (#10346)

This PR upgrades test fixtures from Node.js 14 to 16 and also removes
the `35-puppeteer` test fixture since it doesn't support Node.js 16
unfortunately.

- See https://github.com/alixaxel/chrome-aws-lambda/pull/274

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,8
936a4284206ca682ef7155c0c9492afd13d43bab,Vercel Release Bot,2023-08-15 15:21:06+00:00,GitHub,2023-08-15 15:21:06+00:00,"[examples][tests] Upgrade Next.js to version 13.4.16 (#10344)

This auto-generated PR updates 3 packages to Next.js version 13.4.16

Closes #10339",2023,8
a93e1a7a6438b7edd032cff0d695cffc577f167b,Steven,2023-08-15 15:05:31+00:00,GitHub,2023-08-15 15:05:31+00:00,"[examples] update ember example (#10347)

This PR updates the ember example using the following:

```
npx ember new ember-quickstart --lang en
```

I also had to add `{ 'ember-welcome-page': { enabled: true } }` to the
build config because the `<WelcomePage>` only works in dev, but throws
when using the default build command:

```
ember build --environment=production
```

For posterity, the error looks like:
```
Uncaught TypeError: Cannot destructure property 'manager' of 'e' as it is null.
    at u.resolvedComponent (vendor-2e12520b7a71eead28708a24fafa7fbc.js:2094:28)
    at vendor-2e12520b7a71eead28708a24fafa7fbc.js:1999:5
    at ne (vendor-2e12520b7a71eead28708a24fafa7fbc.js:1999:30)
    at l (vendor-2e12520b7a71eead28708a24fafa7fbc.js:1991:18)
    at vendor-2e12520b7a71eead28708a24fafa7fbc.js:1981:836
    at _.compile (vendor-2e12520b7a71eead28708a24fafa7fbc.js:1938:173)
    at re (vendor-2e12520b7a71eead28708a24fafa7fbc.js:1991:61)
    at vendor-2e12520b7a71eead28708a24fafa7fbc.js:1988:30
    at ee.compile (vendor-2e12520b7a71eead28708a24fafa7fbc.js:1989:23)
    at Object.evaluate (vendor-2e12520b7a71eead28708a24fafa7fbc.js:2431:224)
```

- Related https://github.com/emberjs/ember.js/issues/19912
- Related https://github.com/ember-cli/ember-welcome-page/issues/385",2023,8
4ba188ce44f363d3b34fb7e9bdaf5f220686dabf,Trek Glowacki,2023-08-15 07:33:24+00:00,GitHub,2023-08-15 07:33:24+00:00,"[cli] fix tyops (#10338)

Followup to #10333",2023,8
7682c9234c52b509ec4bdf1915195f5dce77271c,Vercel Release Bot,2023-08-15 01:13:53+00:00,GitHub,2023-08-15 01:13:53+00:00,"Version Packages (#10343)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@31.3.1

### Patch Changes

- Updated dependencies
\[[`844fb6e88`](https://github.com/vercel/vercel/commit/844fb6e880a980f26945f15a7437b4d67bcb5394)]:
    -   @vercel/remix-builder@1.10.1

## @vercel/remix-builder@1.10.1

### Patch Changes

- Set default env vars for Hydrogen v2 deployments
([#10341](https://github.com/vercel/vercel/pull/10341))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
844fb6e880a980f26945f15a7437b4d67bcb5394,Nathan Rajlich,2023-08-15 01:11:01+00:00,GitHub,2023-08-15 01:11:01+00:00,"[remix] Set default env vars for Hydrogen v2 deployments (#10341)

In order to make the default mock shop created from `npm create @shopify/hydrogen@latest` work out-of-the-box and without additional configuration, set the necessary default environment variables to make the server not render an error.",2023,8
ae20c7230f40a07b2db8a4e16c15dc9e79f7054e,Nathan Rajlich,2023-08-15 00:50:52+00:00,GitHub,2023-08-15 00:50:52+00:00,"[cli] Use `vercel-php@0.6.0` in e2e test fixture (#10342)

`0.5.2` uses Node 14, so this test was failing.

<img width=""934"" alt=""Screenshot 2023-08-14 at 5 13 31 PM""
src=""https://github.com/vercel/vercel/assets/71256/654c8f71-6006-4b98-9ef0-fe288651d158"">",2023,8
a36b8eb738570a90e385424d851b40efdccd2ac3,Nathan Rajlich,2023-08-14 23:05:12+00:00,GitHub,2023-08-14 23:05:12+00:00,"[examples] Update ""hydrogen-2"" template readme (#10340)

A few tweaks to the readme file for `hydrogen-2`, based on feedback from
Shopify.",2023,8
78be5aedd51e82e21edf1e7c3d193163c1eb6546,Vercel Release Bot,2023-08-14 19:00:01+00:00,GitHub,2023-08-14 19:00:01+00:00,"Version Packages (#10318)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@31.3.0

### Minor Changes

- Update help output to use cli-table3
([#10333](https://github.com/vercel/vercel/pull/10333))

### Patch Changes

- Sanitize argv in log during `vc build`.
([#10311](https://github.com/vercel/vercel/pull/10311))

- Respect `--yes` flag for all prompts during `vc link --repo`
([#10337](https://github.com/vercel/vercel/pull/10337))

- Updated dependencies
\[[`8cb9385fd`](https://github.com/vercel/vercel/commit/8cb9385fd306d0c2b8771d7bb063e6948ed15729),
[`94c93dfb5`](https://github.com/vercel/vercel/commit/94c93dfb5b29aa58317f9d0854273d4880d91a62)]:
    -   @vercel/node@2.15.10
    -   @vercel/static-build@1.3.46

## @vercel/frameworks@1.5.1

### Patch Changes

- Add ""(v1)"" suffix to ""hydrogen"" preset
([#10320](https://github.com/vercel/vercel/pull/10320))

- Use parenthesis on Docusaurus ""name"" fields
([#10324](https://github.com/vercel/vercel/pull/10324))

## @vercel/fs-detectors@4.1.2

### Patch Changes

- Updated dependencies
\[[`33d9c1b7f`](https://github.com/vercel/vercel/commit/33d9c1b7f901b0ef6a28398942b6d447cfea882f),
[`f54598724`](https://github.com/vercel/vercel/commit/f54598724c3cb7fc0761cf452f34d527fd5be16f)]:
    -   @vercel/frameworks@1.5.1

## @vercel/gatsby-plugin-vercel-builder@1.3.18

### Patch Changes

- Updated dependencies
\[[`8cb9385fd`](https://github.com/vercel/vercel/commit/8cb9385fd306d0c2b8771d7bb063e6948ed15729),
[`94c93dfb5`](https://github.com/vercel/vercel/commit/94c93dfb5b29aa58317f9d0854273d4880d91a62)]:
    -   @vercel/node@2.15.10

## @vercel/node@2.15.10

### Patch Changes

- Update 'edge-runtime' to 2.4.4
([#10255](https://github.com/vercel/vercel/pull/10255))

- `edge-light` condition interoperability with `vercel dev`
([#10313](https://github.com/vercel/vercel/pull/10313))

## @vercel/static-build@1.3.46

### Patch Changes

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@1.3.18

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
a1c3bfb50f27aba17b55cdedda23316d594fd018,Nathan Rajlich,2023-08-14 18:26:45+00:00,GitHub,2023-08-14 18:26:45+00:00,"[cli] Respect `--yes` flag for all prompts during `vc link --repo` (#10337)

A couple of the prompts during `vc link --repo` were not honoring the `--yes` flag.",2023,8
78fa02292d33ac1e31876259db926f5dc669b3c5,Trek Glowacki,2023-08-14 15:12:43+00:00,GitHub,2023-08-14 15:12:43+00:00,"[cli] Swap custom table code with `cli-table3` (#10333)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,8
94c93dfb5b29aa58317f9d0854273d4880d91a62,Vladislav Ponomarev,2023-08-11 18:08:34+00:00,GitHub,2023-08-11 18:08:34+00:00,"`edge-light` condition interoperability with `vercel dev` (#10313)

Co-authored-by: Chris Barber <chris.barber@vercel.com>
Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,8
19addabb6ed68d49dfa924c42c6db55251c5184f,Trek Glowacki,2023-08-11 16:18:13+00:00,GitHub,2023-08-11 16:18:13+00:00,"[cli] Add tests to demonstrate function detection precedence (#10331)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,8
45fc0dd714ab8c7b67bdb6cc1502671470a44006,Lee Robinson,2023-08-11 00:09:02+00:00,GitHub,2023-08-11 00:09:02+00:00,"[examples] Update Storybook template (#10063)

To use stable App Router.

New deployment: https://storybook-template.vercel.app/",2023,8
fc524a1e6a18425ca5de4972ada3ea93dbc97565,Nathan Rajlich,2023-08-10 23:49:05+00:00,GitHub,2023-08-10 23:49:05+00:00,Fixes for changeset from #10255 (#10328),2023,8
8cb9385fd306d0c2b8771d7bb063e6948ed15729,Hassan Bazzi,2023-08-10 23:39:35+00:00,GitHub,2023-08-10 23:39:35+00:00,"[node] bump edge-runtime to 2.4.4 (#10255)

# Summary

Edge-runtime 2.4.4 has many bug fixes, but most importantly it adds support for stream cancellation to the edge runtime. This is extremely important since a lot of projects are using `streams` related to `ai`. They currently have no way of handling a cancellation coming from the client.

This was introduced to `next` with as described by this comment: https://github.com/vercel-labs/ai/issues/90#issuecomment-1618915409

You can find the PR for that here: https://github.com/vercel/next.js/pull/51727

It also has a good description for what we're trying to do here, but for people not using `next`

# Problem

When a client sends an abort signal, it is currently not being handled by edge functions. This was fixed in edge-runtime@2.4.4

# Solution

Update the package",2023,8
f54598724c3cb7fc0761cf452f34d527fd5be16f,Nathan Rajlich,2023-08-10 22:41:00+00:00,GitHub,2023-08-10 22:41:00+00:00,"[frameworks] Use parenthesis on Docusaurus and SvelteKit ""name"" fields (#10324)

For consistency with https://github.com/vercel/vercel/pull/10320.",2023,8
abd1197c90554e102846929125460c9b5c299062,Nathan Rajlich,2023-08-10 21:25:51+00:00,GitHub,2023-08-10 21:25:51+00:00,"[fs-detectors] Fix ""hydrogen-2"" detection unit test (#10325)

Follow-up to https://github.com/vercel/vercel/pull/10319, which didn't exhibit this failing test since the fs-detectors package was not changed, and thus those tests didn't run.",2023,8
db27f409b6d6d0ebcf4344d2e25a1636b264faac,Trek Glowacki,2023-08-10 18:04:24+00:00,GitHub,2023-08-10 18:04:24+00:00,"[cli] tidy up use of package name and logo (#10323)

I erred on the side of preferring the more recently added versions of this behavior. I assume at some point in the distant past the removed function correctly toggled between some now/zeit/vercel transitioning.",2023,8
33d9c1b7f901b0ef6a28398942b6d447cfea882f,Nathan Rajlich,2023-08-10 02:32:57+00:00,GitHub,2023-08-10 02:32:57+00:00,"[frameworks] Add ""(v1)"" suffix to ""hydrogen"" preset (#10320)

Now that the ""remix"" preset should be used for Hydrogen v2, it's not very clear that the ""hydrogen"" preset is only meant to be used for Hydrogen v1.

So add clarification in the ""name"" of the ""hydrogen"" preset to help remedy that.",2023,8
97659c687b51473694b55ea66308dc4b49ca142a,Nathan Rajlich,2023-08-10 00:11:33+00:00,GitHub,2023-08-10 00:11:33+00:00,"[examples] Add ""hydrogen-2"" template (#10319)

Adds a Hydrogen v2 template which is the output of the `npm create @shopify/hydrogen@latest` command.

Note that a `vercel.json` file is being used to define the environment variables that are required at runtime. This is required for the template to deploy with zero configuration, however the user should update these values (including replacing the session secret) and migrate them to the Project settings in the Vercel dashboard.

[Live example](https://hydrogen-v2-template.vercel.app)",2023,8
d6f18f4e2d502bd37871b29067e322911dbe8c4d,Chris Barber,2023-08-09 15:01:18+00:00,GitHub,2023-08-09 15:01:18+00:00,"[cli] Sanitize argv for `vc build` (#10311)

`vc build` writes a file `.vercel/output/build.json` that contains the `argv` contents which could include sensitive information that needs to be sanitized.",2023,8
f43e413ba5a1d6b81d89221405f203fac0b68aca,Vercel Release Bot,2023-08-08 22:10:58+00:00,GitHub,2023-08-08 22:10:58+00:00,"Version Packages (#10302)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
0945d24cbe901ca3f0eedd011251ad499c72d472,Nathan Rajlich,2023-08-08 21:39:57+00:00,GitHub,2023-08-08 21:39:57+00:00,"[remix] Add initial support for Hydrogen v2 (#10305)

Enables support for Hydrogen v2 apps using the ""Remix"" preset. This initial support works with the Hydrogen demo store template unmodified, and all pages will use Edge functions.

Node.js runtime, and also any other configuration via `export const config`, are not supported at this time, due to some pending blockers.",2023,8
a8ecf40d6f50e2fc8b13b02c8ef50b3dcafad3a6,Steven,2023-08-08 18:43:20+00:00,GitHub,2023-08-08 18:43:20+00:00,"[build-utils] Fix `getPrefixedEnvVars()` to handle `VERCEL_BRANCH_URL` (#10315)

- Fixes [NEXT-1500](https://linear.app/vercel/issue/NEXT-1500)
- See
[documentation](https://vercel.com/docs/concepts/projects/environment-variables/system-environment-variables#framework-environment-variables)",2023,8
2995781a583a9c6df15f6447667ff7adaa0d3bfd,Steven,2023-08-07 20:36:40+00:00,Steven,2023-08-07 20:36:40+00:00,"Revert ""Just testing changeset stuff""

This reverts commit e2096c268defa7adddc3595d6d294ff8efdf7ee4.",2023,8
e2096c268defa7adddc3595d6d294ff8efdf7ee4,Trek Glowacki,2023-08-07 20:33:26+00:00,Trek Glowacki,2023-08-07 20:33:26+00:00,Just testing changeset stuff,2023,8
663d8e64379de58352da894456f3d6810030c506,Amy,2023-08-07 18:33:41+00:00,GitHub,2023-08-07 18:33:41+00:00,"Update discussion templates (#10297)

The current note on discussion templates is not bold enough and easily overlooked.

In an effort to reduce off-topic discussion clutter in this repo and direct folks to the general support community which I monitor more closely, this update makes the note more prominent.",2023,8
153ca440fa532458b7dcec70d32a2c2b972e8210,Trek Glowacki,2023-08-07 18:14:21+00:00,GitHub,2023-08-07 18:14:21+00:00,"Add basic tests for remove command (#10304)

Adds some minimal unit testing for the `remove` command. There is currently none.",2023,8
c5e0cb4812c34db7cba426ad46e8684dd0442cbf,Steven,2023-08-07 16:44:41+00:00,GitHub,2023-08-07 16:44:41+00:00,"chore(ci): fix turbo logs to no longer group (#10310)

When we upgraded `turbo`, the default `--log-order` changed from `stream` to `grouped`.

This PR changes it back to `stream` which will prevent the collapsed group view that we currently see in CI.

https://turbo.build/repo/docs/reference/command-line-reference/run#--log-order

> If log order is set to auto and turbo detects that it is running on GitHub Actions, then turbo will create grouped logs(opens in a new tab). You can opt out of this behavior by setting a log order of your own.",2023,8
5bf1fe4c743f6be3f7d5a24447ea5b083a68dc67,Seiya Nuta,2023-08-07 16:05:39+00:00,GitHub,2023-08-07 16:05:39+00:00,"[next] Preserve sourceMappingURL comments in template literals (#10275)

We noticed some edge function builds are failing unexpectedly due to `SyntaxError`. It's triggered by valid code in [Webpack's style-loader](https://github.com/webpack-contrib/style-loader/blob/16e401b17a39544d5c8ca47c9032f02e2b60d8f5/src/runtime/styleDomAPI.js#L35C1-L40C1):

```
  if (sourceMap && typeof btoa !== ""undefined"") {
    css += `\n/*# sourceMappingURL=data:application/json;base64,${btoa(
      unescape(encodeURIComponent(JSON.stringify(sourceMap)))
    )} */`;
  }
```

After minification this script looks like:

```
sourceMap&&typeof btoa!=""undefined""&&(css+=`
/*# sourceMappingURL=data:application/json;base64,${btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))} */`);
```

The key point here is `\n` is replaced with newline character (`0x0A`) and the second line starts with `/*# sourceMappingURL=`. This confuses `removeComments` API in [convert-source-map](https://github.com/thlorenz/convert-source-map/tree/master) package and it removes the second line:

```
sourceMap&&typeof btoa!=""undefined""&&(css+=`

```

In this PR, we implement source map stripping based on that package's regex but add some heuristic checks to prevent false positives like above.",2023,8
011f836aa746c819e7cdd2697c05601ce9326d90,Vercel Release Bot,2023-08-07 15:12:14+00:00,GitHub,2023-08-07 15:12:14+00:00,"[examples][tests] Upgrade Next.js to version 13.4.13 (#10308)

This auto-generated PR updates 3 packages to Next.js version 13.4.13",2023,8
ec107d7c91466b25a1c5cf364c66f5b9def245d5,Trek Glowacki,2023-08-07 14:34:49+00:00,GitHub,2023-08-07 14:34:49+00:00,"Handle calls for deployment aliases when mocking deployment API (#10303)

Attempting to add tests to unblock a contributor https://github.com/vercel/vercel/pull/10236#issuecomment-1664183891 and finding a deployment also checks its aliases. This PR updates the mock deployment code to also create a handler for its aliases.",2023,8
0d27ae3b1a7fc8cc7536e6fabcb6b72d35626299,Shu Uesugi,2023-08-07 14:10:22+00:00,GitHub,2023-08-07 14:10:22+00:00,"Remove unused code (#10309)

Reference was removed in https://github.com/vercel/vercel/pull/8377 but the code wasn't removed.",2023,8
08da4b9c923501d9d28eb6e3f26f4605fee83042,Vercel Release Bot,2023-08-04 23:17:40+00:00,GitHub,2023-08-04 23:17:40+00:00,"[remix] Update `@remix-run/dev` to v1.19.2 (#10299)

This auto-generated PR updates `@remix-run/dev` to version 1.19.2.",2023,8
877f09ff5c99fdf8710485dd9e70b0119567bd8a,Trek Glowacki,2023-08-04 15:20:33+00:00,GitHub,2023-08-04 15:20:33+00:00,"Be looser with mock server URLs (#10300)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>",2023,8
5cca9b6c5c523bed8b5c2322a344c9332e417492,Vercel Release Bot,2023-08-02 20:04:48+00:00,GitHub,2023-08-02 20:04:48+00:00,"Version Packages (#10289)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@31.2.2

### Patch Changes

- Migrate list command to new structure
([#10284](https://github.com/vercel/vercel/pull/10284))

- Migrate whoami command to new structure
([#10266](https://github.com/vercel/vercel/pull/10266))

- Migrate logs command to new structure
([#10281](https://github.com/vercel/vercel/pull/10281))

- Migrate login command to new structure
([#10283](https://github.com/vercel/vercel/pull/10283))

- Migrate pull command to new structure
([#10280](https://github.com/vercel/vercel/pull/10280))

- Migrate logout command to new structure
([#10282](https://github.com/vercel/vercel/pull/10282))

- Migrate build command to new structure
([#10286](https://github.com/vercel/vercel/pull/10286))

- Migrate inspect command to new structure
([#10277](https://github.com/vercel/vercel/pull/10277))

- Migrate redeploy command to new structure
([#10279](https://github.com/vercel/vercel/pull/10279))

- Migrate link command to new structure
([#10285](https://github.com/vercel/vercel/pull/10285))

- Update spacing of --help output for CLI
([#10287](https://github.com/vercel/vercel/pull/10287))

- Updated dependencies
\[[`4af242af8`](https://github.com/vercel/vercel/commit/4af242af8633e58b6a9bf920564416da3ef22ad4),
[`0cbdae141`](https://github.com/vercel/vercel/commit/0cbdae1411aa7936ff7dfe551919ca5e56cd6e98),
[`85dd66778`](https://github.com/vercel/vercel/commit/85dd667781693539d753d587566e53964bbe189d)]:
    -   @vercel/node@2.15.8
    -   @vercel/remix-builder@1.9.1
    -   @vercel/static-build@1.3.44

## @vercel/gatsby-plugin-vercel-builder@1.3.16

### Patch Changes

- Updated dependencies
\[[`4af242af8`](https://github.com/vercel/vercel/commit/4af242af8633e58b6a9bf920564416da3ef22ad4),
[`85dd66778`](https://github.com/vercel/vercel/commit/85dd667781693539d753d587566e53964bbe189d)]:
    -   @vercel/node@2.15.8

## @vercel/node@2.15.8

### Patch Changes

- Move `@types/content-type` to dev dependency
([#10292](https://github.com/vercel/vercel/pull/10292))

- fix: compress condition
([#10288](https://github.com/vercel/vercel/pull/10288))

## @vercel/remix-builder@1.9.1

### Patch Changes

- Disable root workspace check in pnpm and yarn when adding deps
([#10291](https://github.com/vercel/vercel/pull/10291))

## @vercel/static-build@1.3.44

### Patch Changes

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@1.3.16

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,8
4af242af8633e58b6a9bf920564416da3ef22ad4,Nathan Rajlich,2023-08-02 20:00:14+00:00,GitHub,2023-08-02 20:00:14+00:00,"[node] Move `@types/content-type` to dev dependency (#10292)

`@types/content-type` is only needed at build time.",2023,8
0cbdae1411aa7936ff7dfe551919ca5e56cd6e98,Nathan Rajlich,2023-08-02 18:36:38+00:00,GitHub,2023-08-02 18:36:38+00:00,"[remix] Disable root workspace check in pnpm and yarn when adding deps (#10291)

The Remix application might _also_ be the root of a workspace, so check for that case and pass the appropriate flag to the package manager to make it not error.

See: https://github.com/orgs/vercel/discussions/3467",2023,8
85dd667781693539d753d587566e53964bbe189d,Kiko Beats,2023-08-02 18:15:16+00:00,GitHub,2023-08-02 18:15:16+00:00,"fix: compress condition (#10288)

I'm experiencing an issue due the condition is wrongly set.

When the response is buffered, it should be `compress: true` since we're acting as proxy, and we're going to recompress again.

When the response is streaming, then it should be `compress: false` since the response is going to be piped.",2023,8
7d3dda7341e7b1d87a324fcdbeb85c8a90b04034,Trek Glowacki,2023-08-02 17:33:59+00:00,GitHub,2023-08-02 17:33:59+00:00,"[cli] Update spacing on `--help` output (#10287)

Indent more items rightwards to tidy up spacing.

Example of unmigrated `bisect` on current `main`:
<img width=""561"" alt=""CleanShot 2023-07-31 at 14 47 38@2x"" src=""https://github.com/vercel/vercel/assets/9736/7474ac88-775c-43aa-937b-3f544c064c6d"">

Migrated example (https://github.com/vercel/vercel/pull/10276) before changes in this PR:
<img width=""661"" alt=""CleanShot 2023-07-31 at 15 07 26@2x"" src=""https://github.com/vercel/vercel/assets/9736/076b247c-35cf-45ea-8713-3c684b5063e4"">


Migrated example after changes in this PR:
<img width=""693"" alt=""CleanShot 2023-07-31 at 14 46 39@2x"" src=""https://github.com/vercel/vercel/assets/9736/f5f056a1-7f68-42e5-a724-79cf86031d09"">",2023,8
2144d0b2a93f3e2a9f0040703c6e63aed87d7c00,Vercel Release Bot,2023-08-02 17:12:33+00:00,GitHub,2023-08-02 17:12:33+00:00,"[tests] Upgrade Turbo to version 1.10.12 (#10270)

This auto-generated PR updates Turbo to version 1.10.12",2023,8
976e6aedf95d59e8b37dac4ac7ae98c5e6687c45,Trek Glowacki,2023-08-02 16:48:24+00:00,GitHub,2023-08-02 16:48:24+00:00,"[cli] Migrate `link` command to new structure (#10285)

Before:
<img width=""785"" alt=""CleanShot 2023-07-31 at 09 55 03@2x"" src=""https://github.com/vercel/vercel/assets/9736/1f60cbcb-354f-4005-bb74-8ffd68a38fba"">

After:
<img width=""785"" alt=""CleanShot 2023-07-31 at 09 55 03@2x"" src=""https://github.com/vercel/vercel/assets/9736/4eea5e82-0304-4949-9e8f-aeaa1b2e74eb"">",2023,8
6328751e148fc4eb046162f410c7b0d68f64ec15,Trek Glowacki,2023-08-02 14:21:57+00:00,GitHub,2023-08-02 14:21:57+00:00,"[cli] Migrate `whoami` to new command structure (#10266)

Migrating `whoami` to the command structure created in #10090. Unsure about tests. This is technically a refactor so existing tests should suffice.",2023,8
8cb49a51361438678deb03966f150119bc2ec6d1,Trek Glowacki,2023-08-02 13:59:49+00:00,GitHub,2023-08-02 13:59:49+00:00,"[cli] Migrate `logout` command to new structure (#10282)

Co-authored-by: Trek Glowacki <trek.glowacki@vercel.com>
Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,8
3fa4f344cccae9b43386145859787fddd09cfb2b,Trek Glowacki,2023-08-01 20:24:25+00:00,GitHub,2023-08-01 20:24:25+00:00,"[cli] Migrate `pull` command to new structure (#10280)

Before:
<img width=""797"" alt=""CleanShot 2023-07-31 at 09 23 44@2x"" src=""https://github.com/vercel/vercel/assets/9736/88edd229-0aab-4155-9739-de64ad42e2f0"">

After:
<img width=""765"" alt=""CleanShot 2023-07-31 at 09 23 59@2x"" src=""https://github.com/vercel/vercel/assets/9736/574d0af0-5ce4-48dd-ad59-c4ca9893c147"">",2023,8
27610896ed2d61c75ebb1ad69fdb3da36fa269c6,Trek Glowacki,2023-08-01 20:05:11+00:00,GitHub,2023-08-01 20:05:11+00:00,"[cli] Migrate `inspect` command to new structure (#10277)

Before:
<img width=""659"" alt=""CleanShot 2023-07-31 at 10 06 01@2x"" src=""https://github.com/vercel/vercel/assets/9736/32c91a94-9ae7-479c-8255-e4b554badd2f"">


After:
<img width=""664"" alt=""CleanShot 2023-07-31 at 10 06 11@2x"" src=""https://github.com/vercel/vercel/assets/9736/9237b42a-a015-4d58-8231-5e257342ac90"">",2023,8
b9dae36e379b9bb9ad4879e17000b5bcae2e9e5c,Trek Glowacki,2023-08-01 19:43:16+00:00,GitHub,2023-08-01 19:43:16+00:00,"[cli] Migrate `logs` command to new structure (#10281)

Before:
<img width=""669"" alt=""CleanShot 2023-07-31 at 09 36 25@2x"" src=""https://github.com/vercel/vercel/assets/9736/ee28d4b7-33eb-49cf-a565-fd4f56bf8bb6"">

After:
<img width=""693"" alt=""CleanShot 2023-07-31 at 09 36 46@2x"" src=""https://github.com/vercel/vercel/assets/9736/450d7c54-216f-4590-98b9-9f6b1a13d040"">",2023,8
1537ff9c381c5cbe52ed26ba704a36e295d82d76,Ilya Komichev,2023-08-01 18:46:39+00:00,GitHub,2023-08-01 18:46:39+00:00,"chore(README): set correct link to nuxt docs (#10265)

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,8
7e0317775f9a8743735d247c5e5506fc52661e9b,Trek Glowacki,2023-08-01 16:59:01+00:00,GitHub,2023-08-01 16:59:01+00:00,"[cli] Migrate `build` command to new structure (#10286)

Before:
<img width=""854"" alt=""CleanShot 2023-07-31 at 09 59 18@2x"" src=""https://github.com/vercel/vercel/assets/9736/7a91572f-1481-4a2a-ac70-2384d6c30560"">

After:
<img width=""907"" alt=""CleanShot 2023-07-31 at 09 59 30@2x"" src=""https://github.com/vercel/vercel/assets/9736/ed358eae-9207-4ebe-ad41-865ce213560e"">",2023,8
2dd27976b3e25ca7f212fbf4b3aaf76573e88507,Trek Glowacki,2023-08-01 16:37:32+00:00,GitHub,2023-08-01 16:37:32+00:00,"[cli] Migrate `redeploy` command to new structure (#10279)

Before:
<img width=""816"" alt=""CleanShot 2023-07-31 at 09 19 16@2x"" src=""https://github.com/vercel/vercel/assets/9736/cf194706-8071-4f86-9a1c-896383a51a29"">

After:
<img width=""673"" alt=""CleanShot 2023-07-31 at 09 19 30@2x"" src=""https://github.com/vercel/vercel/assets/9736/d0f3faed-83e7-40b9-9252-c8b68855a7a3"">",2023,8
25e2b7efba4a7f95d54f0b88b5f26f00e5d584de,Trek Glowacki,2023-08-01 15:43:02+00:00,GitHub,2023-08-01 15:43:02+00:00,"[cli] Migrate `login` command to new structure (#10283)

We currently incorrectly specify the argument is required with `<>`, but the examples show you can do `vercel login` without an argument, so I've corrected that as part of this migration.

Before:
<img width=""549"" alt=""CleanShot 2023-07-31 at 09 44 28@2x"" src=""https://github.com/vercel/vercel/assets/9736/f1b1a328-69e0-4d61-b65c-d2739c81f61c"">


After:
<img width=""684"" alt=""CleanShot 2023-07-31 at 09 44 43@2x"" src=""https://github.com/vercel/vercel/assets/9736/e2bb28bf-e3d8-4d89-ad7e-864dd091ec3d"">",2023,8
3d23d1270cd817651622db9661ead531267e4615,Trek Glowacki,2023-07-31 22:21:11+00:00,GitHub,2023-07-31 22:21:11+00:00,"[cli] Migrate `list` command to new structure (#10284)

Before:

<img width=""809"" alt=""CleanShot 2023-07-31 at 09 51 37@2x"" src=""https://github.com/vercel/vercel/assets/9736/f5ac2ccc-3ff9-4a52-9c93-4a47fe479497"">


After:
<img width=""836"" alt=""CleanShot 2023-07-31 at 09 51 48@2x"" src=""https://github.com/vercel/vercel/assets/9736/48314715-132a-477a-8a66-a5d23c27ee50"">",2023,7
fde40e731a1dcb436b0c661a100742becfbeb390,Vercel Release Bot,2023-07-31 18:31:22+00:00,GitHub,2023-07-31 18:31:22+00:00,"Version Packages (#10278)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,7
f3535274212688dd53125bcc8c9d055f5d93997f,Trek Glowacki,2023-07-31 16:03:13+00:00,GitHub,2023-07-31 16:03:13+00:00,"[cli] Migrate `bisect` command to new structure (#10276)

Migrating `bisect` to the command structure created in https://github.com/vercel/vercel/pull/10090. Unsure about tests. This is technically a refactor so existing tests should suffice.

Before:
<img width=""534"" alt=""CleanShot 2023-07-31 at 08 14 29@2x"" src=""https://github.com/vercel/vercel/assets/9736/8ae53672-9b1f-444a-94d3-296ac0fa8d30"">

After:
<img width=""674"" alt=""CleanShot 2023-07-31 at 08 15 02@2x"" src=""https://github.com/vercel/vercel/assets/9736/0ba12f19-fb34-41f3-84fb-0c1498d7a485"">",2023,7
c1cdfb3e757e1a001e24f12de7a672c580125df0,Trek Glowacki,2023-07-31 15:42:27+00:00,GitHub,2023-07-31 15:42:27+00:00,"[cli] Migrate `remove` command to new structure (#10268)

Migrating `remove` to the command structure created in #10090. Unsure about tests. This is technically a refactor so existing tests should suffice.",2023,7
fc413707d017e234d5013b761d885f65f9b981bc,Kiko Beats,2023-07-31 14:11:18+00:00,GitHub,2023-07-31 14:11:18+00:00,"fix: move content-type as dependency (#10274)

It's required by `serverless-functions/helpers.js` causing unhandled
error because it's missing.

```
Error: Cannot find module 'content-type'
Require stack:
- /Users/kikobeats/Library/pnpm/global/5/.pnpm/@vercel+node@2.15.6/node_modules/@vercel/node/dist/serverless-functions/helpers.js
    at Function.Module._resolveFilename (node:internal/modules/cjs/loader:1077:15)
    at Function.Module._resolveFilename.sharedData.moduleResolveFilenameHook.installedValue [as _resolveFilename] (/Users/kikobeats/Library/pnpm/global/5/.pnpm/@cspotcode+source-map-support@0.8.1/node_modules/@cspotcode/source-map-support/source-map-support.js:811:30)
    at Function.Module._load (node:internal/modules/cjs/loader:922:27)
    at Module.require (node:internal/modules/cjs/loader:1143:19)
    at require (node:internal/modules/cjs/helpers:110:18)
    at Object.<anonymous> (/Users/kikobeats/Library/pnpm/global/5/.pnpm/@vercel+node@2.15.6/node_modules/@vercel/node/dist/serverless-functions/helpers.js:6:24)
    at Module._compile (node:internal/modules/cjs/loader:1256:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1310:10)
    at Object.require.extensions.<computed> [as .js] (/Users/kikobeats/Library/pnpm/global/5/.pnpm/ts-node@10.9.1_@types+node@14.18.33_typescript@4.9.5/node_modules/ts-node/src/index.ts:1608:43)
    at Module.load (node:internal/modules/cjs/loader:1119:32) {
  code: 'MODULE_NOT_FOUND',
  requireStack: [
    '/Users/kikobeats/Library/pnpm/global/5/.pnpm/@vercel+node@2.15.6/node_modules/@vercel/node/dist/serverless-functions/helpers.js'
  ]
}
```",2023,7
e842a8870ea7b2f34b12ab20aff19a91fa52d8c9,Vercel Release Bot,2023-07-28 22:40:19+00:00,GitHub,2023-07-28 22:40:19+00:00,"Version Packages (#10261)

# Releases
## vercel@31.2.0

### Minor Changes

- Add a ""Global Options"" section to help output
([#10250](https://github.com/vercel/vercel/pull/10250))

### Patch Changes

- Updated dependencies
\[[`d1b0dbe3a`](https://github.com/vercel/vercel/commit/d1b0dbe3a7d8754286aa2b7ba0c8b55d3adafdea),
[`4a8622a10`](https://github.com/vercel/vercel/commit/4a8622a10d52260cb629a1c4a6f797ade05ea154),
[`6469ef1b8`](https://github.com/vercel/vercel/commit/6469ef1b8ce37e93f50ab4a108aa0953d7631fe8)]:
    -   @vercel/remix-builder@1.9.0
    -   @vercel/next@3.9.3

## @vercel/remix-builder@1.9.0

### Minor Changes

- Install `@vercel/remix-run-dev` at build-time instead of using symlink
([#9784](https://github.com/vercel/vercel/pull/9784))

### Patch Changes

- Update `@remix-run/dev` fork to v1.19.1
([#10246](https://github.com/vercel/vercel/pull/10246))

## @vercel/next@3.9.3

### Patch Changes

- fix dynamic not found pages
([#10262](https://github.com/vercel/vercel/pull/10262))",2023,7
d1b0dbe3a7d8754286aa2b7ba0c8b55d3adafdea,Nathan Rajlich,2023-07-28 20:49:32+00:00,GitHub,2023-07-28 20:49:32+00:00,"[remix] Install `@vercel/remix-run-dev` at build-time instead of using symlink (#9784)

Instead of including the fork `@remix-run/dev` package as a regular dependency of `@vercel/remix-builder`, install it at build-time by modifying the project's `package.json` file. The reasons for this are:

* Avoids deprecation warnings from a few packages that currently exist on the `@remix-run/dev` package when installing Vercel CLI (those warnings already show up in the build logs anyways, so nothing new there).
* Allows us to install a version as close as possible to the version specified in the user's `package.json` (similar to how we do when auto-injecting the `@vercel/remix` package). This will be especially important once Remix v2 is released, which will have breaking changes compared to v1.

**Note:** `@vercel/remix-run-dev` is still a _dev_ dependency, so that we can use TypeScript types from it, as well as, at runtime, we use the version in the Builder's `package.json` to determine the maximum versions of `@vercel/remix-run-dev` and/or `@vercel/remix` which can safely be installed.

Fixes #10027.
Fixes #10222.",2023,7
d614709308837a81af87fb8a6c82ac10653d94be,Chris Barber,2023-07-28 17:28:45+00:00,GitHub,2023-07-28 17:28:45+00:00,"[codeowners] Add @trek to codeowners (#10267)

Adding Trek so he join in on the code review fun!",2023,7
d5b588bc06697a0628fa43694d791a8bca7611a5,Trek Glowacki,2023-07-27 20:48:07+00:00,GitHub,2023-07-27 20:48:07+00:00,"[cli] Add a ""Global Options"" section to help output (#10250)

Followup PR to #10090. Some of our commands duplicate global options into their `args` structure e.g. https://github.com/vercel/vercel/blob/2661f56347d5c32de369a6cea74bc9fb46d565a2/packages/cli/src/commands/logs.ts#L25-L26

 Others commands omit it entirely.

This updates the `--help` output for commands migrated to our new structure (so far, only `deploy`) will show a ""Global Options"" section:

```
‚ñ≤ vercel deploy [project-path] [options]

Deploy your project to Vercel. The `deploy` command is the default command for the Vercel CLI, and can be omitted (`vc deploy my-app` equals `vc my-app`).

Options

  --archive                    Compress the deployment code into a file before uploading it
  -b, --build-env <key=value>  Specify environment variables during build-time (e.g. `-b KEY1=value1 -b KEY2=value2`)
  -e, --env <key=value>        Specify environment variables during run-time (e.g. `-e KEY1=value1 -e KEY2=value2`)
  -f, --force                  Force a new deployment even if nothing has changed
  -m, --meta <key=value>       Specify metadata for the deployment (e.g. `-m KEY1=value1 -m KEY2=value2`)
  --no-wait                    Don't wait for the deployment to finish
  --prebuilt                   Use in combination with `vc build`. Deploy an existing build
  --prod                       Create a production deployment
  -p, --public                 Deployment is public (`/_src`) is exposed)
  --regions                    Set default regions to enable the deployment on
  --with-cache                 Retain build cache when using ""--force""
  -y, --yes                    Use default options to skip all prompts

Global Options

  --cwd <DIR>                Sets the current working directory for a single run of a command
  -d, --debug                Debug mode (default off)
  -Q, --global-config <DIR>  Path to the global ${'`.vercel`'} directory
  -h, --help                 Output usage information
  -A, --local-config <FILE>  Path to the local `vercel.json` file
  --no-color                 No color mode (default off)
  -S, --scope                Set a custom scope
  -t, --token <TOKEN>        Login token
  -v, --version              Output the version number
```

As commands are migrated to this new structure, they'll gain this output automatically.",2023,7
4a8622a10d52260cb629a1c4a6f797ade05ea154,Zack Tanner,2023-07-27 16:18:31+00:00,GitHub,2023-07-27 16:18:31+00:00,"[next] fix dynamic not found pages (#10262)

This updates `getServerlessPages` to consider `/_not-found` pages (which might opt into dynamic rendering)

- Corresponding Next.js changes https://github.com/vercel/next.js/pull/53231
- [slack x-ref](https://vercel.slack.com/archives/C03S8ED1DKM/p1683763412272429)",2023,7
6469ef1b8ce37e93f50ab4a108aa0953d7631fe8,Vercel Release Bot,2023-07-26 22:22:21+00:00,GitHub,2023-07-26 22:22:21+00:00,"[remix] Update `@remix-run/dev` to v1.19.1 (#10246)

This auto-generated PR updates `@remix-run/dev` to version 1.19.1.",2023,7
b8d42a521bb28b335f68c3ed3542c502c916a96d,Nathan Rajlich,2023-07-26 21:48:07+00:00,GitHub,2023-07-26 21:48:07+00:00,"[examples] Remove ""author"" field from `hydrogen` template (#10253)",2023,7
b1e8c9cb6e7509a29872a0de7e29239842db24de,Vercel Release Bot,2023-07-26 18:50:22+00:00,GitHub,2023-07-26 18:50:22+00:00,"Version Packages (#10260)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@31.1.1

### Patch Changes

- Updated dependencies
\[[`7c30b13cc`](https://github.com/vercel/vercel/commit/7c30b13ccb79bdf0ac240282bba4c084f1d0d122)]:
    -   @vercel/next@3.9.2

## @vercel/next@3.9.2

### Patch Changes

- Fix pages/404 gsp + i18n case
([#10258](https://github.com/vercel/vercel/pull/10258))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,7
7c30b13ccb79bdf0ac240282bba4c084f1d0d122,JJ Kasper,2023-07-26 18:41:25+00:00,GitHub,2023-07-26 18:41:25+00:00,"[next] Fix pages/404 gsp + i18n case (#10258)

This ensures we detect the locale prefixed 404 when it uses `getStaticProps` correctly. 

- x-ref: [slack thread](https://vercel.slack.com/archives/C05JTC58AQJ)
- Closes https://github.com/vercel/vercel/pull/10248",2023,7
e5e757de34522cc4256296ffeed1b2e68664195a,Steven,2023-07-26 16:52:13+00:00,GitHub,2023-07-26 16:52:13+00:00,"[tests] fix `vary` header in next tests (#10249)

Since we run tests against canary, the latest [v13.4.13-canary.0](https://github.com/vercel/next.js/releases/tag/v13.4.13-canary.0) changed the `vary` header in https://github.com/vercel/next.js/pull/52746 so we need to update the tests to match.",2023,7
2661f56347d5c32de369a6cea74bc9fb46d565a2,Vercel Release Bot,2023-07-25 01:02:38+00:00,GitHub,2023-07-25 01:02:38+00:00,"Version Packages (#10227)

# Releases

## vercel@31.1.0

### Minor Changes

- Add 'Environment' column to 'vc list' with new '--environment' filter
and pipe URLs to stdout
([#10239](https://github.com/vercel/vercel/pull/10239))

### Patch Changes

- Update `proxy-agent` to v6.3.0
([#10226](https://github.com/vercel/vercel/pull/10226))

- Use `getNodeBinPaths()` in `vc dev`
([#10225](https://github.com/vercel/vercel/pull/10225))

- Updated dependencies
\[[`b1c14cde0`](https://github.com/vercel/vercel/commit/b1c14cde03f94b2c15ba12c9be9d19c72df2fdbb),
[`ce4633fe4`](https://github.com/vercel/vercel/commit/ce4633fe4d00cb5c251cdabbfab08f39ec3f3b5f)]:
    -   @vercel/next@3.9.1
    -   @vercel/static-build@1.3.42

## @vercel/frameworks@1.5.0

### Minor Changes

- Add `ignorePackageJsonScript` configuration for Framework command
settings to ignore the `package.json` script.
([#10228](https://github.com/vercel/vercel/pull/10228))

Enable this mode for Storybook's `buildCommand`, since it should not
invoke the ""build"" script, which is most likely designated for the
frontend app build.

## @vercel/fs-detectors@4.1.1

### Patch Changes

- Updated dependencies
\[[`ce4633fe4`](https://github.com/vercel/vercel/commit/ce4633fe4d00cb5c251cdabbfab08f39ec3f3b5f)]:
    -   @vercel/frameworks@1.5.0

## @vercel/next@3.9.1

### Patch Changes

- Fix pages and app router i18n handling
([#10243](https://github.com/vercel/vercel/pull/10243))

## @vercel/static-build@1.3.42

### Patch Changes

- Add `ignorePackageJsonScript` configuration for Framework command
settings to ignore the `package.json` script.
([#10228](https://github.com/vercel/vercel/pull/10228))

Enable this mode for Storybook's `buildCommand`, since it should not
invoke the ""build"" script, which is most likely designated for the
frontend app build.",2023,7
b1c14cde03f94b2c15ba12c9be9d19c72df2fdbb,JJ Kasper,2023-07-24 23:26:25+00:00,GitHub,2023-07-24 23:26:25+00:00,"[next] Fix pages and app router i18n handling (#10243)

Ensures app router paths are handled properly when i18n is configured for pages directory. 

x-ref: [slack thread](https://vercel.slack.com/archives/C03KAR5DCKC/p1687565759424049)
x-ref: [slack thread](https://vercel.slack.com/archives/C03KAR5DCKC/p1687565759424049)
x-ref: [slack thread](https://vercel.slack.com/archives/C03KAR5DCKC/p1672781549860349?thread_ts=1671393204.073649&cid=C03KAR5DCKC)

[VCCLI-780](https://linear.app/vercel/issue/VCCLI-780/add-404i18n-invariant-case-in-nextjs-builder)",2023,7
8dd6d021df0e52f574b97a0d9c79871998957522,Chris Barber,2023-07-24 20:02:25+00:00,GitHub,2023-07-24 20:02:25+00:00,"[cli] Add ""Environment"" column to `vc list` (#10239)

Also adds a new `--environment=[preview|production]` filter and ability to pipe deployment URLs to `stdout`!

<img width=""380"" alt=""image"" src=""https://github.com/vercel/vercel/assets/97262/20de0caa-2d63-4112-8213-cc15d23295c7"">

```
vc list --environment preview
```

```
vc list --environment production
```

```
vc list --environment preview > preview_deployments.txt
```",2023,7
88ec6e69d629fcbe7b716fb2c50fd2b272b8546c,Vercel Release Bot,2023-07-23 21:51:14+00:00,GitHub,2023-07-23 21:51:14+00:00,"[examples][tests] Upgrade Next.js to version 13.4.12 (#10240)

This auto-generated PR updates 3 packages to Next.js version 13.4.12",2023,7
a6f2e7b136209347e8587af6cd770b2a09634384,Vercel Release Bot,2023-07-23 21:30:01+00:00,GitHub,2023-07-23 21:30:01+00:00,"[tests] Upgrade Turbo to version 1.10.9 (#10241)

This auto-generated PR updates Turbo to version 1.10.9",2023,7
e90636590990f4009ac3eaea2d752e97d646ed04,Vercel Release Bot,2023-07-21 19:01:10+00:00,GitHub,2023-07-21 19:01:10+00:00,"[examples][tests] Upgrade Next.js to version 13.4.11 (#10233)

This auto-generated PR updates 3 packages to Next.js version 13.4.11",2023,7
7b01a073947d73f29584e32a9129d8797702e3b6,Nathan Rajlich,2023-07-19 22:19:43+00:00,GitHub,2023-07-19 22:19:43+00:00,"[cli] Use `getNodeBinPaths()` in `vc dev` (#10225)

This allows for the ""dev command"" of a Project to work better in monorepos, where the dev server might live up the node_modules hierarchy within the repo.",2023,7
ce4633fe4d00cb5c251cdabbfab08f39ec3f3b5f,Nathan Rajlich,2023-07-19 20:23:51+00:00,GitHub,2023-07-19 20:23:51+00:00,"[frameworks][static-build] Add `ignorePackageJsonScript` configuration for Framework command settings (#10228)

When this property is set to `true`, then the corresponding `package.json` script will not be invoked, allowing for the default setting value will be executed.

This is enabled for Storybook's `buildCommand`, since we do not want the ""build"" script to be invoked, since that would belong to the frontend application's build instead of Storybook's.",2023,7
fdf86fda038133e50892fe6a28852ff2cdf56931,Nathan Rajlich,2023-07-18 20:29:37+00:00,GitHub,2023-07-18 20:29:37+00:00,"[cli] Update `proxy-agent` to v6.3.0 (#10226)

This version includes a refactor for proxies specified via PAC files such that it no longer uses the deprecated `vm2` module.

See https://github.com/TooTallNate/proxy-agents/issues/218.",2023,7
56178e6a46d42c6be2b9b6a2273db984a9def8e3,Vercel Release Bot,2023-07-18 19:02:19+00:00,GitHub,2023-07-18 19:02:19+00:00,"Version Packages (#10213)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,7
5439d7c0c9b79e7161bf4fa84ffdb357365f9e7e,Nathan Rajlich,2023-07-18 18:27:19+00:00,GitHub,2023-07-18 18:27:19+00:00,"[remix] Create ensured dependency symlink at the `start` directory, instead of root of repo (#10224)

When the `ensureResolvable()` function runs in a monorepo, the symlink should be created in the `node_modules` directory within the app subdirectory, rather than the root of the repository. Fixes the following issue:

![image](https://github.com/vercel/vercel/assets/71256/c0171533-881a-425e-85b9-82318ef19032)",2023,7
c670e51712022193e078bd68b055f7e61013015d,Zack Tanner,2023-07-17 19:48:45+00:00,GitHub,2023-07-17 19:48:45+00:00,"[next] fix 404 page in edge runtime (#10223)

Fixes Next builder to handle edge runtime on 404 pages

[Related Next.js PR](https://github.com/vercel/next.js/pull/52754)
[slack x-ref](https://vercel.slack.com/archives/C03S8ED1DKM/p1689312606770609)",2023,7
b56639b624e9ad1df048a4c85083e26888696060,Kiko Beats,2023-07-17 16:45:05+00:00,GitHub,2023-07-17 16:45:05+00:00,"[node] fix: runs edge user code inside IIFE (#10220)

In this way, `self` is isolated and modify it doesn't break some Edge Runtime internals

Originally reported by @jawj at https://github.com/jawj/neon-vercel-zapatos-minimal-crash",2023,7
12bbae098ce084d48b26c2faddf017888885363e,Kiko Beats,2023-07-17 14:33:25+00:00,GitHub,2023-07-17 14:33:25+00:00,[codeowners] @vercel/edge-compute ‚Üí @vercel/compute (#10219),2023,7
9969f0ba18a8588e9aaf8cc8df2bc1d4af30d5ea,Nathan Rajlich,2023-07-14 18:11:49+00:00,GitHub,2023-07-14 18:11:49+00:00,"[cli] Use `detectFrameworks()` during `vc link --repo` (#10203)

Allows for multiple frameworks to be detectable within the same root directory. This is basically specifically for Storybook.

<img width=""700"" alt=""Screenshot 2023-07-12 at 6 04 37 PM"" src=""https://github.com/vercel/vercel/assets/71256/5a240f1e-b000-42ad-b36f-3c151d3cd449"">",2023,7
24e1e3c3be212c01847b422d6c11d421a7663ae0,Vercel Release Bot,2023-07-14 16:27:44+00:00,GitHub,2023-07-14 16:27:44+00:00,"[examples][tests] Upgrade Next.js to version 13.4.10 (#10215)

This auto-generated PR updates 3 packages to Next.js version 13.4.10",2023,7
b61674cb2d665b27980808bf930d5aa5b752854e,Steven,2023-07-14 16:07:26+00:00,GitHub,2023-07-14 16:07:26+00:00,"[tests] Fix next update cron job (#10214)

This was supposed to be fixed in https://github.com/vercel/vercel/pull/10173 but the file was created after git commit.

This PR makes sure the file is created before git commit.",2023,7
cae60155f34883f08a5e4f51b547e2a1a5fee694,Florentin / ÁèûËæ∞,2023-07-14 13:27:06+00:00,GitHub,2023-07-14 13:27:06+00:00,"[next] support maxDuration in Next.js deployments (#10069)

Follow up PR to
https://github.com/vercel/next.js/commit/8703c55f9f3d96df18ce192612141e094b3dc4fd
which reads the newly created function config manifest and patches in
the options for resource creation.

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,7
a91bde5287318c04520431a5cb1cbdd7a8377417,Vercel Release Bot,2023-07-13 23:17:13+00:00,GitHub,2023-07-13 23:17:13+00:00,"Version Packages (#10192)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## @vercel/fs-detectors@4.1.0

### Minor Changes

- Add `detectFrameworks()` function
([#10195](https://github.com/vercel/vercel/pull/10195))

## @vercel/build-utils@6.8.2

### Patch Changes

- Push back `nodejs16.x` discontinue date to `2024-02-06`
([#10209](https://github.com/vercel/vercel/pull/10209))

## vercel@31.0.3

### Patch Changes

- Fix redeploy target to be undefined when null
([#10201](https://github.com/vercel/vercel/pull/10201))

- Respect forbidden API responses
([#10178](https://github.com/vercel/vercel/pull/10178))

- Update `supports-hyperlinks` to v3
([#10208](https://github.com/vercel/vercel/pull/10208))

- Updated dependencies
\[[`0750517af`](https://github.com/vercel/vercel/commit/0750517af99aea41410d4f1f772ce427699554e7)]:
    -   @vercel/build-utils@6.8.2
    -   @vercel/static-build@1.3.40
    -   @vercel/node@2.15.5
    -   @vercel/remix-builder@1.8.17

## @vercel/client@12.6.5

### Patch Changes

- Updated dependencies
\[[`0750517af`](https://github.com/vercel/vercel/commit/0750517af99aea41410d4f1f772ce427699554e7)]:
    -   @vercel/build-utils@6.8.2

## @vercel/gatsby-plugin-vercel-builder@1.3.13

### Patch Changes

- Updated dependencies
\[[`0750517af`](https://github.com/vercel/vercel/commit/0750517af99aea41410d4f1f772ce427699554e7)]:
    -   @vercel/build-utils@6.8.2
    -   @vercel/node@2.15.5

## @vercel/node@2.15.5

### Patch Changes

- Updated dependencies
\[[`0750517af`](https://github.com/vercel/vercel/commit/0750517af99aea41410d4f1f772ce427699554e7)]:
    -   @vercel/build-utils@6.8.2

## @vercel/remix-builder@1.8.17

### Patch Changes

- Updated dependencies
\[[`0750517af`](https://github.com/vercel/vercel/commit/0750517af99aea41410d4f1f772ce427699554e7)]:
    -   @vercel/build-utils@6.8.2

## @vercel/static-build@1.3.40

### Patch Changes

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@1.3.13

## @vercel-internals/types@1.0.5

### Patch Changes

- Updated dependencies
\[[`0750517af`](https://github.com/vercel/vercel/commit/0750517af99aea41410d4f1f772ce427699554e7)]:
    -   @vercel/build-utils@6.8.2

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,7
0750517af99aea41410d4f1f772ce427699554e7,Steven,2023-07-13 22:47:03+00:00,GitHub,2023-07-13 22:47:03+00:00,"[build-utils] Push back `nodejs16.x` discontinue date to 2024-02-06 (#10209)

The discontinue date for `nodejs16.x` needs to be pushed back until we can add support for `nodejs20.x`.

Currently `nodejs18.x` can cause problems with native packages that depend on a specific version of glibc so the only solution for that use case is to stay on `nodejs16.x` at this time.


### Related Issues
- https://github.com/orgs/vercel/discussions/3061
- https://github.com/orgs/vercel/discussions/2867
- https://github.com/orgs/vercel/discussions/2258
- https://github.com/orgs/vercel/discussions/2630
- https://github.com/orgs/vercel/discussions/2105
- https://github.com/orgs/vercel/discussions/2596
- https://github.com/orgs/vercel/discussions/2730",2023,7
70f678295439b686066933fc2bfd4c59cd91e03c,Steven,2023-07-13 21:29:51+00:00,GitHub,2023-07-13 21:29:51+00:00,"[tests] Add lockfile to `51-puppeteer-build` test (#10210)

This test was failing so I'm adding a lockfile to prevent this build error:

```
Running ""yarn run build""
--
16:40:10.239 | yarn run v1.22.17
16:40:10.260 | $ node build.js
16:40:40.630 | node:internal/process/promises:288
16:40:40.630 | triggerUncaughtException(err, true /* fromPromise */);
16:40:40.630 | ^
16:40:40.630 | ¬†
16:40:40.630 | TimeoutError: Navigation timeout of 30000 ms exceeded
16:40:40.631 | at /vercel/path1/node_modules/puppeteer/lib/LifecycleWatcher.js:142:21
16:40:40.631 | -- ASYNC --
16:40:40.631 | at Frame.<anonymous> (/vercel/path1/node_modules/puppeteer/lib/helper.js:111:15)
16:40:40.631 | at Page.goto (/vercel/path1/node_modules/puppeteer/lib/Page.js:672:49)
16:40:40.631 | at Page.<anonymous> (/vercel/path1/node_modules/puppeteer/lib/helper.js:112:23)
16:40:40.631 | at /vercel/path1/build.js:10:14
16:40:40.631 | at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
```",2023,7
5f1e37ee165ee6c855852c36b8055f773c5dcd04,Nathan Rajlich,2023-07-13 19:24:30+00:00,GitHub,2023-07-13 19:24:30+00:00,"Update `supports-hyperlinks` to v3 (#10208)

Enables proper detection for VSCode's terminal emulator, and allows us
to remove the in-house types since v3 includes its own types.",2023,7
680d666fdca90866692838d6f13241b458fe5bef,Steven,2023-07-13 13:48:27+00:00,GitHub,2023-07-13 13:48:27+00:00,"[tests] Add huozhi to cron job for Next.js (#10205)

This adds Jiachi to the default reviewer list for the Next.js update cron job.",2023,7
06a5dccfed333d24968646edf4bf2ebe41a30d1b,Chris Barber,2023-07-12 21:26:33+00:00,GitHub,2023-07-12 21:26:33+00:00,[cli] Fix redeploy target to be `undefined` when `null` (#10201),2023,7
f85df894c0d1af97fd8a23426af372652a67fb3f,Nathan Rajlich,2023-07-11 20:08:55+00:00,GitHub,2023-07-11 20:08:55+00:00,"[fs-detectors] Add `detectFrameworks()` (#10195)

Similar to `detectFramework()`, but this version returns all detected frameworks at the given path. It also returns the full `Framework` objects instead of just the slug.

This will be useful for detecting when multiple Projects exist at the same root directory (i.e. Storybook).

**Note:** I rearranged some tests, so probably review with [whitespace changes hidden](https://github.com/vercel/vercel/pull/10195/files?diff=split&w=1).",2023,7
e9ec779f1cb2a58008a26ae1e3b017d16f4fd0e7,balazs4,2023-07-11 10:32:43+00:00,GitHub,2023-07-11 10:32:43+00:00,"[rbac]s show forbidden error in case of missing permission (#10178)

fixes
[iam-941](https://linear.app/vercel/issue/IAM-941/cli-improve-handling-of-insufficient-permissions-no-access)",2023,7
4333d1e6b223055b8548f5df025df45fcfb20f5b,Vercel Release Bot,2023-07-11 07:51:06+00:00,GitHub,2023-07-11 07:51:06+00:00,"[examples][tests] Upgrade Next.js to version 13.4.9 (#10183)

This auto-generated PR updates 3 packages to Next.js version 13.4.9",2023,7
493a31091ddcd48e81f8c1db03d6ef41612c42d9,Vercel Release Bot,2023-07-10 22:48:32+00:00,GitHub,2023-07-10 22:48:32+00:00,"Version Packages (#10158)

## @vercel/build-utils@6.8.1

### Patch Changes

- Revert ""[build-utils] Allow file-ref sema to be controlled through env
flag"" ([#10167](https://github.com/vercel/vercel/pull/10167))

## vercel@31.0.2

### Patch Changes

- Allow additional project settings in `createProject()`
([#10172](https://github.com/vercel/vercel/pull/10172))

- Run local Project detection during `vc link --repo`.
([#10094](https://github.com/vercel/vercel/pull/10094))
This allows for creation of new Projects that do not yet exist under the
selected scope.

- Redeploy command no longer redeploys preview deployments to production
([#10186](https://github.com/vercel/vercel/pull/10186))

- Added trailing new line at end of help output
([#10170](https://github.com/vercel/vercel/pull/10170))

- Create new help output and arg parsing for deploy command
([#10090](https://github.com/vercel/vercel/pull/10090))

- [cli] Remove `preinstall` script
([#10157](https://github.com/vercel/vercel/pull/10157))

- Updated dependencies
\[[`7021279b2`](https://github.com/vercel/vercel/commit/7021279b284f314a4d1bdbb4306b4c22291efa08),
[`5e5332fbc`](https://github.com/vercel/vercel/commit/5e5332fbc9317a8f3cc4ed0b72ec1a2c76020891),
[`027bce00b`](https://github.com/vercel/vercel/commit/027bce00b3821d9b4a8f7ec320cd1c43ab9f4215)]:
    -   @vercel/build-utils@6.8.1
    -   @vercel/node@2.15.4
    -   @vercel/remix-builder@1.8.16
    -   @vercel/static-build@1.3.39

## @vercel/client@12.6.4

### Patch Changes

- Updated dependencies
\[[`7021279b2`](https://github.com/vercel/vercel/commit/7021279b284f314a4d1bdbb4306b4c22291efa08)]:
    -   @vercel/build-utils@6.8.1

## @vercel/gatsby-plugin-vercel-builder@1.3.12

### Patch Changes

- Updated dependencies
\[[`7021279b2`](https://github.com/vercel/vercel/commit/7021279b284f314a4d1bdbb4306b4c22291efa08),
[`5e5332fbc`](https://github.com/vercel/vercel/commit/5e5332fbc9317a8f3cc4ed0b72ec1a2c76020891)]:
    -   @vercel/build-utils@6.8.1
    -   @vercel/node@2.15.4

## @vercel/node@2.15.4

### Patch Changes

- [node] fix decompress mismatching
([#10184](https://github.com/vercel/vercel/pull/10184))

- Updated dependencies
\[[`7021279b2`](https://github.com/vercel/vercel/commit/7021279b284f314a4d1bdbb4306b4c22291efa08)]:
    -   @vercel/build-utils@6.8.1

## @vercel/remix-builder@1.8.16

### Patch Changes

- Update `@remix-run/dev` fork to v1.18.1
([#10180](https://github.com/vercel/vercel/pull/10180))

- Updated dependencies
\[[`7021279b2`](https://github.com/vercel/vercel/commit/7021279b284f314a4d1bdbb4306b4c22291efa08)]:
    -   @vercel/build-utils@6.8.1

## @vercel/static-build@1.3.39

### Patch Changes

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@1.3.12

## @vercel-internals/constants@1.0.4

### Patch Changes

- Create new help output and arg parsing for deploy command
([#10090](https://github.com/vercel/vercel/pull/10090))

## @vercel-internals/types@1.0.4

### Patch Changes

- Updated dependencies
\[[`7021279b2`](https://github.com/vercel/vercel/commit/7021279b284f314a4d1bdbb4306b4c22291efa08),
[`718bbd365`](https://github.com/vercel/vercel/commit/718bbd365a50271a980bdca231ca801a0eead32b)]:
    -   @vercel/build-utils@6.8.1
    -   @vercel-internals/constants@1.0.4

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,7
8d7206f5b625cdbfb676c07bd0e58798cf1421e8,Nathan Rajlich,2023-07-10 22:42:13+00:00,GitHub,2023-07-10 22:42:13+00:00,"[cli] Run local Project detection during `vc link --repo` (#10094)

Run local Project detection during `vc link --repo`. This allows for creation of new Projects that do not yet exist under the selected scope.",2023,7
4bf2ca55ff64b5994ee386b99d0e491f1a70c00a,Sean Massa,2023-07-10 02:17:06+00:00,GitHub,2023-07-10 02:17:06+00:00,"Revert ""Add Changesets ""ignore"" configuration"" (#10189)

Reverts vercel/vercel#10181

This seems to be breaking releases of packages that depend on ignored packages. Example: https://github.com/vercel/vercel/actions/runs/5489491313/jobs/10003713249",2023,7
5e5332fbc9317a8f3cc4ed0b72ec1a2c76020891,Kiko Beats,2023-07-07 18:33:05+00:00,GitHub,2023-07-07 18:33:05+00:00,"[node] fix decompress mismatching (#10184)

This PR disabled `node-fetch` default compression handling when the
response is not streamed.

The default behavior in node-fetch is to handle the compression. That's
great if you interact with node-fetch as user, but bad if you use it as
intermediate proxy server, since it's creating a mismatching related
with the body format and length expectations.

Instead, we disable compression, get the buffered response and compress
it again if needed.

---------

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,7
281ec776a5fc9a8f6ef619cb4089705eff8ea8e4,Ethan Arrowood,2023-07-07 17:50:06+00:00,GitHub,2023-07-07 17:50:06+00:00,"Fix redeploy target (#10186)

This PR fixes customer issue
https://github.com/vercel/customer-issues/issues/1310 which identified
an issue with the `redeploy` command.

`redeploy` should not default the `target` to `'production'` as an
`undefined` target is meant to mean `'preview'`.",2023,7
ee8f9292b46d74c2c87e988fa12ef287d340a710,Nathan Rajlich,2023-07-05 22:07:15+00:00,GitHub,2023-07-05 22:07:15+00:00,"Add Changesets ""ignore"" configuration (#10181)

These packages already don't get published since they have `private: true`, but adding to the ""ignore"" configuration also removes them from the selection prompt when executing the `changeset` CLI command.",2023,7
027bce00b3821d9b4a8f7ec320cd1c43ab9f4215,Vercel Release Bot,2023-07-05 21:23:48+00:00,GitHub,2023-07-05 21:23:48+00:00,"[remix] Update `@remix-run/dev` to v1.18.1 (#10180)

This auto-generated PR updates `@remix-run/dev` to version 1.18.1.",2023,7
ca1f41200ab3c6ae7999e57fc09d31d04427b47d,Vercel Release Bot,2023-07-05 20:46:59+00:00,GitHub,2023-07-05 20:46:59+00:00,"[tests] Upgrade Turbo to version 1.10.7 (#10164)

This auto-generated PR updates Turbo to version 1.10.7",2023,7
834b3e652b0d47d9964330672c03b28225014e45,Nathan Rajlich,2023-07-03 21:42:00+00:00,GitHub,2023-07-03 21:42:00+00:00,"[cli] Allow additional project settings in `createProject()` (#10172)

Previously, `createProject()` only allowed a string `name` to be provided, and another API call would need to be done after creation with `updateProject()`. This should not be necessary since the `POST` endpoint can accept additional properties already.",2023,7
5c6941d18c494231b42b1a22b3c665d5b815e3be,Steven,2023-07-03 21:03:42+00:00,GitHub,2023-07-03 21:03:42+00:00,"[tests] Fix `update-next.js` cron job to include changeset (#10173)

The cron job script only updates the Next.js example so it should have an empty changeset",2023,7
761ede24820da60a61604c2629c7e9e887b20faf,Vercel Release Bot,2023-07-03 20:22:59+00:00,GitHub,2023-07-03 20:22:59+00:00,"[examples][tests] Upgrade Next.js to version 13.4.8 (#10171)

This auto-generated PR updates 3 packages to Next.js version 13.4.8",2023,7
1d01703dc3f7c696985d003c86dd691fda243ff9,Chris Barber,2023-07-03 16:46:29+00:00,GitHub,2023-07-03 16:46:29+00:00,"[cli] Added line return at end of help output (#10170)

I noticed the help output doesn't render a line return at the end.

<img width=""290"" alt=""image"" src=""https://github.com/vercel/vercel/assets/97262/8aea6be0-9620-4445-b05d-62b838cefb07"">",2023,7
7021279b284f314a4d1bdbb4306b4c22291efa08,Andrew Healey,2023-07-03 15:42:16+00:00,GitHub,2023-07-03 15:42:16+00:00,"Revert ""[build-utils] Allow file-ref sema to be controlled through env flag"" (#10167)

Reverts vercel/vercel#8681

We ran an experiment here a while ago but it had flaky results.

This PR cleans up the experiment code, and reverts to the previous behavior.",2023,7
28acf50bdf44d10228c643783ad0e4639af27017,Ethan Arrowood,2023-06-30 15:50:22+00:00,GitHub,2023-06-30 15:50:22+00:00,"Removes a leftover `console.log` in the new `help` method (#10162)

Removes a leftover `console.log` in the new `help` method. Whoops!",2023,6
718bbd365a50271a980bdca231ca801a0eead32b,Ethan Arrowood,2023-06-29 20:08:17+00:00,GitHub,2023-06-29 20:08:17+00:00,"Improve `help` output UX and DX (#10090)

This PR adds a new utility for generating `help` output for CLI
commands. Backed by a JSON data structure that represents the commands,
this utility uses deterministic functions for generating the different
output sections (such as `options` and `examples`). This change will let
contributor easily add/modify command details. The data structure is
also used by the CLI to generate the args parsing structure for the
`deploy` command. Optimistically, this same data structure can be used
to generate documentation output for `front` such that the online docs
will match the `help` output.

---------

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,6
7e791ee080b517f500154d61ac7065b855a1521f,Steven,2023-06-28 22:30:49+00:00,GitHub,2023-06-28 22:30:49+00:00,"[cli] Remove `preinstall` script (#10157)

This will solve two of the warnings from [Socket.dev](https://socket.dev/npm/package/vercel):

<img width=""1126"" alt=""image"" src=""https://github.com/vercel/vercel/assets/229881/c890c973-4f5a-44d9-9b96-2580a1e40ed0"">

This preinstall script isn't necessary to run Vercel CLI, its only used to improve the error message in two cases:

- The system has `node` version prior to 14.x (3 years ago)
- The system still has `now` installed but should be using `vercel` (last shipped 3 years ago)

The usage of `preinstall` scripts have gone out of style due to security audits so we should remove this script now.",2023,6
13769106cb1b2d2c72c3c6bbd750428b9dfc4249,Vercel Release Bot,2023-06-28 21:49:14+00:00,GitHub,2023-06-28 21:49:14+00:00,"Version Packages (#10156)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@31.0.1

### Patch Changes

- Updated dependencies
\[[`aa734efc6`](https://github.com/vercel/vercel/commit/aa734efc6c42badd4aa9bf64487904aa64e9bd49)]:
    -   @vercel/next@3.8.8

## @vercel/next@3.8.8

### Patch Changes

- [next] Ensure RSC paths handle basePath
([#10155](https://github.com/vercel/vercel/pull/10155))",2023,6
aa734efc6c42badd4aa9bf64487904aa64e9bd49,JJ Kasper,2023-06-28 21:00:43+00:00,GitHub,2023-06-28 21:00:43+00:00,"[next] Ensure RSC paths handle basePath (#10155)

This ensures we properly create the `.rsc` variant of outputs when `basePath` is configured and adds a regression test for this. 

x-ref: [slack thread](https://vercel.slack.com/archives/C03S8ED1DKM/p1687944744404289)
Fixes: https://github.com/vercel/next.js/issues/48305",2023,6
acc10e47c7404d15e519ef793975492a5854088b,Vercel Release Bot,2023-06-28 19:29:31+00:00,GitHub,2023-06-28 19:29:31+00:00,"Version Packages (#10123)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@31.0.0

### Major Changes

- Update `vc dev` redirect response to match production behavior
([#10143](https://github.com/vercel/vercel/pull/10143))

### Patch Changes

- require `--yes` to promote preview deployment
([#10135](https://github.com/vercel/vercel/pull/10135))

- [cli] Optimize write build result for vc build
([#10154](https://github.com/vercel/vercel/pull/10154))

- Only show relevant Project matches in Project selector
([#10114](https://github.com/vercel/vercel/pull/10114))

- [cli] Fix error message when token is invalid
([#10131](https://github.com/vercel/vercel/pull/10131))

- Updated dependencies
\[[`e4895d979`](https://github.com/vercel/vercel/commit/e4895d979b57e369e0618481c5974243887d72cc),
[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c),
[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c),
[`a6de052ed`](https://github.com/vercel/vercel/commit/a6de052ed2f09cc80bf4c2d0f06bedd267a63cdc)]:
    -   @vercel/next@3.8.7
    -   @vercel/static-build@1.3.38
    -   @vercel/build-utils@6.8.0
    -   @vercel/remix-builder@1.8.15
    -   @vercel/node@2.15.3

## @vercel/build-utils@6.8.0

### Minor Changes

- Add `getNodeBinPaths()` and `traverseUpDirectories()` functions
([#10150](https://github.com/vercel/vercel/pull/10150))

## @vercel/client@12.6.3

### Patch Changes

- Updated dependencies
\[[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c)]:
    -   @vercel/build-utils@6.8.0

## @vercel/frameworks@1.4.3

### Patch Changes

- [frameworks] Update `saber.land` to `saber.egoist.dev`
([#10148](https://github.com/vercel/vercel/pull/10148))

## @vercel/fs-detectors@4.0.1

### Patch Changes

- Resolve symlinks in `LocalFileSystemDetector#readdir()`
([#10126](https://github.com/vercel/vercel/pull/10126))

- Updated dependencies
\[[`0867f11a6`](https://github.com/vercel/vercel/commit/0867f11a6a1086ef4f4701db2b98da8fcc299586)]:
    -   @vercel/frameworks@1.4.3

## @vercel/gatsby-plugin-vercel-builder@1.3.11

### Patch Changes

- Updated dependencies
\[[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c)]:
    -   @vercel/build-utils@6.8.0
    -   @vercel/node@2.15.3

## @vercel/next@3.8.7

### Patch Changes

- [next] Update payload flag
([#10147](https://github.com/vercel/vercel/pull/10147))

- Use `getNodeBinPaths()` function to improve monorepo support
([#10150](https://github.com/vercel/vercel/pull/10150))

## @vercel/node@2.15.3

### Patch Changes

- Updated dependencies
\[[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c)]:
    -   @vercel/build-utils@6.8.0

## @vercel/remix-builder@1.8.15

### Patch Changes

- Update `@remix-run/dev` fork to v1.18.0
([#10146](https://github.com/vercel/vercel/pull/10146))

- Updated dependencies
\[[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c)]:
    -   @vercel/build-utils@6.8.0

## @vercel/static-build@1.3.38

### Patch Changes

- Use `getNodeBinPaths()` function to improve monorepo support
([#10150](https://github.com/vercel/vercel/pull/10150))

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@1.3.11

## @vercel-internals/constants@1.0.3

### Patch Changes

- Updated dependencies
\[[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c)]:
    -   @vercel/build-utils@6.8.0

## @vercel-internals/types@1.0.3

### Patch Changes

- Updated dependencies
\[[`346892210`](https://github.com/vercel/vercel/commit/3468922108f411482a72acd0331f0f2ee52a6d4c)]:
    -   @vercel/build-utils@6.8.0
    -   @vercel-internals/constants@1.0.3",2023,6
6a0e1e0b66715dd399d4f31463c9f01b47592781,JJ Kasper,2023-06-28 19:07:52+00:00,GitHub,2023-06-28 19:07:52+00:00,"[cli] Optimize write build result for vc build (#10154)

As noticed this is copying all fallback files from output even if they are already on the disk in the build container which should be able to be considered a ""pure"" environment. This copying can cause disk space/perf issues when there are massive amounts of fallback files generated e.g. 8000 outputs at 200KB/output is already 1.6GB of copying needing to be done that could just be a move operation. 


x-ref: [slack thread](https://vercel.slack.com/archives/C03F2CMNGKG/p1687969734598509?thread_ts=1687963253.178369&cid=C03F2CMNGKG)
x-ref: [slack thread](https://vercel.slack.com/archives/C02SM2K2UM9/p1687970267370669)
x-ref: [slack thread](https://vercel.slack.com/archives/C03DQ3QFV7C/p1687338157228459)",2023,6
3468922108f411482a72acd0331f0f2ee52a6d4c,Nathan Rajlich,2023-06-28 01:53:34+00:00,GitHub,2023-06-28 01:53:34+00:00,"[build-utils] Add `getNodeBinPaths()` function (#10150)

The `getNodeBinPath()` function is problematic because it assumes that commands are installed in the `node_modules` directory alongside the detected lockfile. This works fine the majority of the time, but ends up not being the case when using a monorepo that uses a package manager in ""linked"" mode (i.e. pnpm by default).

Consider the following:

```
.
‚îú‚îÄ‚îÄ pnpm-lock.yaml
‚îú‚îÄ‚îÄ node_modules
‚îú‚îÄ‚îÄ blog
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ node_modules
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ hexo -> .pnpm/hexo@3.9.0/node_modules/hexo
```

In this setup, adding the root-level `node_modules/.bin` would not make the `hexo` command be visible in the `$PATH`.

To solve this issue, the new `getNodeBinPaths()` function returns an array of all directories up to the specified `root`, which can then be placed into the `$PATH`. It's also more efficient (synchronous) since it does not need to scan for a lockfile anymore (the `root` needs to be specified explicitly).

The new function is being used in `@vercel/next` and `@vercel/static-build`.

The `traverseUpDirectories()` function from CLI was moved to `build-utils` to implement this function. Consequently, that makes the implementations of `walkParentDirs()` and `walkParentDirsMulti()` simpler, since it's using this generator now.",2023,6
e4895d979b57e369e0618481c5974243887d72cc,JJ Kasper,2023-06-27 23:34:21+00:00,GitHub,2023-06-27 23:34:21+00:00,"[next] Update payload flag (#10147)

x-ref: [slack thread](https://vercel.slack.com/archives/C05E6RJTPJS/p1687898295532579)",2023,6
733ff5ed85fe10aca1fabc90c9410399748fbf5c,Steven,2023-06-27 23:05:55+00:00,GitHub,2023-06-27 23:05:55+00:00,"[tests] Add `x-vercel-id` to test error message (#10149)

Including the `x-vercel-id` header when a e2e test fails will help us
debug issues",2023,6
0867f11a6a1086ef4f4701db2b98da8fcc299586,Steven,2023-06-27 22:23:27+00:00,GitHub,2023-06-27 22:23:27+00:00,"[frameworks] Update `saber.land` to `saber.egoist.dev` (#10148)

The website url for Saber changed

x-ref:
[slack](https://vercel.slack.com/archives/C01RUTYJYHW/p1687900208904799)",2023,6
a6de052ed2f09cc80bf4c2d0f06bedd267a63cdc,Vercel Release Bot,2023-06-27 17:32:46+00:00,GitHub,2023-06-27 17:32:46+00:00,"[remix] Update `@remix-run/dev` to v1.18.0 (#10146)

This auto-generated PR updates `@remix-run/dev` to version 1.18.0.",2023,6
f5d48ec3bc0c87112229b3b39c04d7e19fd0b486,Micha√´l De Boey,2023-06-26 23:52:24+00:00,GitHub,2023-06-26 23:52:24+00:00,"[examples] Update `remix` template (#9846)

Bring in line with latest template",2023,6
6ec11807985c221400dc0dab8ef2f19321b78747,Sean Massa,2023-06-26 21:43:48+00:00,GitHub,2023-06-26 21:43:48+00:00,"require `--yes` flag to promote preview deployment (#10135)

In order to promote a preview deployment, we want to make sure the user knows that this is not typical. Now the `--yes` flag is required to make this work.",2023,6
36db62a491aa3155ebb286f0e533bd8edfc93670,Nathan Rajlich,2023-06-26 20:12:21+00:00,GitHub,2023-06-26 20:12:21+00:00,"Delete `.changeset/beige-carrots-begin.md` (#10144)

We don't want changesets to try and create a release / changelog for the
`examples` dir.",2023,6
f9266e069fdea470863365239ead739c143a9846,Vercel Release Bot,2023-06-26 20:10:26+00:00,GitHub,2023-06-26 20:10:26+00:00,"[tests] Upgrade Turbo to version 1.10.6 (#10140)

This auto-generated PR updates Turbo to version 1.10.6",2023,6
8163a153dfdbe169a83f2fe933d8274d73d952ae,Nathan Rajlich,2023-06-26 19:41:35+00:00,GitHub,2023-06-26 19:41:35+00:00,"[cli] Respond with ""Redirecting..."" to match production behavior (#10143)

Production was recently changed to make redirect responses return the text ""Redirecting..."" without the destination nor status code in the text.

This caused some tests to start failing, so update `vc dev` to match this new behavior and update the relevant tests.",2023,6
c5e6bd1a7a2bfd8deb2849181548bd4f1fa761ef,Steven,2023-06-23 16:14:23+00:00,GitHub,2023-06-23 16:14:23+00:00,"Delete lerna.json (#10133)

We no longer use lerna since switching to changesets so we can delete `lerna.json`

- See https://github.com/vercel/vercel/pull/9914",2023,6
c2f1bebd1f16b588cc65b6faba476b88781cfbd4,Steven,2023-06-23 15:18:58+00:00,GitHub,2023-06-23 15:18:58+00:00,"[cli] Fix error message when token is invalid (#10131)

This changes the error when a token is invalid or expired from

```
Error: Could not retrieve Project Settings. To link your Project, remove the `.vercel` directory and deploy again.
Learn More: https://vercel.link/cannot-load-project-settings
```

to a better error

```
Error: The specified token is not valid. Use `vercel login` to generate a new token.
```

- This could be considered a follow up to
https://github.com/vercel/vercel/pull/7794",2023,6
31384155338c130145a5368574d41a4257540e48,Nathan Rajlich,2023-06-22 18:19:28+00:00,GitHub,2023-06-22 18:19:28+00:00,"[fs-detectors] Resolve symlinks in `LocalFileSystemDetector#readdir()` (#10126)

`LocalFileSystemDetector#readdir()` was throwing an error when a symlink was encountered, due to `fs.readdir()` `withFileTypes: true` option performing an lstat instead of a stat operation.

So re-implement the `readdir()` logic to use `fs.stat()` so that the symlink is resolved (only ""dir"" and ""file"" types are expected in the result).",2023,6
8f6813bb63dd6904e419e7c171570f4c232b9026,Vercel Release Bot,2023-06-22 00:36:23+00:00,GitHub,2023-06-22 00:36:23+00:00,"[examples][tests] Upgrade Next.js to version 13.4.7 (#10125)

This auto-generated PR updates 3 packages to Next.js version 13.4.7",2023,6
734499fc03dc266c5a3bd7e186d9e8b1e624d30f,Nathan Rajlich,2023-06-21 17:22:21+00:00,GitHub,2023-06-21 17:22:21+00:00,"[cli] Only show relevant Project matches in Project selector (#10114)

When showing the Project selector and there's more than one Project matched given the current cwd, only show the matched Projects instead of all Projects listed in the `repo.json` file.",2023,6
f06988d914f196bce38cf7c083927302e81a6dde,Nathan Rajlich,2023-06-20 18:09:40+00:00,GitHub,2023-06-20 18:09:40+00:00,"[cli] Add debug logging for repo link root lookup (#10112)

Adds some logging during the root directory resolving logic to help debug any cases where that lookup isn't behaving correctly.",2023,6
71ac16220bdaa7ad36b7d0c5e53d2417b37f1554,Vercel Release Bot,2023-06-20 16:42:04+00:00,GitHub,2023-06-20 16:42:04+00:00,"Version Packages (#10107)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,6
8b3a4146af68d2b7288c80a5b919d832dba929b5,Kiko Beats,2023-06-20 09:06:43+00:00,GitHub,2023-06-20 09:06:43+00:00,"[node][edge][cli] upgrade Edge Runtime (#10051)

We avoided to use `undici.WebSocket` because @jawj found a bug in the
implementation.

The [fix was merged](https://github.com/nodejs/undici/pull/2106) in
[undici@5.22.1](https://github.com/nodejs/undici/releases/tag/v5.22.1),
so we can be back to use it.

The latest version of Edge Runtime exposes `undici.WebSocket` compatible
with node.js 14, 16 & 18

---------

Co-authored-by: Sean Massa <endangeredmassa@gmail.com>",2023,6
cfea31e6cff33c0a2dd3663025093fd9b8e7f1d8,Nathan Rajlich,2023-06-16 22:45:52+00:00,GitHub,2023-06-16 22:45:52+00:00,Remove `.changeset/curvy-stingrays-cheat.md` (#10115),2023,6
7090fec110d782c1b2552424de04810f0bd98306,Vercel Release Bot,2023-06-16 22:21:41+00:00,GitHub,2023-06-16 22:21:41+00:00,"[examples][tests] Upgrade Next.js to version 13.4.6 (#10111)

This auto-generated PR updates 3 packages to Next.js version 13.4.6",2023,6
bc7c80fb9b4188425e5456894ae3b5ad2c21371c,Sean Massa,2023-06-15 22:19:34+00:00,GitHub,2023-06-15 22:19:34+00:00,"[cli] do not force auto-assign value on deployments (#10110)

When `vc deploy` happens, it was forcing a `true`/`false` value for `autoAssignCustomDomains`. This overwrites the project setting in some cases, which is not what we want.

If a CLI command or API call explicitly wants to force `autoAssignCustomDomains` on or off, it can. Otherwise, the project setting value should be used.

This PR only sets `autoAssignCustomDomains` to `false` when the `--skip-domain` flag is passed. Otherwise, the value is `undefined` so that the project setting can take effect.",2023,6
91406abdb0c332152fc6c7c1e4bd3a872b084434,Sean Massa,2023-06-15 17:31:47+00:00,GitHub,2023-06-15 17:31:47+00:00,[node] add tests to getBodyParser helper (#10109),2023,6
a5af8381ce962028fd92b16bdaccffcad6f1c559,Nathan Rajlich,2023-06-14 19:20:20+00:00,GitHub,2023-06-14 19:20:20+00:00,"[fs-detectors] Add `test-e2e` script (#10103)

Seems we have not been running the `fs-detectors` integration tests.",2023,6
2230ea6cc1b84c1f03227a4e197b7684635b5955,Nathan Rajlich,2023-06-14 18:53:14+00:00,GitHub,2023-06-14 18:53:14+00:00,[remix] Link to `https://vercel.com/help` (#10106),2023,6
f057f0421b35b0ca09a96314b6cd57b58daa9dff,Vercel Release Bot,2023-06-14 17:47:10+00:00,GitHub,2023-06-14 17:47:10+00:00,Version Packages (#10081),2023,6
42c0b32a8d4ad1b1c88a318cbb247cd31c6e9521,Nathan Rajlich,2023-06-13 23:30:00+00:00,GitHub,2023-06-13 23:30:00+00:00,"[fs-detectors] Use `LocalFileSystemDetector` instead of `FixtureFilesystem` (#10100)

The code for these two are almost identical, so consolidate into one codebase.

Also adjusts the `pnpm test` script to allow for specifying a file name to be executed, instead of running all tests.",2023,6
d61a1a79886f090c7f6fa06672115d6947d04cfc,Chris Barber,2023-06-12 16:32:01+00:00,GitHub,2023-06-12 16:32:01+00:00,"[cli] Fix team validation bug where you are apart of a team (#10092)

When consolidating the deployment team validation, a bug was introduced where the command would error if the user was currently using a team. The logic was meant to copy the logic in `getDeploymentByIdOrURL()`: https://github.com/vercel/vercel/blob/main/packages/cli/src/util/deploy/get-deployment-by-id-or-url.ts#L80.",2023,6
c438bbb3628d72d1423b7869e6e08652392e8b4a,Vercel Release Bot,2023-06-12 15:02:47+00:00,GitHub,2023-06-12 15:02:47+00:00,"[examples][tests] Upgrade Next.js to version 13.4.5 (#10097)

This auto-generated PR updates 3 packages to Next.js version 13.4.5",2023,6
cb5eef0eb5e247b95969a5a66c957b9010bbe9bd,Vercel Release Bot,2023-06-11 07:44:11+00:00,GitHub,2023-06-11 07:44:11+00:00,"[tests] Upgrade Turbo to version 1.10.3 (#10096)

This auto-generated PR updates Turbo to version 1.10.3",2023,6
79dee367cfb7dfe9748ce1c3322f638ae836eb7e,Nathan Rajlich,2023-06-09 22:59:17+00:00,GitHub,2023-06-09 22:59:17+00:00,"[cli] Remove `findProjectFromPath()` (#10093)

Superceded by the `findProjectsFromPath()` function which may return multiple matches, and it was only being used in tests.

The relevant tests have been updated to use the multiple matches version instead, and updated to include the case where multiple matches are returned.

__Note:__ No changeset for this one since it's an internal function being removed, and doesn't need to be referenced in the public changelog.",2023,6
dea58dea7e653e3140ef7159ff25e8abf26d0c79,Nathan Rajlich,2023-06-09 09:54:17+00:00,GitHub,2023-06-09 09:54:17+00:00,"[cli] Add support for `vc deploy --prebuilt` command with repo link (#10083)

When repo linked, `vc deploy --prebuilt` will change working directory to the Project root directory, instead of the repo root, so that the project's local `.vercel/output` directory is what gets uploaded + deployed.",2023,6
fecebfa7fa696c4b451aec8ffd1b4c01026a94eb,Steven,2023-06-08 00:09:22+00:00,GitHub,2023-06-08 00:09:22+00:00,"[cli] vc env pull should add `.env*.local` to `.gitignore` (#10085)

This is a follow up to PR #9892 which changed the default to `.env.local`.

Now that we know local files should never be committed to git, we can automatically add `.env*.local` to `.gitignore`. Note that this is the same ignore pattern that ships with create-next-app [as seen here](https://github.com/vercel/next.js/blob/06abd634899095b6cc28e6e8315b1e8b9c8df939/packages/create-next-app/templates/app/js/gitignore#L28), so most Next.js users won't see anything change.

See the related [Linear ticket](https://linear.app/vercel/issue/VCCLI-461/)",2023,6
94d5612dcef3a2a40558a8a571daf7471f8a0dac,Nathan Rajlich,2023-06-07 21:33:47+00:00,GitHub,2023-06-07 21:33:47+00:00,"[cli] Move readme copy logic to a helper function for `vc link` (#10084)

ncc has an issue with detecting + rewriting this file path for some reason. Moving to a helper function should work around that issue.

Fixing:

```
Error: ENOENT: no such file or directory, open '/node_modules/vercel/projects/VERCEL_DIR_README.txt'
```",2023,6
3eaf58bb7417f4cad4e56961c7fc9e9b59802a97,Nathan Rajlich,2023-06-07 18:48:28+00:00,GitHub,2023-06-07 18:48:28+00:00,"[cli] Add support for `vc dev` command with repo link (#10082)

When repo linked, `vc dev` already works fine when run from the root of the repo. This change makes it so that `vc dev` also works as expected when executed within a project subdirectory.",2023,6
e63cf401531f9759e981aacf036f32b1a3870025,Nathan Rajlich,2023-06-07 08:26:13+00:00,GitHub,2023-06-07 08:26:13+00:00,"[cli] Add support for `vc build` command with repo link (#10075)

When the repo is linked to Vercel with `vc link --repo`, the `vc build` command should be invoked from the project subdirectory (otherwise the project selector is displayed). The output directory is at `<projectRoot>/.vercel/output` instead of at the repo root.",2023,6
709c9509f4c5ee9b1621c4d83fbf6d0b36a4a8e7,Sean Massa,2023-06-07 07:49:45+00:00,GitHub,2023-06-07 07:49:45+00:00,"Revert ""Revert ""[cli] Add support for `vc pull` command with repo link"""" (#10078)

Reverts vercel/vercel#10076

Restores the original PR: https://github.com/vercel/vercel/pull/10071

With the fix from: https://github.com/vercel/vercel/pull/10073",2023,6
6107c1ed22449c6cde4aebaccc463ffcb6442bcc,Nathan Rajlich,2023-06-07 06:27:39+00:00,GitHub,2023-06-07 06:27:39+00:00,"Disable ""Enforce Changeset"" job for release PRs (#10080)

This job leads to a false-positive for the release PR, so disable it.",2023,6
7a0f377afe121c1be0190d4467e3b7216aaedbd8,Vercel Release Bot,2023-06-07 06:23:29+00:00,GitHub,2023-06-07 06:23:29+00:00,"Version Packages (#10074)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,6
a04bf557fc6e1080a117428977d0993dec78b004,Sean Massa,2023-06-07 06:20:19+00:00,GitHub,2023-06-07 06:20:19+00:00,"handle undefined content type in `vc dev` (#10077)

When no content type header is sent to an API request during `vc dev`, the request fails:

```
/Users/smassa/source/vercel/vercel-2/node_modules/.pnpm/content-type@1.0.4/node_modules/content-type/index.js:108
    throw new TypeError('argument string is required')
          ^
TypeError: argument string is required
...
```

This comes from some runtime type validation happening in the `content-type` package, for which we do not have types, which is why typescript didn't catch this.",2023,6
b6736e82cfdee6ef1e5fe2263dedb2d11a3cf707,Sean Massa,2023-06-07 05:46:21+00:00,GitHub,2023-06-07 05:46:21+00:00,Clear revert out of changelog (#10079),2023,6
7923056bc023f1ea9aced038b63b0ac755dd7206,Sean Massa,2023-06-07 05:35:12+00:00,GitHub,2023-06-07 05:35:12+00:00,"Revert ""[cli] Add support for `vc pull` command with repo link"" (#10076)",2023,6
71ff193ea3c9971970e2f410e4434763e5a16963,Nathan Rajlich,2023-06-06 22:01:37+00:00,GitHub,2023-06-06 22:01:37+00:00,"[cli] Add support for `vc pull` command with repo link (#10071)

When the repo is linked to Vercel with `vc link --repo`, the `.vercel` directory will be created at the _project root_ instead of the _repo root_, and will still contain the `project.json`.

The difference is that the `orgId` and `projectId` props will not be present in the `project.json` file when repo linked, since that information is available at the root level `repo.json` file.",2023,6
c21d93de4421d9780edf8a6c25da1ee8aebe3820,Vercel Release Bot,2023-06-06 21:34:04+00:00,GitHub,2023-06-06 21:34:04+00:00,"Version Packages (#10062)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,6
0039c8b5cea975316a62c4f6aaca5d66d731cc0d,Kiko Beats,2023-06-06 21:15:10+00:00,GitHub,2023-06-06 21:15:10+00:00,"[node] Add isomorphic functions (#9947)

This PR allow using Web APIs in Serverless functions

```js
// api/serverless.js
export const GET = () => {
  return new Response(`new Response('üëã Hello from Serverless Web!)`)
}
```

More about that
https://nextjs.org/docs/app/building-your-application/routing/router-handlers

---------

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,6
49c7178567ec5bcebe633b598c8c9c0e1aa40fbb,Vercel Release Bot,2023-06-06 20:31:48+00:00,GitHub,2023-06-06 20:31:48+00:00,"[remix] Update `@remix-run/dev` to v1.17.0 (#10072)

This auto-generated PR updates `@remix-run/dev` to version 1.17.0.",2023,6
b038b29614585670b476bb12721af68ec7373c4d,Ethan Arrowood,2023-06-06 00:52:38+00:00,GitHub,2023-06-06 00:52:38+00:00,"Add vercel.json setting overrides to storybook example for zero-config experience (#10067)

This PR adds necessary configuration overrides to the storybook example so that it can have a zero-config experience.",2023,6
7a249a22845324eb1ebcee4ef0c5a680b536c544,Nathan Rajlich,2023-06-05 22:44:40+00:00,GitHub,2023-06-05 22:44:40+00:00,"Enforce a changeset file to be present (#10065)

Based off of these setup instructions:

https://github.com/changesets/changesets/blob/main/docs/automating-changesets.md#blocking

If a commit should really not publish a release, you can run `changeset
--empty`.",2023,6
a5e32ec31d2518a95031e94b196e38015366ceab,Nathan Rajlich,2023-06-05 17:06:57+00:00,GitHub,2023-06-05 17:06:57+00:00,"[cli] Add `client.fetchPaginated()` async iterator (#10054)

Adds async iterator helper function for interacting with endpoints that have pagination.

Implemented for use with `vc bisect` (fetching deployments) and `vc link --repo` (fetching projects).",2023,6
bc5afe24c4547dbf798b939199e8212c4b34038e,Florentin / ÁèûËæ∞,2023-06-05 08:05:53+00:00,GitHub,2023-06-05 08:05:53+00:00,"[node] add `maxDuration` config support for vc node deployments (#10028)

This PR enables specifying `maxDuration` in `config` for node vc
deployments.

---------

Co-authored-by: Nathan Rajlich <n@n8.io>",2023,6
5070e3bbbdb7a7a18b94138baa2ebb9dd43358a4,Vercel Release Bot,2023-06-05 03:57:56+00:00,GitHub,2023-06-05 03:57:56+00:00,"[tests] Upgrade Turbo to version 1.10.1 (#10059)

This auto-generated PR updates Turbo to version 1.10.1",2023,6
4ad1cbbd7d488fd8d1bcadc54ff64c47aeffbbad,Vercel Release Bot,2023-06-03 00:29:17+00:00,GitHub,2023-06-03 00:29:17+00:00,"Version Packages (#10058)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,6
4f4e09477da3fbb8754ad14ade6a76549acabfeb,Chris Barber,2023-06-03 00:24:32+00:00,GitHub,2023-06-03 00:24:32+00:00,Attempting to publish build-utils and vercel (#10057),2023,6
cd35071f609d615d47bc04634c123b33768436cb,Chris Barber,2023-06-03 00:22:22+00:00,GitHub,2023-06-03 00:22:22+00:00,Attempting to publish build-utils and vercel (#10057),2023,6
f373c94508f70c4a7dbac7a7128474c5ba4114e9,Vercel Release Bot,2023-06-02 21:28:57+00:00,GitHub,2023-06-02 21:28:57+00:00,"Version Packages (#10055)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,6
553c001eb03ed01308963ba74628a45d64874b5f,Chris Barber,2023-06-02 21:04:03+00:00,GitHub,2023-06-02 21:04:03+00:00,"[cli] `vc build` ignore `.env*` & ignore files for `@vercel/static` (#10056)

For projects with static files only (e.g. `@vercel/static` builder), do not copy`.env*`, `.vercelignore`, or `.nowignore` into the BOA output dir.",2023,6
f6c3a9578374fdc6b1aeb6f5ad81bfe412eb26f8,Chris Barber,2023-06-02 15:27:28+00:00,GitHub,2023-06-02 15:27:28+00:00,"[cli] Ensure .npmrc does not contain use-node-version (#10049)

When a project has a `.npmrc` containing `use-node-version`, package managers (notably `pnpm`) will download the specified Node.js version. This is not the correct way as it can lead to `pnpm` downloading Node.js 18 or newer which depends on a version of GLIBC that is not present in the current AWS image. The proper way is to set the `""engines""` in the `package.json`.

<img width=""468"" alt=""image"" src=""https://github.com/vercel/vercel/assets/97262/0974cf05-6a11-4d95-88e8-13affc4aad2a"">

Discussion: https://github.com/orgs/vercel/discussions/2436",2023,6
c0bcef0ca4a36d07ec3315961e99a0eb24ad2fcb,Sean Massa,2023-06-01 17:07:18+00:00,GitHub,2023-06-01 17:07:18+00:00,Update CODEOWNERS for `.changeset/` (#10053),2023,6
4cd77608e883f4f8eec91c612d0787f48ac8aa9d,Vercel Release Bot,2023-06-01 15:09:24+00:00,GitHub,2023-06-01 15:09:24+00:00,"Version Packages (#10020)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,6
e6b2980ebaac2a4eb2ef678d85ce4e83ec7cc78f,Steven,2023-05-31 22:24:54+00:00,GitHub,2023-05-31 22:24:54+00:00,"[tests] Fix summary workflow to always run (#10048)

### Description
This ensures the Summary job always runs to check if any test failed and
cause itself to fail as well.

This allows us to dynamically add as many concurrent jobs as we want but
only have one (Summary) marked as required.

### Testing
I verified this worked by making a change to `@vercel/static-config`
which is not required and the Summary check failed:

https://github.com/vercel/vercel/actions/runs/5136560652/jobs/9243924596

Then I reverted it so that the test was passing and the Summary check
passed:

https://github.com/vercel/vercel/actions/runs/5137401343/jobs/9245554297",2023,5
67e20a6ede34cb7372cb2158788d47b89e2f9194,Nathan Rajlich,2023-05-31 18:07:30+00:00,GitHub,2023-05-31 18:07:30+00:00,"[cli] Add repo linking support for `deploy` command (#10013)

Adds support for `vercel deploy` command when the repository has been linked via `vercel link --repo`.",2023,5
c63679ea0a6bc48c0759ccf3c0c0a8106bd324f0,JJ Kasper,2023-05-31 15:38:22+00:00,GitHub,2023-05-31 15:38:22+00:00,"Revert ""[next] Update rsc content-type test fixtures"" (#10040)

Relies on https://github.com/vercel/next.js/pull/50472 this should only be merged after the Next.js PR is released to canary

Reverts vercel/vercel#10023",2023,5
4280166df45bcab971856be47c2f5a735e295d7e,Damien Simonin Feugas,2023-05-31 07:41:46+00:00,GitHub,2023-05-31 07:41:46+00:00,docs(sveltekit): re-introduce speed insights (#9988),2023,5
18ae78137cf5a8044beca3f1b4307f7540ee45b6,Nathan Rajlich,2023-05-30 21:10:03+00:00,GitHub,2023-05-30 21:10:03+00:00,"Fetch git tags during Release workflow (#10045)

Follow-up to #10044. The git tags need to be present for `changeset tag` to work properly.",2023,5
ebe40580731cc7d46822642cfcc7e387644cf1dc,Nathan Rajlich,2023-05-30 19:25:24+00:00,GitHub,2023-05-30 19:25:24+00:00,"Use `pnpm publish -r` and `changeset tag` to publish packages (#10044)

This is a re-application of #10022 (which was reverted in #10032), but with the addition of `changeset tag` after the `pnpm publish -r` command. This ensures the proper git tags are also created, allowing for the GitHub releases to be published.",2023,5
942e76840e3dc85bb0fcfff31e90f8e9fc46599c,Vercel Release Bot,2023-05-29 20:31:12+00:00,GitHub,2023-05-29 20:31:12+00:00,"[tests] Upgrade Turbo to version 1.9.9 (#10036)

This auto-generated PR updates Turbo to version 1.9.9",2023,5
57515d2d07dc63809dfc25017ebec4b760ccf559,Nathan Rajlich,2023-05-26 21:27:19+00:00,GitHub,2023-05-26 21:27:19+00:00,"[cli] Fix `link` subcommand unit tests on Windows (#10033)

Follow-up to #10031 which broke the `link` unit tests on Windows.

For some reason Kodiak was a bad bot and merged the PR with failing tests <picture data-single-emoji="":rarityannoyed:"" title="":rarityannoyed:""><img class=""emoji"" src=""https://emoji.slack-edge.com/T0CAQ00TU/rarityannoyed/b62f8c87a5fb7239.png"" alt="":rarityannoyed:"" width=""20"" height=""auto"" align=""absmiddle""></picture> 

_Note:_ Probably easier to review with [whitespace hidden](https://github.com/vercel/vercel/pull/10033/files?w=1).",2023,5
ef30a46c037adfdf31cdd1e10642130ad41ae8ea,Nathan Rajlich,2023-05-26 20:42:03+00:00,GitHub,2023-05-26 20:42:03+00:00,"[cli] Add `client.cwd` to unify all working directory related logic (#10031)

A few commands were still checking on `--cwd` explicitly, which is incorrect since the entrypoint file already handles the directory change.

The new `client.cwd` property is a helper to make writing tests easier. Tests no longer need to `chdir()` explicitly and then revert afterwards.",2023,5
113b8ac87b89ef2e14a0fbdad9293cf5048aca99,Nathan Rajlich,2023-05-26 20:18:49+00:00,GitHub,2023-05-26 20:18:49+00:00,"Revert ""Use `pnpm publish -r` to publish packages (#10022)"" (#10032)

This reverts commit 1e47bbf32f21262c0d85fa0c1fe89cf59b67cd4c.

`changeset publish` also creates git tags, whereas `pnpm publish -r` does not. This causes the GitHub Releases to not be created.",2023,5
b56ac2717d6769eb400f9746f0a05431929b4501,Shohei Maeda,2023-05-26 18:01:05+00:00,GitHub,2023-05-26 18:01:05+00:00,"[next] Pass `pageExtensions` data to `apiLambdaGroups` (#10015)

Right now, we can't detect API routes correctly if `pageExtensions` is set:

> WARNING: Unable to find source file for page xxxx with extensions: js, jsx, ts, tsx, this can cause functions config from `vercel.json` to not be applied",2023,5
aa8957ab104bfffa7e937bb356b4d393d9b62c7b,Vercel Release Bot,2023-05-26 14:54:42+00:00,GitHub,2023-05-26 14:54:42+00:00,"[examples][tests] Upgrade Next.js to version 13.4.4 (#10025)

This auto-generated PR updates 3 packages to Next.js version 13.4.4",2023,5
c6c19354e852cfc1338b223058c4b07fdc71c723,Shohei Maeda,2023-05-25 21:01:29+00:00,GitHub,2023-05-25 21:01:29+00:00,"[next] Fix `functions` config with App Router (#9889)

We added appDir support in https://github.com/vercel/vercel/pull/9811 so that users can customize `memory`/`maxDuration` for routes in appDir.

But since RSC is enabled by default in Next.js 13, `vercel build` still reports some warning messages, such as:

```json
""functions"": {
  ""app/**/*"": {
    ""maxDuration"": 5,
    ""memory"": 512
  }
}
```
```
WARNING: Unable to find source file for page hello.js with extensions: ts, tsx, js, jsx, md, mdx, this can cause functions config from `vercel.json` to not be applied
WARNING: Unable to find source file for page index.js with extensions: ts, tsx, js, jsx, md, mdx, this can cause functions config from `vercel.json` to not be applied
```

To suppress these errors and properly apply `functions` setting to those routes, updating the current detection logic to also search `page.${ext}` files.",2023,5
96b2502133b36e060ce47ded9d7a74b70e63b8df,JJ Kasper,2023-05-25 08:32:53+00:00,GitHub,2023-05-25 08:32:53+00:00,"[next] Update rsc content-type test fixtures (#10023)

This updates the tests to the latest expected content-type header for RSC responses. 

x-ref: https://github.com/vercel/next.js/pull/50314",2023,5
2df0262675f2db6c70d622f213103169bc6704e6,Swarnava Sengupta,2023-05-24 22:06:01+00:00,GitHub,2023-05-24 22:06:01+00:00,[examples] Update `preact` template to use Node 18 (#10012),2023,5
1e47bbf32f21262c0d85fa0c1fe89cf59b67cd4c,Nathan Rajlich,2023-05-24 21:56:45+00:00,GitHub,2023-05-24 21:56:45+00:00,"Use `pnpm publish -r` to publish packages (#10022)

Following the instructions here: https://pnpm.io/using-changesets

This should ensure that packages are published in the correct order (see related issue: https://github.com/changesets/changesets/issues/238).",2023,5
00813a3945fa5c79e3f517f87f3bce204e27fd86,Nathan Rajlich,2023-05-24 21:35:33+00:00,GitHub,2023-05-24 21:35:33+00:00,"[cli] Add `expect` dev dependency to fix type error in `toOutput` (#10021)

Also make the timeout print what was buffered to help with debugging failed tests.",2023,5
a73ec6343f9b80f9149272724da750c851cb473a,Chris Barber,2023-05-24 19:10:28+00:00,GitHub,2023-05-24 19:10:28+00:00,"[cli] Clean up 'vc rollback' (#10019)

This PR removes dependency on the deprecated `lastRollbackTarget` project property and adopts many of the code conventions used in `vc promote`.

Important! Please merge #9984 first!",2023,5
4bd70d4b6e475249d67445286bdbcd77ceb32adc,Chris Barber,2023-05-24 17:22:11+00:00,GitHub,2023-05-24 17:22:11+00:00,"[cli] New `vc promote` command (#9984)

~This PR is blocked by https://github.com/vercel/api/pull/19508.~

Linear: https://linear.app/vercel/issue/VCCLI-262/cli-new-command-to-promote-deployment",2023,5
c7bcea408131df2d65338e50ce319a6d8e4a8a82,Javi Velasco,2023-05-24 16:22:43+00:00,GitHub,2023-05-24 16:22:43+00:00,"Remove usage of `env` from Edge Functions and Middleware (#10018)

Co-authored-by: Steven <steven@ceriously.com>",2023,5
aab95532d66760d9e70187b3182944afcf967518,Vercel Release Bot,2023-05-24 15:13:01+00:00,GitHub,2023-05-24 15:13:01+00:00,"Version Packages (#10006)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,5
1b18c853c26af72ebae493a996bc9be6e0ab0efd,Sean Massa,2023-05-23 19:26:47+00:00,GitHub,2023-05-23 19:26:47+00:00,"[cli] implement `vc deploy --prod --skip-domain` (#9836)

Adds the `--skip-domain` option to be used like `vc deploy --prod --skip-domain`. This passes along the `autoAliasCustomDomains: false` flag to the API so that the deployment will not auto alias domains for this deployment.

This PR also moves the `commands/deploy/archive` fixture to `commands/deploy/static` to better describe what the fixture is, not how it is sometimes used in a test.

---

Depends on: https://github.com/vercel/api/pull/18730
Card: https://linear.app/vercel/issue/VCCLI-276/cli-allow-creation-of-production-deployment-without-auto-alias",2023,5
1663db7ca34d3dd99b57994f801fb30b72fbd2f3,Swarnava Sengupta,2023-05-23 18:29:14+00:00,GitHub,2023-05-23 18:29:14+00:00,[examples] Update `solid-js` template to use Node 18 (#10009),2023,5
e80247fb992452ef49b6e86555443b8a348a2df5,Nathan Rajlich,2023-05-23 15:01:18+00:00,GitHub,2023-05-23 15:01:18+00:00,"Update to latest version of `patrickedqvist/wait-for-vercel-preview` (#10008)

The older version we were using is using Node 12, and GH Actions prints this warning:

> Node.js 12 actions are deprecated. Please update the following actions to use Node.js 16: patrickedqvist/wait-for-vercel-preview@ae34b392ef30297f2b672f9afb3c329bde9bd487. For more information see: https://github.blog/changelog/2022-09-22-github-actions-all-actions-will-begin-running-on-node16-instead-of-node12/.

The current version of this action uses Node 16.",2023,5
a19edc985b8832b72fa72bf18fa4216d3ca51783,Samuel Bodin,2023-05-23 02:50:42+00:00,GitHub,2023-05-23 02:50:42+00:00,"[cli] Fix `vercel git connect` command when passing a URL parameter (#9967)

Hey team,

I had an error this morning when trying to link my repo using the CLI 
![Screenshot 2023-05-17 at 11 38 01](https://github.com/vercel/vercel/assets/1637651/798d6e4f-8c9e-41b7-b712-0322001fca02)


Seems like a combination of `: any` and a recent refacto introduced an issue here.

~- Removed all `any` that were hiding the error~
- Correctly pass the URL already parsed

~- Removed the second useless parsing~
~- Added missing `--help` flag~
  ~I noticed you never specify them and Typescript screams because of that, not sure if on purpose and how you make the compilation pass with this error. Don't hesitate to tell me.~

The fix could be improved by using `arg.Result<THE_ACTUAL_TYPE>` but that would require to store the dictionnary of flags somewhere else and also create an external type. This is already better so...

--- 

NB: 
I had multiple issues while cloning this repo
- pnpm bootstrap does not work
- missing `constants.ts` file that is not explained in the Contributing guidelines
- maybe due to bootstrap not working, almost nothing else worked and the tests too.",2023,5
4fd593ac09fefc8aaed2bb14d8bfde818dc52c7a,Nathan Rajlich,2023-05-22 22:26:36+00:00,GitHub,2023-05-22 22:26:36+00:00,"Sync repo package versions (#10002)

Some of these packages got out of sync at some point, causing duplicate
/ older copies to be installed. Additionally, the `@vercel-internal`
packages should have ""version"" fields.

Attempting to fix these
[warnings](https://github.com/vercel/vercel/actions/runs/5048844603/jobs/9057538600)
during release:

```
Package ""examples"" must depend on the current version of ""@vercel/frameworks"": ""1.4.2"" vs ""1.3.0""
Package ""@vercel-internals/constants"" must depend on the current version of ""@vercel/build-utils"": ""6.7.3"" vs ""6.3.2""
Package ""@vercel-internals/constants"" must depend on the current version of ""@vercel/routing-utils"": ""2.2.1"" vs ""2.1.10""
Package ""@vercel-internals/constants"" must depend on the current version of ""@vercel-internals/tsconfig"": ""undefined"" vs ""*""
Package ""@vercel-internals/get-package-json"" must depend on the current version of ""@vercel-internals/tsconfig"": ""undefined"" vs ""*""
Package ""@vercel-internals/types"" must depend on the current version of ""@vercel-internals/constants"": ""undefined"" vs ""*""
Package ""@vercel-internals/types"" must depend on the current version of ""@vercel/build-utils"": ""6.7.3"" vs ""6.3.2""
Package ""@vercel-internals/types"" must depend on the current version of ""@vercel/routing-utils"": ""2.2.1"" vs ""2.1.10""
Package ""@vercel-internals/types"" must depend on the current version of ""@vercel-internals/tsconfig"": ""undefined"" vs ""*""
Package ""vercel"" must depend on the current version of ""@vercel-internals/constants"": ""undefined"" vs ""*""
Package ""vercel"" must depend on the current version of ""@vercel-internals/get-package-json"": ""undefined"" vs ""*""
Package ""vercel"" must depend on the current version of ""@vercel-internals/types"": ""undefined"" vs ""*""
Package ""@vercel/node"" must depend on the current version of ""@vercel/error-utils"": ""1.0.10"" vs ""1.0.8""
```",2023,5
1b0d72aba50c4cb1cfe2298cac6d66e82c439b09,Dan Stowell,2023-05-22 22:24:38+00:00,GitHub,2023-05-22 22:24:38+00:00,"[cli] Change `vc env pull` default output file to `.env.local` (#9892)

`vc deploy` ignores `.env.local`. To make sure we don't inadvertently
push people's secrets to source control, have all environment pulls
default to writing to `.env.local`.",2023,5
c52a59809e30be9769ef6a2805465bd9682f1afe,Nathan Rajlich,2023-05-22 22:16:47+00:00,GitHub,2023-05-22 22:16:47+00:00,"Remove `pnpm bootstrap` from contributing instructions (#10005)

This script no longer exists.",2023,5
cdf55b3b1a5fff91241971054ea172c0a95f8c2a,Chris Barber,2023-05-22 22:08:49+00:00,GitHub,2023-05-22 22:08:49+00:00,"[cli] New `vc redeploy` command (#9956)

This adds a new `vc redeploy <url-or-id>` command. It fetches the requested deployment, then performs a redeploy with similar output to `vc deploy` including the ability to pipe the deployment URL into a file or program.

### Redeploy Example:

<img width=""650"" alt=""image"" src=""https://github.com/vercel/vercel/assets/97262/b17fc424-558b-415c-8b74-63e450f4b753"">

### Bad deployment URL:

<img width=""579"" alt=""image"" src=""https://github.com/vercel/vercel/assets/97262/0cb53209-396e-4490-b5d0-744d5d870aaf"">

### No args:

<img width=""622"" alt=""image"" src=""https://github.com/vercel/vercel/assets/97262/cb36d625-991b-41fa-bb49-d7d36c1a201b"">

Linear: https://linear.app/vercel/issue/VCCLI-558/cli-new-command-to-redeploy",2023,5
8de42e0a70f7c3a5fda5c671e9489c1f5add7376,Nathan Rajlich,2023-05-22 21:44:52+00:00,GitHub,2023-05-22 21:44:52+00:00,"[cli] Remove `--platform-version` global common arg (#9807)

Removes the unused `--platform-version` flag from the common args.

Technically this is a breaking change, so we should probably hold off on merging until we plan to do a major version bump.",2023,5
7ff321310f5d8d2224947a87ddfe2125b7abf5f3,Swarnava Sengupta,2023-05-22 18:56:21+00:00,GitHub,2023-05-22 18:56:21+00:00,"[examples] Update ""vue"" template to use Node 18 (#10001)",2023,5
2da72bc5e4ff76157519ff7c27ce51799f4c4e9f,Nathan Rajlich,2023-05-22 18:49:51+00:00,GitHub,2023-05-22 18:49:51+00:00,"Fix promoting CLI release to ""latest"" GH Release (#10003)

The logic to retrieve the latest release was not working correctly, so use the `getLatestRelease()` function instead of assuming that `release[0]` is tagged as the latest.",2023,5
46950633f417299b1c6525bbc32291900db41a36,Vercel Release Bot,2023-05-22 17:47:47+00:00,GitHub,2023-05-22 17:47:47+00:00,Version Packages (#9994),2023,5
44b1dfe7c522454daa55614d0df38782bdbb9bb7,Vercel Release Bot,2023-05-22 08:50:23+00:00,GitHub,2023-05-22 08:50:23+00:00,"[tests] Upgrade Turbo to version 1.9.8 (#9996)

This auto-generated PR updates Turbo to version 1.9.8",2023,5
0278c7b7b955fd318cd84a2d9cebc543501e86f2,Vercel Release Bot,2023-05-19 21:08:38+00:00,GitHub,2023-05-19 21:08:38+00:00,"[examples] Upgrade Next.js to version 13.4.3 (#9980)

This auto-generated PR updates Next.js to version 13.4.3",2023,5
761db597be6acadb49a01fa74412562ec738ee20,Sean Massa,2023-05-19 19:31:32+00:00,GitHub,2023-05-19 19:31:32+00:00,"clarify next.js dupe api directory warning (#9979)

In a Next.js app, if you have Node.js Functions in both `api` and `pages/api`, you'll get a warning about moving those `api` functions into `pages/api`. This does specify Node.js Functions already, but a user was confused and tried to move their non-Node.js functions into `pages/api` as well.

This PR tries to make it clearer that you can do both. Note that this still requires a non-ideal local dev setup where you:

- update next config to fall back to the `vc dev` port for `api` handlers
- run `next dev` for the Next.js app on one port
- run `vc dev` for the top-level `api` Functions on another port

---

Example repo: https://github.com/rexfordessilfie/vercel-api-languages",2023,5
671e63e7b8acf2668bddb9869a851b2204be3b6a,Nathan Rajlich,2023-05-19 18:53:49+00:00,GitHub,2023-05-19 18:53:49+00:00,"[cli] Add `vc link --repo` flag (alpha) (#8931)

Adding a new `--repo` flag to `vc link` which is a new linking style to
link to a Git URL rather then directly to a single Vercel Project. This
allows for multiple Projects to be linked simultaneously, which is
useful for monorepo setups.

Utilization of this new linking style in other commands will be done in
a follow-up PR.",2023,5
f7bdc6cc26c14857317086df0a8ab5109b2cb288,Vercel Release Bot,2023-05-19 17:08:50+00:00,GitHub,2023-05-19 17:08:50+00:00,"Version Packages (#9991)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,5
e94a153b2f4d9f23bf74241a62a06fe9996a7b07,Sean Massa,2023-05-19 17:02:12+00:00,GitHub,2023-05-19 17:02:12+00:00,add repo details for packages that are missing it (#9990),2023,5
74e639a772cae7a36d6119ca51f0e9a1d51787dc,Vercel Release Bot,2023-05-19 16:34:26+00:00,GitHub,2023-05-19 16:34:26+00:00,"Version Packages (#9978)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## @vercel/build-utils@6.7.3

### Patch Changes

- Deprecate Node.js 14.x and 16.x with warning
([#9976](https://github.com/vercel/vercel/pull/9976))

## vercel@29.3.5

### Patch Changes

- Updated dependencies
\[[`2c950d47a`](https://github.com/vercel/vercel/commit/2c950d47aeb22a3de16f983259ea6f37a4555189),
[`71b9f3a94`](https://github.com/vercel/vercel/commit/71b9f3a94b7922607f8f24bf7b2bd1742e62cc05),
[`f00b08a82`](https://github.com/vercel/vercel/commit/f00b08a82085c3a63059f34f67f10ced92f2979c)]:
    -   @vercel/static-build@1.3.31
    -   @vercel/build-utils@6.7.3
    -   @vercel/next@3.8.5
    -   @vercel/node@2.14.3
    -   @vercel/remix-builder@1.8.10

## @vercel/client@12.5.1

### Patch Changes

- Updated dependencies
\[[`71b9f3a94`](https://github.com/vercel/vercel/commit/71b9f3a94b7922607f8f24bf7b2bd1742e62cc05)]:
    -   @vercel/build-utils@6.7.3

## @vercel/gatsby-plugin-vercel-builder@1.3.4

### Patch Changes

- Updated dependencies
\[[`71b9f3a94`](https://github.com/vercel/vercel/commit/71b9f3a94b7922607f8f24bf7b2bd1742e62cc05)]:
    -   @vercel/build-utils@6.7.3
    -   @vercel/node@2.14.3

## @vercel/next@3.8.5

### Patch Changes

- [next] Ensure app functions are detected/separated properly
([#9989](https://github.com/vercel/vercel/pull/9989))

## @vercel/node@2.14.3

### Patch Changes

- Updated dependencies
\[[`71b9f3a94`](https://github.com/vercel/vercel/commit/71b9f3a94b7922607f8f24bf7b2bd1742e62cc05)]:
    -   @vercel/build-utils@6.7.3

## @vercel/remix-builder@1.8.10

### Patch Changes

- Updated dependencies
\[[`71b9f3a94`](https://github.com/vercel/vercel/commit/71b9f3a94b7922607f8f24bf7b2bd1742e62cc05)]:
    -   @vercel/build-utils@6.7.3

## @vercel/static-build@1.3.31

### Patch Changes

- ensure cleanup after gatsby plugin runs
([#9975](https://github.com/vercel/vercel/pull/9975))

-   Updated dependencies \[]:
    -   @vercel/gatsby-plugin-vercel-builder@1.3.4

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,5
f00b08a82085c3a63059f34f67f10ced92f2979c,JJ Kasper,2023-05-19 16:22:44+00:00,GitHub,2023-05-19 16:22:44+00:00,"[next] Ensure app functions are detected/separated properly (#9989)

Follow-up to https://github.com/vercel/vercel/pull/9974 this uses the `lambdaAppPaths` as the source of truth instead of the manifest which is more accurate for separating/detecting. Also adds additional test cases for new root and index app functions. 

x-ref: https://github.com/vercel/next.js/issues/49169",2023,5
6cdd38d130c068f498837d33004142f6a96a892e,Chris Barber,2023-05-19 14:06:08+00:00,GitHub,2023-05-19 14:06:08+00:00,"[tests] Pin Next.js version in test fixtures (#9910)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,5
2c950d47aeb22a3de16f983259ea6f37a4555189,Sean Massa,2023-05-18 19:42:08+00:00,GitHub,2023-05-18 19:42:08+00:00,"ensure cleanup after the gatsby plugin runs (#9975)

There is an issue where you can interrupt a gatsby project build and the temporary files are not cleaned up. If you try to build again, it will get stuck in an infinite loop.

This PR adds an exit hook to make sure the cleanup happens.",2023,5
71b9f3a94b7922607f8f24bf7b2bd1742e62cc05,Sean Massa,2023-05-18 19:03:01+00:00,GitHub,2023-05-18 19:03:01+00:00,"Deprecate Node.js 14.x and 16.x with warning (#9976)

Node.js 14 and 16 are being deprecated. This PR will cause a warning when they are used today and an error after August 15.",2023,5
91b7f6dcd90ecec469b537f5fc358d579262fe52,Vercel Release Bot,2023-05-18 17:38:24+00:00,GitHub,2023-05-18 17:38:24+00:00,"Version Packages (#9973)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@29.3.4

### Patch Changes

- Updated dependencies
\[[`67e556bc8`](https://github.com/vercel/vercel/commit/67e556bc80c821c233120a2ec1611adb8e195baa),
[`ba10fb4dd`](https://github.com/vercel/vercel/commit/ba10fb4dd4155a75df79b98a0c43a6c42eac7b62)]:
    -   @vercel/remix-builder@1.8.9
    -   @vercel/next@3.8.4

## @vercel/next@3.8.4

### Patch Changes

- Update handling for react prebundled flag
([#9974](https://github.com/vercel/vercel/pull/9974))

## @vercel/remix-builder@1.8.9

### Patch Changes

- Upgrade `@remix-run/dev` fork to v1.16.1
([#9971](https://github.com/vercel/vercel/pull/9971))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,5
ba10fb4dd4155a75df79b98a0c43a6c42eac7b62,JJ Kasper,2023-05-18 13:37:50+00:00,GitHub,2023-05-18 13:37:50+00:00,"[next] Update handling for react prebundled flag (#9974)

This ensures we properly set the prebundled react flag conditionally for
app and pages ensuring they are kept separate when bundling.

x-ref: https://github.com/vercel/next.js/issues/49169",2023,5
18c1c45ce30f181079ff8a947f5fa6db5e370dd8,Nathan Rajlich,2023-05-17 23:39:09+00:00,GitHub,2023-05-17 23:39:09+00:00,"Add changeset for `@remix-run/dev` updater GH Action (#9972)

Adds a changeset file when the GH Action to update `@remix-run/dev`
creates a pull request.",2023,5
67e556bc80c821c233120a2ec1611adb8e195baa,Vercel Release Bot,2023-05-17 19:34:12+00:00,GitHub,2023-05-17 19:34:12+00:00,"[remix] Upgrade @remix-run/dev to version 1.16.1 (#9971)

This auto-generated PR updates @remix-run/dev to version 1.16.1",2023,5
7235000181d198f7793229d69bc7e8f31da5bbc9,Sean Massa,2023-05-17 18:26:30+00:00,GitHub,2023-05-17 18:26:30+00:00,"fix release script (#9959)

The [previous PR](https://github.com/vercel/vercel/pull/9942) used `github.repos`, but I think this needs to be `github.rest.repos`.

- [Docs](https://octokit.github.io/rest.js/v19#repos)
- [Failed GH Action](https://github.com/vercel/vercel/actions/runs/4994578940/jobs/8945329301)",2023,5
5124d431eaa1a513110a55271558cdf48e1f23e3,Sean Massa,2023-05-17 17:45:28+00:00,GitHub,2023-05-17 17:45:28+00:00,"fix deploy from local (#9969)

Local deployments of this repo would fail because this repo assumes that it's only ever deployed via git connection.",2023,5
c879401bbc867900faea2d261a9ae673f320c18c,Vercel Release Bot,2023-05-17 08:45:41+00:00,GitHub,2023-05-17 08:45:41+00:00,"Version Packages (#9966)

This PR was opened by the [Changesets
release](https://github.com/changesets/action) GitHub action. When
you're ready to do a release, you can merge this and the packages will
be published to npm automatically. If you're not ready to do a release
yet, that's fine, whenever you add more changesets to main, this PR will
be updated.


# Releases
## vercel@29.3.3

### Patch Changes

- Updated dependencies
\[[`6c6f3ce9d`](https://github.com/vercel/vercel/commit/6c6f3ce9d228b1e038641e4bafb38c3487e7dff7)]:
    -   @vercel/next@3.8.3

## @vercel/next@3.8.3

### Patch Changes

- Ensure un-necessary rsc routes are not added
([#9963](https://github.com/vercel/vercel/pull/9963))

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,5
6c6f3ce9d228b1e038641e4bafb38c3487e7dff7,JJ Kasper,2023-05-16 23:33:09+00:00,GitHub,2023-05-16 23:33:09+00:00,"[next] Ensure un-necessary rsc routes are not added (#9963)

These routes aren't needed for RSC as `_next/data` isn't used for
routing app paths.

x-ref: [slack
thread](https://vercel.slack.com/archives/C058FQFKAGH/p1684272340654679?thread_ts=1684271538.503259&cid=C058FQFKAGH)",2023,5
aa836808325251db75fb34a680f5e25c875f9781,Vercel Release Bot,2023-05-16 22:54:10+00:00,GitHub,2023-05-16 22:54:10+00:00,"[examples] Upgrade Next.js to version 13.4.2 (#9943)

This auto-generated PR updates Next.js to version 13.4.2",2023,5
06113d3e39a2a472adae01c442175b92430f690e,Vercel Release Bot,2023-05-16 20:53:57+00:00,GitHub,2023-05-16 20:53:57+00:00,"Version Packages (#9962)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,5
5150f21404bdae5e84ff5b83e46734b71d5a9b18,Luc Leray,2023-05-16 19:17:00+00:00,GitHub,2023-05-16 19:17:00+00:00,"[vc dev] Fix serverless function size limit condition (#9961)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,5
eb6bb98406d630f872a60b298e638129793da308,Sean Massa,2023-05-16 16:49:25+00:00,Sean Massa,2023-05-16 16:49:25+00:00,empty push test,2023,5
d8e3b6e7385a42c212d197ab3a79b6d6805f2ea9,Vercel Release Bot,2023-05-16 16:48:06+00:00,GitHub,2023-05-16 16:48:06+00:00,"Version Packages (#9950)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>
Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,5
25da051d62be8e18f4c3440cd90812b7ca098009,Luc Leray,2023-05-16 15:58:04+00:00,GitHub,2023-05-16 15:58:04+00:00,"[vc dev] Skip 50MB zip size limit for Python (#9944)

Do not apply the 50MB zip size limit for Python serverless function during `vc dev`.

Related to internal PR: https://github.com/vercel/api/pull/19279",2023,5
f57af66dc2e9d2e5d6bcca5cbae2076ce23424a1,Vercel Release Bot,2023-05-16 03:21:01+00:00,GitHub,2023-05-16 03:21:01+00:00,"[tests] Upgrade Turbo to version 1.9.4 (#9952)

This auto-generated PR updates Turbo to version 1.9.4",2023,5
b2f71d5352791220a133188cdd81a5542100a181,Nathan Rajlich,2023-05-15 21:38:30+00:00,GitHub,2023-05-15 21:38:30+00:00,"Remove ""Required PR Label"" workflow (#9958)

Changesets enforces this, so no need for this extra workflow anymore.",2023,5
6115f0d74a90b1931ce500be2c3a05645c8529f6,Lee Robinson,2023-05-13 20:32:46+00:00,GitHub,2023-05-13 20:32:46+00:00,"Update README (#9951)

To be more clear about what Vercel is actually providing you, as a developer.",2023,5
14c877e46825c4225687d7b1b04ff601403f1ee9,Nathan Rajlich,2023-05-12 22:08:59+00:00,GitHub,2023-05-12 22:08:59+00:00,"[cli] Sort keys in `vc env pull` (#9949)

Makes sense to have the output be deterministic. Alphabetical sort seems like a logical choice.",2023,5
d80732d74fce4f673e250354d77664b2d13b69b0,Nathan Rajlich,2023-05-11 20:40:34+00:00,GitHub,2023-05-11 20:40:34+00:00,"[release] Promote `vercel` CLI release to ""latest"" (#9942)

It's possible that changesets will promote a release to latest that is
not the Vercel CLI release. This script ensures that a `vercel@` release
is always the latest after a publish happens.",2023,5
b739c1845cac643352116e36b730cac07265d72a,Vercel Release Bot,2023-05-11 15:46:10+00:00,GitHub,2023-05-11 15:46:10+00:00,"Version Packages (#9939)

Co-authored-by: github-actions[bot] <github-actions[bot]@users.noreply.github.com>",2023,5
e9f0fcf397f62fe81c13cd5daaa2e67f8a4ccde6,Sean Massa,2023-05-11 15:16:48+00:00,GitHub,2023-05-11 15:16:48+00:00,"[cli] remove `vc rollback` beta label (#9928)

Remove the ""beta"" label from `vc rollback`.",2023,5
924a20a0fcf172ca0742edb54baa403aceb928d8,Sean Massa,2023-05-11 14:50:14+00:00,GitHub,2023-05-11 14:50:14+00:00,[tests] make prettier ignore .changeset (#9938),2023,5
fc3b74d06ff11d2c463216fc1a9f37b2658001c5,Nathan Rajlich,2023-05-10 23:24:28+00:00,GitHub,2023-05-10 23:24:28+00:00,"Add `id-token: write` permissions to enable npm publish provenance (#9936)

Was previously added in https://github.com/vercel/vercel/pull/9583, was
missed in the changesets switchover.",2023,5
380ed38c7161448f075592f080bac56dce582d9b,Vercel Release Bot,2023-05-10 22:55:42+00:00,GitHub,2023-05-10 22:55:42+00:00,"Version Packages (#9935)

This PR was opened by the [Changesets release](https://github.com/changesets/action) GitHub action. When you're ready to do a release, you can merge this and the packages will be published to npm automatically. If you're not ready to do a release yet, that's fine, whenever you add more changesets to main, this PR will be updated.


# Releases
## vercel@29.2.1

### Patch Changes

-   Updated dependencies \[[`6d5983eaa`](https://github.com/vercel/vercel/commit/6d5983eaaefe3fd2204f49c3228718ac64a452e3)]:
    -   @vercel/remix-builder@1.8.8

## @vercel/remix-builder@1.8.8

### Patch Changes

-   Upgrade `@remix-run/dev` to v1.16.0-patch.1 to fix erroneous ""not found in your node_modules"" warning ([#9930](https://github.com/vercel/vercel/pull/9930))",2023,5
e228cdd373cf9a8a077208566010ba1a22eeae5c,Nathan Rajlich,2023-05-10 21:47:42+00:00,GitHub,2023-05-10 21:47:42+00:00,"Add `@svitejs/changesets-changelog-github-compact` to package.json (#9934)

Forgot to add the package in #9933 :doh:",2023,5
9bd92535d6ebac27a7973e184c3102569c5aa79f,Nathan Rajlich,2023-05-10 21:41:19+00:00,GitHub,2023-05-10 21:41:19+00:00,"Use Svelte's changelog generator and don't delete `CHANGELOG.md` (#9933)

Partial revert of #9932, since apparently [that didn't
work](https://github.com/vercel/vercel/actions/runs/4941266637/jobs/8833725828).

We can investigate that more later, but this gets it working again
properly at least.

Also use Svelte's changelog generator, since it includes the PR numbers
which Sean wanted.",2023,5
5825e3070046f090cbca998b82a8e01261559e79,Nathan Rajlich,2023-05-10 20:58:29+00:00,GitHub,2023-05-10 20:58:29+00:00,"Create release PR as ""Vercel Bot"" and remove `CHANGELOG.md` files (#9932)

* Have changesets create the release PR as ""Vercel Bot"", so that the
tests run.
* Remove the `CHANGELOG.md` files. They are redundant with the GH
Releases which contain the same information.",2023,5
6d5983eaaefe3fd2204f49c3228718ac64a452e3,Vercel Release Bot,2023-05-10 20:20:15+00:00,GitHub,2023-05-10 20:20:15+00:00,"[remix] Upgrade @remix-run/dev to version 1.16.0-patch.1 (#9930)

This auto-generated PR updates @remix-run/dev to version 1.16.0-patch.1",2023,5
2fd59a3b5a727270018a1a0c13c8b2974c734558,Nathan Rajlich,2023-05-10 19:35:17+00:00,GitHub,2023-05-10 19:35:17+00:00,"Use `changesets` instead of `lerna` (#9914)

`changesets` will improve our release workflow, since we will no longer need to manually curate and publish the changelog and GitHub Release. Instead, you simply merge the publish PR that the changesets GH action maintains as we push commits to `main`.",2023,5
d1d3e9384d139a06acca521348f8f9209bb3d214,Nathan Rajlich,2023-05-10 17:39:11+00:00,Nathan Rajlich,2023-05-10 17:39:11+00:00,"Publish Stable

 - vercel@29.2.0
 - @vercel/client@12.5.0
 - @vercel/frameworks@1.4.2
 - @vercel/fs-detectors@3.9.2
 - @vercel/gatsby-plugin-vercel-builder@1.3.3
 - @vercel/node@2.14.2
 - @vercel/static-build@1.3.30",2023,5
8428632eb1f1a8d7bb39fc11eff06880b246a50c,Nathan Rajlich,2023-05-10 16:36:58+00:00,GitHub,2023-05-10 16:36:58+00:00,"[cli] Add support for Vercel CLI Extensions (#9800)

# Vercel CLI Extensions

Adds a new mechanism to add additional sub-commands to Vercel CLI, inspired by how Git handles sub-commands:

* Extensions are standalone executables that Vercel CLI will spawn as a child process.
* The name of the executable must begin with `vercel-`. For example, to add a sub-command called `vercel example`, there should exist an executable called `vercel-example`.
* The executable can either be a npm package with a `""bin""` entry installed into the local project's workspace, or be globally available in the `$PATH`.
* Extensions can access the [Vercel REST API](https://vercel.com/docs/rest-api), pre-authenticated, by utilizing the `VERCEL_API` env var. Vercel CLI spawns a local HTTP server that adds the `Authorization` header and then proxies to the Vercel REST API.

## Environment Variables

A few environment variables which provide features and context to the extension:

| Name      | Description |
| ----------- | ----------- |
| `VERCEL_API`      | HTTP URL to access the pre-authenticated Vercel API.       |
| `VERCEL_TEAM_ID`  | Provided when the currently selected scope is a Team. |
| `VERCEL_DEBUG` | Provided when the `--debug` flag is used. The command _may_ output additional debug logging. |
| `VERCEL_HELP` | Provided when the `--help` flag is used. The command _should_ print the help output and then end with exit code **2**. |

## Example

```bash
#!/usr/bin/env bash
set -euo pipefail

echo Hi, from a Vercel CLI Extension!
user=""$(curl -s ""$VERCEL_API/v2/user"" | jq -r .user.username)""
echo ""Logged in as: $user""
```

Usage:

```
$ vc example
Vercel CLI 28.18.5
Hi, from a Vercel CLI Extension!
Logged in as: tootallnate
```",2023,5
fa443035f66faf113badac5b6b30e76f46277a7d,Chris Barber,2023-05-06 10:18:52+00:00,GitHub,2023-05-06 10:18:52+00:00,"[tests] Add test for set-cookie with multiple cookies (#9916)

This adds the missing test for https://github.com/vercel/vercel/pull/9899.",2023,5
de2c7e1633a29f28dd7f562bd41572e8d09e8848,Sean Massa,2023-05-05 22:00:27+00:00,GitHub,2023-05-05 22:00:27+00:00,"[cli] rename global options in help output (#9917)

Make the distinction between global and deploy options more clear.

The dim note about how to get `deploy`-specific help:

<img width=""670"" alt=""Screenshot 2023-05-05 at 3 55 49 PM"" src=""https://user-images.githubusercontent.com/41545/236568356-10b9ce4f-2865-4267-a3eb-3488df88a133.png"">",2023,5
75d243513806352fc26aac2b96f025d3d94d3811,Sean Massa,2023-05-05 18:54:50+00:00,GitHub,2023-05-05 18:54:50+00:00,"[cli] refactor help output around default and deploy commands (#9912)

When getting help output for the default command `vc --help`, you get a list of commands. When you specify the `deploy` command with `vc deploy --help`, you get the same list of commands.

This PR makes a distinction between an explicit `deploy` command and a default one for the purposes of help output.

Should show CLI help:

- `vc -h`
- `vc --help`
- `vc help`

Should show `deploy` command help:

- `vc deploy -h`
- `vc deploy --help`
- `vc help deploy`",2023,5
5328bb69e27f27b84c97d3728256e3e26fa5e395,Vercel Release Bot,2023-05-05 16:25:11+00:00,GitHub,2023-05-05 16:25:11+00:00,"[examples] Upgrade Next.js to version 13.4.1 (#9911)

This auto-generated PR updates Next.js to version 13.4.1",2023,5
e3fe368baaac0337dace11cb534af0d817b7c791,Kiko Beats,2023-05-05 14:09:10+00:00,GitHub,2023-05-05 14:09:10+00:00,"[cli][node] upgrade `async-listen` to 3.0.0 (#9907)

The `async-listen@3.0.0` is ESM ready and always returns a `URL`
instance; That helps us to unify code.",2023,5
99832587c545cbdf0e8273c1f1445e61dedcad64,Nathan Rajlich,2023-05-05 00:52:18+00:00,GitHub,2023-05-05 00:52:18+00:00,"[cli] Add support for `HTTPS_PROXY` env var (#9880)

By leveraging the [`proxy-agent`](https://www.npmjs.com/package/proxy-agent) npm module, enable CLI to support making HTTP requests over a proxy, by leveraging the `HTTPS_PROXY` or `ALL_PROXY` env var (same convention as `curl` uses).

Finally closes this ancient issue: https://github.com/vercel/vercel/issues/255",2023,5
47d0d4f84ae0bc74764f9fb4f2c499e4a68bd00e,Vercel Release Bot,2023-05-04 20:25:08+00:00,GitHub,2023-05-04 20:25:08+00:00,"[examples] Upgrade Next.js to version 13.4.0 (#9902)

This auto-generated PR updates Next.js to version 13.4.0",2023,5
aba54ee6cfef34dd633021b5afb3943a0e037fa4,Sean Massa,2023-05-03 23:36:26+00:00,GitHub,2023-05-03 23:36:26+00:00,"[frameworks] validate getOutputDirName and other missing values on framework entries (#9900)

Covers the validation whole in Framework entries over function properties and other missing holes.",2023,5
cd7d3ef1c5cc8b9833e1a1b999ea8ae8e86f6103,Chris Barber,2023-05-03 22:12:45+00:00,GitHub,2023-05-03 22:12:45+00:00,"[node] Explicitly set 'set-cookie' header (#9899)

When looping over the response headers returned by `node-fetch`, it will join `set-cookie` header value into a single string. The whatwg calls for a `headers.getSetCookie()` function to handle the `set-cookie` special case, but `node-fetch@2.x` doesn't support it.

As a workaround, we need to grab the raw `set-cookie` header value.",2023,5
c4915507aae9cbfd745e10ba6cc361efc05f4a98,Sean Massa,2023-05-03 21:20:45+00:00,Sean Massa,2023-05-03 21:20:45+00:00,"Publish Stable

 - vercel@29.1.1
 - @vercel/frameworks@1.4.1
 - @vercel/fs-detectors@3.9.1
 - @vercel/static-build@1.3.29",2023,5
6c02ae9e3639228f4f54cea556360ebbb6112fe4,Sean Massa,2023-05-03 21:19:45+00:00,GitHub,2023-05-03 21:19:45+00:00,[frameworks] Add `getOutputDirName` to Storybook definition (#9898),2023,5
672c1681cc453744e30f985d3e532111d4d7b120,Sean Massa,2023-05-03 19:08:25+00:00,Sean Massa,2023-05-03 19:08:25+00:00,"Publish Stable

 - vercel@29.1.0
 - @vercel/frameworks@1.4.0
 - @vercel/fs-detectors@3.9.0
 - @vercel/gatsby-plugin-vercel-builder@1.3.2
 - @vercel/node@2.14.1
 - @vercel/remix-builder@1.8.7
 - @vercel/static-build@1.3.28",2023,5
7a0dacf8bbbb7c5913c21dc4b5929d90b1db1582,Chris Barber,2023-05-03 19:05:44+00:00,GitHub,2023-05-03 19:05:44+00:00,"[cli][fs-detectors][frameworks] Re-add Storybook support (#9891)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,5
8088b07abfbe1eab31c096af9db184108b9adb5b,Nathan Rajlich,2023-05-03 17:13:59+00:00,GitHub,2023-05-03 17:13:59+00:00,"[remix] Use `debug()` for warnings when reading config file (#9894)

Follow-up to address this comment: https://github.com/vercel/vercel/pull/9888#discussion_r1182739621",2023,5
5ee4acb23bf238dfdb03c0ddda7440913533fabe,Kiko Beats,2023-05-02 18:01:40+00:00,GitHub,2023-05-02 18:01:40+00:00,"use `ws` instead of `undici.WebSocket` (#9893)

The `WebSocket` constructor exposed by `undici` is not working against some db connections.

That can be considered kind of expected since `undici` docs is saying it's experimental.

We're working into isolate the issue and report at `undici` repository, but for now, let's just use `ws` for all the node versions.",2023,5
ff0978593d71cd8b077db700365f46e18aa54984,Nathan Rajlich,2023-05-02 16:32:39+00:00,GitHub,2023-05-02 16:32:39+00:00,"[remix] Suppress warnings when reading config (#9888)

Currently, any warnings logged when calling `readConfig()` are emitted in build logs _three times_:

1. When initially reading the config before executing the Build Command
2. When the Build Command is executed (`remix build` reads the config)
3. After the build, in the `prepareCache()` function

For the callsites that we are in control of (`1.` and `3.`), we should suppress those warnings and only allow the standard warnings when invoking `remix build` to be emitted to the build logs.",2023,5
678e13af53d180f804ffe558343af7eacc769ca5,Chris Barber,2023-05-02 15:03:28+00:00,GitHub,2023-05-02 15:03:28+00:00,[cli][fs-detectors][frameworks] Revert Storybook support (#9890),2023,5
ac2457494af75a4bf583ad7628e443ab136eb68c,Vercel Release Bot,2023-05-02 09:49:13+00:00,GitHub,2023-05-02 09:49:13+00:00,"[remix] Upgrade @remix-run/dev to version 1.16.0 (#9887)

This auto-generated PR updates @remix-run/dev to version 1.16.0",2023,5
8b9a8c09867921cf2294b7f37fd7eb8f1a670889,Vercel Release Bot,2023-05-01 21:55:13+00:00,GitHub,2023-05-01 21:55:13+00:00,"[examples] Upgrade Next.js to version 13.3.4 (#9881)

This auto-generated PR updates Next.js to version 13.3.4

Co-authored-by: Steven <steven@ceriously.com>",2023,5
603a7d8787a6a4539c954fb85e13ba46b55526bd,Nathan Rajlich,2023-05-01 20:53:35+00:00,GitHub,2023-05-01 20:53:35+00:00,"[fs-detectors] Add `disableRootMiddleware`, bypass `ignoreRuntimes` for root-level ""middleware"" files (#9883)

`ignoreRuntimes: ['@vercel/node']` will also disable root-level middleware, which is not intended. So ensure that middleware still work, even for frameworks that have this `ignoreRuntimes` configuration enabled (Remix, RedwoodJS).",2023,5
9240cbc0229e6cfff4916e2d32f7fa37746f980e,Chris Barber,2023-05-01 16:25:06+00:00,GitHub,2023-05-01 16:25:06+00:00,"[cli][fs-detectors][frameworks] Add Storybook support (#9839)

Co-authored-by: Steven <steven@ceriously.com>
Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,5
da046d85de8121e6c851af8e51aff81984646e0b,Vercel Release Bot,2023-05-01 04:21:32+00:00,GitHub,2023-05-01 04:21:32+00:00,"[tests] Update Gatsby fixture versions (#9776)

Automatically generated PR to update Gatsby fixture versions in `@vercel/static-build`",2023,5
f8749e1ff1d69fe25421a1f0f9309542ea50ad6e,Tim Neutkens,2023-04-30 13:59:21+00:00,Tim Neutkens,2023-04-30 13:59:21+00:00,"Publish Stable

 - vercel@29.0.3
 - @vercel/next@3.8.2",2023,4
ec7b1cf80dbc88adeac7804cfaf0ba8aee4f1d9c,Tim Neutkens,2023-04-30 13:58:07+00:00,GitHub,2023-04-30 13:58:07+00:00,"[next] Return all and auto when those are used (#9877)

The edge function deployment API doesn't accept these in the array
format.",2023,4
85947b658ee1b4b3b7fcb631bdc6e591ee1e338a,Tim Neutkens,2023-04-30 09:47:04+00:00,Tim Neutkens,2023-04-30 09:47:04+00:00,"Publish Stable

 - vercel@29.0.2
 - @vercel/next@3.8.1",2023,4
7ab86a94fbc1ba04d01ece4f108710e70c75b5c2,Tim Neutkens,2023-04-30 09:45:28+00:00,GitHub,2023-04-30 09:45:28+00:00,"[next] Fix return value in normalizeRegions (#9876)

Missed that the newRegions wasn't returned. Also added a check for empty
array, e.g. when `home` is not supported and such.",2023,4
b5db13c97035d0eae04a5e075ae74e488d1298d6,Steven,2023-04-29 22:02:35+00:00,Steven,2023-04-29 22:02:35+00:00,"Publish Stable

 - vercel@29.0.1
 - @vercel/fs-detectors@3.8.13
 - @vercel/gatsby-plugin-vercel-builder@1.3.1
 - @vercel/next@3.8.0
 - @vercel/node@2.14.0
 - @vercel/static-build@1.3.27",2023,4
473f62d1410cd073bdc5341d3ebaa9eb47787fa4,Tim Neutkens,2023-04-29 17:25:25+00:00,GitHub,2023-04-29 17:25:25+00:00,"Add support for `home` and `global` as edge function regions (#9869)

Adds `home` and `global` as supported values for `regions` when coming
from Next.js. We'll port these to the build output API at a later time.

Related Next.js changes: https://github.com/vercel/next.js/pull/48959

---------

Co-authored-by: JJ Kasper <jj@jjsweb.site>",2023,4
cc140d6e2852ade7934e9fe6db2b3437ddfad3a4,JJ Kasper,2023-04-29 08:43:40+00:00,GitHub,2023-04-29 08:43:40+00:00,"[node] Fix exposing WebSocket to edge runtime and legacy next tests (#9871)

This ensures we expose WebSocket correctly for edge runtime for Node.js
v16 and v18 properly. This also fixes failing legacy Next.js tests due
to a bad `@babel/compat-data` package publish from 8 hours ago.

x-ref: [slack
thread](https://vercel.slack.com/archives/C04R82GSDBN/p1682709850008189?thread_ts=1682707749.424459&cid=C04R82GSDBN)
x-ref: https://github.com/vercel/next.js/pull/48924
x-ref: https://github.com/vercel/vercel/pull/9860
Closes: https://github.com/vercel/vercel/pull/9870",2023,4
09ac96ae212aa25d953a50ef6f2b731e0a5dd593,Kiko Beats,2023-04-28 21:03:35+00:00,GitHub,2023-04-28 21:03:35+00:00,"[node] expose `WebSocket` constructor in Edge functions (#9860)

This PR exposes `WebSocket` to be used for Edge Runtime for `vc dev`.

Ideally, that's a thing we should to handle inside `edge-runtime`
dependency.

Unfortunately, that is not as easy as it sounds, since Edge Runtime is
doing a heavy use of vm module and `undici` is using some Node.js APIs
that are not available, or they are hard to make them working inside vm.

Related PR: https://github.com/vercel/edge-runtime/pull/309

While we're finishing that work, in order to don't delay users to start
using `WebSocket`, we can simply expose it directly from `undici` as
dependency.

---------

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,4
ebd1bf41b623037c1db22101d2fb40a5c285e496,Nathan Rajlich,2023-04-28 20:37:26+00:00,GitHub,2023-04-28 20:37:26+00:00,"[node] Don't compile ""edge"" functions with Babel (#9868)",2023,4
e1a16b0333a965a6030675b559bb19f1e6ac3d2e,Steven,2023-04-28 19:58:43+00:00,GitHub,2023-04-28 19:58:43+00:00,"[node] Add log message about compiling ESM to CJS (#9866)

When `@vercel/node` was created 5 or so years ago, Node.js didn't support ESM out of the box. So to create a zero configuration experience, babel was introduce to compile the authored ESM into the runtime CJS.

Today, Node.js supports ESM but you have to opt in using `type: module` in package.json or the `.mjs` file extension.

Indeed `@vercel/node` detects ESM and skips babel compilation. However, there is a case where the source code is ESM and a dependency supports both ESM and CJS via `imports` in package.json. This case will break because `@vercel/nft` traces the source file as ESM and assumes the dependency will be resolved as ESM too. But after `@vercel/nft` traces the source file, `@vercel/node` will compile to CJS and thus the trace will be incorrect and fail at runtime.

So this PR adds a warning when babel compiles ESM to CJS because it is no longer expected in 2023.",2023,4
ed568226750618b14dee8cb22c5b9ca7795c28af,Shohei Maeda,2023-04-28 18:59:23+00:00,GitHub,2023-04-28 18:59:23+00:00,"[next] support functions property in appDir (#9811)

Currently, `functions` property (i.e., `memory` and `maxDuration`) are
not supported in appDir routes. This PR attempts to add support.

---------

Co-authored-by: Chris Barber <chris.barber@vercel.com>
Co-authored-by: JJ Kasper <jj@jjsweb.site>",2023,4
ce597ce0ecdabfe085c442a955d375618b3a30a7,Sean Massa,2023-04-27 19:22:47+00:00,GitHub,2023-04-27 19:22:47+00:00,"[node] validate function runtime and throw when ""nodejs"" (#9851)

We want to keep the currently unused `runtime: ""nodejs""` value clear for future use. This PR effectively makes any unrecognized value fail the build. If the value is ""nodejs"" specifically, a direct error is thrown suggesting they remove the value.

Only a handful of projects set this value currently. We're reaching out to them to let them know that this value is not currently supported and that they should remove it. Then, we should deploy this PR so that anyone else using this value will know to remove it.",2023,4
2de365f9cfea3ce283d2bf855507c71209f1e3d8,Sean Massa,2023-04-27 18:09:25+00:00,Sean Massa,2023-04-27 18:09:25+00:00,"Publish Stable

 - @vercel/build-utils@6.7.2
 - vercel@29.0.0
 - @vercel/client@12.4.12
 - @vercel/edge@0.3.4
 - @vercel/frameworks@1.3.5
 - @vercel/fs-detectors@3.8.12
 - @vercel/gatsby-plugin-vercel-builder@1.3.0
 - @vercel/go@2.5.1
 - @vercel/hydrogen@0.0.64
 - @vercel/next@3.7.6
 - @vercel/node@2.13.0
 - @vercel/python@3.1.60
 - @vercel/redwood@1.1.15
 - @vercel/remix-builder@1.8.6
 - @vercel/routing-utils@2.2.1
 - @vercel/ruby@1.3.76
 - @vercel/static-build@1.3.26
 - @vercel/static-config@2.0.17",2023,4
fb6fe4615850f0c75da2b672a25d68ec8283f5ed,Nathan Rajlich,2023-04-27 18:00:17+00:00,GitHub,2023-04-27 18:00:17+00:00,"[cli] Remove `--target` global common arg (#9808)

It doesn't make sense to have `--target` as a global argument, because not all subcommands utilize this flag (actually only `vc deploy` does, and it's even deprecated).

This is technically a breaking change (though risk of someone using this flag on non-`vc deploy` is very unlikely), so we may want to hold off on merging this until we're ready to do a major version bump.",2023,4
bfebfc28e1f25a18eaa8ea86f3e607daebedd768,Sean Massa,2023-04-27 15:53:04+00:00,GitHub,2023-04-27 15:53:04+00:00,"[tests] Update CODEOWNERS for `packages/node` (#9864)

Right now, @Kikobeats is a required approver on `packages/node`. This change allows them to approve changes to the package without being absolutely required.",2023,4
9e183b2e8dceec762650597882426060c1ce14ca,Chris Barber,2023-04-27 15:27:02+00:00,GitHub,2023-04-27 15:27:02+00:00,[tests] Move `allowJs: true` to test tsconfig.json (#9862),2023,4
0490a7733ba09cf21201add77ab57640787bff22,Sean Massa,2023-04-27 08:13:53+00:00,GitHub,2023-04-27 08:13:53+00:00,"[tests] install root typescript version `4.9.5` and standardize on that version (#9858)

This add a root-level `typescript` version that matches the one used throughout for VS Code (and other IDEs) to use when browsing the code. After this PR merges, you will be able to set VS Code's TypeScript version to match the project's version.

This will remove issues where the IDE says TypeScript compilation is good to go, but `pnpm build` disagrees.

If there's a better way to allow this, please suggest it!

---

To enable:

<img width=""849"" alt=""Screenshot 2023-04-25 at 4 28 22 PM"" src=""https://user-images.githubusercontent.com/41545/234408245-205b3260-7b1d-4c43-a531-d616915dbefb.png"">

Then:

<img width=""1015"" alt=""Screenshot 2023-04-25 at 4 29 20 PM"" src=""https://user-images.githubusercontent.com/41545/234408271-4e7b4ec8-0be3-4743-afd7-813a267c0756.png"">",2023,4
65a6e713c80fe55b3d66134cd9230ab0ee342e7c,Chris Barber,2023-04-26 17:23:43+00:00,GitHub,2023-04-26 17:23:43+00:00,[node] Fix ESM dependency support (#9692),2023,4
fda76691d1b2978b1d36d903b723a1c2d98cac32,Nathan Rajlich,2023-04-25 06:31:27+00:00,GitHub,2023-04-25 06:31:27+00:00,"[gatsby-plugin-vercel-builder] Log validation errors (#9854)

Log state validation errors, because they can be user error.

Example:

```
error ""gatsby-node.js"" threw an error while running the onPostBuild lifecycle:

Gatsby state validation failed:
  - Expected boolean, got string (""true"") at path ""/redirects/0/isPermanent""
Please check your Gatsby configuration files, or file an issue at https://vercel.com/help#issues

  3 |
  4 | export const onPostBuild = async ({ store }: { store: any }) => {
> 5 |   await generateVercelBuildOutputAPI3Output({
    |         ^
  6 |     // validated by `pluginOptionSchema`
  7 |     gatsbyStoreState: store.getState(),
  8 |   });
```",2023,4
007e48c1cdb2fa318343c4486adca873e286ac8b,Vercel Release Bot,2023-04-25 06:03:04+00:00,GitHub,2023-04-25 06:03:04+00:00,"[tests] Upgrade Turbo to version 1.9.3 (#9844)

This auto-generated PR updates Turbo to version 1.9.3",2023,4
954536e68126a47879845fc1acde71cdc25d40da,Nathan Rajlich,2023-04-25 03:53:42+00:00,GitHub,2023-04-25 03:53:42+00:00,"Use pnpm v8.3.1 (#9853)

Updates our usage of pnpm to version 8.3.1, and updates the lockfile to the newer version 6 format.",2023,4
c52220ab7288a79339002680df960939890daade,Nathan Rajlich,2023-04-25 03:14:40+00:00,GitHub,2023-04-25 03:14:40+00:00,"[next] Update test fixture 00-app-dir-edge to use `export const runtime` (#9855)

This test has started to fail consistently:

https://github.com/vercel/vercel/actions/runs/4792497815/jobs/8524784756",2023,4
545f82603fcbc0b933a083af7e710ad610b31bb2,Nathan Rajlich,2023-04-24 22:17:52+00:00,GitHub,2023-04-24 22:17:52+00:00,"[remix-entry-server] Delete package (#9852)

The functionality of this package has been moved to the `@vercel/remix` package, so this one is no longer necessary.",2023,4
032df14c799808885fecf66229157084b9e9572b,Vercel Release Bot,2023-04-24 16:34:13+00:00,GitHub,2023-04-24 16:34:13+00:00,"[examples] Upgrade Next.js to version 13.3.1 (#9842)

This auto-generated PR updates Next.js to version 13.3.1",2023,4
604f3b8d834efdcc6669e5f790872077d8c2773f,Micha√´l De Boey,2023-04-24 02:35:31+00:00,GitHub,2023-04-24 02:35:31+00:00,"fix(remix): update `entry.client.react.jsx` (#9845)

Bring in line with Remix defaults

https://github.com/remix-run/remix/blob/main/packages/remix-dev/config/defaults/entry.client.react-stream.tsx",2023,4
c0380cac5aa668546f2514625a00f978a7d8f995,Sean Massa,2023-04-21 16:57:19+00:00,GitHub,2023-04-21 16:57:19+00:00,[node] remove last mention of node-bridge (#9838),2023,4
7082da84511740ea0304b5f93b0073bbb3f3a9ed,Chris Barber,2023-04-20 14:19:59+00:00,Chris Barber,2023-04-20 14:19:59+00:00,"Publish Stable

 - vercel@28.20.0
 - @vercel/client@12.4.11
 - @vercel/gatsby-plugin-vercel-analytics@1.0.10
 - @vercel/gatsby-plugin-vercel-builder@1.2.10
 - @vercel/node@2.12.0
 - @vercel/static-build@1.3.25",2023,4
20a7b2f2d42a24a7fdf123c5f88291f0fc2bb63e,Chris,2023-04-20 14:07:41+00:00,GitHub,2023-04-20 14:07:41+00:00,"[all] Update naming for Next.js Analytics (#9835)

Updates the name of Next.js Analytics to Next.js Speed Insights

closes ALY-484",2023,4
a5c3cbcd4578a781fa37bb45fe22310aa47b7a78,Gary Borton,2023-04-20 13:11:17+00:00,GitHub,2023-04-20 13:11:17+00:00,"Allow passing of local git meta even with no remote. (#9824)

This enables the CLI to pass locally detected git meta data even when there is no available remote. It requires a corresponding internal change, which is blocking the e2e tests.",2023,4
6dded87426a81df6c2b6705948a28c9ca1729f1a,Kiko Beats,2023-04-19 21:56:41+00:00,GitHub,2023-04-19 21:56:41+00:00,"[node] Add streaming support for `vc dev` (#9745)

Until now, the user code response it's buffered and serialized. This is
mismatching how Vercel works these days.

This PR enables streaming response in `vc dev` for Edge/Serverless.

As part of the implementation, the `node-bridge` which spawns a process
to consume the user code is not necessary anymore.

Some necessary files (like HTTP server helpers) have been moved to live
in node builder package instead.

---------

Co-authored-by: Ethan Arrowood <ethan.arrowood@vercel.com>
Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,4
a63b9d960bec291e152308c30074843aab802c8d,Chris Barber,2023-04-19 15:14:58+00:00,Chris Barber,2023-04-19 15:14:58+00:00,"Publish Stable

 - vercel@28.19.0
 - @vercel/client@12.4.10
 - @vercel/edge@0.3.3
 - @vercel/error-utils@1.0.10
 - @vercel/fs-detectors@3.8.11
 - @vercel/gatsby-plugin-vercel-builder@1.2.9
 - @vercel/go@2.5.0
 - @vercel/hydrogen@0.0.63
 - @vercel/next@3.7.5
 - @vercel/node@2.11.0
 - @vercel/python@3.1.59
 - @vercel/remix-builder@1.8.5
 - @vercel/static-build@1.3.24
 - @vercel/static-config@2.0.16",2023,4
3cefbb19fec5d45be25b67348d38d292c5e6995e,Sean Massa,2023-04-18 20:27:01+00:00,GitHub,2023-04-18 20:27:01+00:00,"[tests] split next-local tests into chunks (#9774)

The next-local e2e tests where split between middleware (fast) and all other (slow) tests. This meant there was not a good balance of amount of time spent across these test files, making overall test run times as slow as ""all other tests"" running.

This PR rebalances the split of tests across 2 files. The new run time is ~9-10m.",2023,4
f43894ef4eeb069e33d34b01651b1cbcad8cc691,Sean Massa,2023-04-18 19:29:42+00:00,GitHub,2023-04-18 19:29:42+00:00,"[cli] refactor to use create deployment param type (#9805)

Small refactor to provide type safety to this invocation of `createDeploy`.",2023,4
2081f10b221fee2c7172ebf1e9f75c3a58de8a2e,Chris Barber,2023-04-18 16:37:09+00:00,GitHub,2023-04-18 16:37:09+00:00,"[node] Move `path-to-regexp` and `ts-morph` from dev deps to deps (#9823)

`@vercel/node` uses `ncc` to bundle the `index.js` spawns the dev server entrypoint which does not bundle the required dependencies, thus `path-to-regexp` and `ts-morph` must be moved from dev dependencies to dependencies.

Fixes #9735.",2023,4
b52df7a533160f605f5584e2e5401e3701297ade,Chris Barber,2023-04-17 15:43:05+00:00,GitHub,2023-04-17 15:43:05+00:00,"[cli] Add `vc deploy --no-wait` and `vc inspect --wait` (#9802)

There's a need to allow `vc deploy` to not block and not wait for the deployment to finish, yet return the URL.

```
$ vc deploy --no-wait
Vercel CLI 28.18.5
üîç  Inspect: https://vercel.com/chrisbarber/next13fun/L8X4oxp5LGcmy51yVptXwMK7n4wt [1s]
üìù  Note: Deployment is still processing...
‚úÖ  Production: https://next13fun-kecpx6za2-chrisbarber.vercel.app [1s]
```

Normally this deployment takes around 30 seconds, but the `--no-wait` flag causes the command to exit in less than 2 seconds.

The next step is to add the ability for `vc inspect` to wait as well as specify the maximum time to wait (defaults to 3 minutes, same as `vc rollback`).

```
$ vc inspect --wait --timeout 1m https://next13fun-kecpx6za2-chrisbarber.vercel.app
Vercel CLI 28.18.5
> Fetched deployment ""next13fun-ov2r4pvdz-chrisbarber.vercel.app"" in chrisbarber [23s]

  General

    id		dpl_9VUuV23EGeoqWf7akEeL8rP1c8cb
    name	next13fun
    status	‚óè Ready
    url		https://next13fun-ov2r4pvdz-chrisbarber.vercel.app
    created	Thu Apr 13 2023 12:25:07 GMT-0500 (Central Daylight Time) [24s ago]
<snip>
```

Also added the ability to pipe the URL into `vc inspect`:

```
echo https://next13fun-ov2r4pvdz-chrisbarber.vercel.app | vc inspect
```

Combined, it allows us to support cool things like:

```
$ vc inspect $(vc deploy --prod --no-wait) --wait
```",2023,4
ec89436417c0bead4bf750192b19e9a0137d3b83,Vercel Release Bot,2023-04-16 07:18:36+00:00,GitHub,2023-04-16 07:18:36+00:00,"[tests] Upgrade Turbo to version 1.9.1 (#9819)

This auto-generated PR updates Turbo to version 1.9.1",2023,4
993a404311965826edcf825e6e250dc1bee97fea,Nathan Rajlich,2023-04-14 21:45:35+00:00,GitHub,2023-04-14 21:45:35+00:00,"[cli] Support pnpm in `getUpdateCommand()` (#9813)

We're currently showing bad instructions when CLI was installed via pnpm:

![image](https://user-images.githubusercontent.com/71256/232131890-ecc1c2c1-ace6-48b3-bd6f-8631cf7be087.png)

This adds support for it by leveraging our existing `scanParentDirs()` logic from build-utils.",2023,4
3e7bcb2073bb7cbc423181b1b229f61c44ab3d6b,Nathan Rajlich,2023-04-14 20:35:56+00:00,GitHub,2023-04-14 20:35:56+00:00,"[cli] Remove a bunch of `isCanary` checks (#9806)

We no longer publish versions that include `-canary` in the package.json `version` field, so these are dead code. Just doing a little bit of cleanup.",2023,4
ed119d6a33c9a22906e4366f964ea68db26aa714,Ethan Arrowood,2023-04-14 18:08:12+00:00,GitHub,2023-04-14 18:08:12+00:00,"[internals] Refactor `@vercel-internals/types` enums into constants (#9789)

- Creates new internals package, `@vercel-internals/constants`
- Refactors the `enum`s from `@vercel-internals/types` into `as const` objects, and moves them to `@vercel-intenrals/constants`
- Updates all relevant code within `packages/cli`, including `@vercel-internals/types` imports to be `import type`",2023,4
2aeddde7d54780bc75ecb539c8398b7b179a4de9,Sean Massa,2023-04-13 22:19:14+00:00,GitHub,2023-04-13 22:19:14+00:00,"[tests] split python e2e tests into chunks (#9771)

Split python tests into two chunks. They take <10m each.",2023,4
a8eab6beb799a3ecde70cd310b6a3ae5e1a6de97,Dan Stowell,2023-04-13 20:47:13+00:00,GitHub,2023-04-13 20:47:13+00:00,"[tests] fetch vercel.com cert before builds and after tests (#9803)

To debug intermittent connection errors when the tests make requests to [api.vercel.com], fetch the SSL certificate before builds and after tests.",2023,4
031c18289656f4f595a7b72211f0b426613880ca,Nathan Rajlich,2023-04-13 18:36:59+00:00,GitHub,2023-04-13 18:36:59+00:00,[examples] Update Remix template to use v1.15.0 (#9788),2023,4
38eb0bca04ef57a7ff821ece03f16ed056e30881,Chris Barber,2023-04-13 17:59:47+00:00,GitHub,2023-04-13 17:59:47+00:00,"[go] Support 'go.work' file and resolve shared deps relative to work path (#9708)

This PR fixes a few issues related to `vc dev`.

1. Create a default `go.work` file in the cache dir when building the `vercel-dev-server-go` executable
2. Copy the existing `go.mod` file into the cache dir and update any ""replace"" relative paths
3. Split the ""build"" logic into separate functions for the legacy ""main"" package build and the `go.mod` build

Additionally, it fixes:

1. `vc build`: pass in `build.env` from `vercel.json`
2. Fix several tests to work with `vc dev` and `vc build`

Linear: https://linear.app/vercel/issue/VCCLI-638/vc-dev-go-builder-cant-resolve-workspace-dependencies

The user that reported the issue has tested this build and seems to fix their use case: https://github.com/vercel/vercel/issues/9393#issuecomment-1490726785.",2023,4
732ac2072cd1c09e383d7da2f671c3bb430c8a8a,Chris Barber,2023-04-12 13:38:03+00:00,GitHub,2023-04-12 13:38:03+00:00,"[tests] Update Typescript, Jest, and ts-jest (#9782)

Co-authored-by: Nathan Rajlich <n@n8.io>
Co-authored-by: Swarnava Sengupta <swarnavasengupta@gmail.com>",2023,4
64d9cef963550fe71f66cde58122902db0007f4f,Nathan Rajlich,2023-04-12 06:53:46+00:00,GitHub,2023-04-12 06:53:46+00:00,"[publish] Trigger update workflow on ""api"" repo after Publish (#9791)

So that we don't need to trigger it manually and/or wait for the cronjob.",2023,4
6b9e274bc7b01726c57b2df8e294e50a162cb447,Nathan Rajlich,2023-04-12 04:29:29+00:00,GitHub,2023-04-12 04:29:29+00:00,"[cli] Simplify `parseRepoUrl()` and fix edge case (#9796)

Fixes an edge case in `parseRepoUrl()` when there is a `.com` in the repo name. The code was hard to refactor in its previous form so I refactored it to be simpler as well.",2023,4
a2da071755d0ab21dc7cc341f77f2c3550c18465,Sean Massa,2023-04-12 00:57:07+00:00,GitHub,2023-04-12 00:57:07+00:00,"[tests] re-chunk example tests (#9792)

It turns out that these do take a long time to run when not cached. We do want these chunks.",2023,4
14ece4111aed844a92e0024c5933f41b8ae717a0,Dan Stowell,2023-04-11 21:25:20+00:00,Dan Stowell,2023-04-11 21:25:20+00:00,"Publish Stable

 - vercel@28.18.5
 - @vercel/fs-detectors@3.8.10
 - @vercel/gatsby-plugin-vercel-builder@1.2.8
 - @vercel/static-build@1.3.23",2023,4
e302631dedee9d67a64e3e51b828bc20b52dce9d,Sean Massa,2023-04-11 21:22:41+00:00,GitHub,2023-04-11 21:22:41+00:00,"[fs-detectors] check turbo versions to allow for tags like ""latest"" (#9790)

When a project depends on `turbo` at version `latest`, this code was breaking because `latest` is not a valid range for `semver.intersects`.",2023,4
43a57a3a60cc72b2311c18e8d96b0c1375adb7c9,Nathan Rajlich,2023-04-11 19:52:38+00:00,GitHub,2023-04-11 19:52:38+00:00,"[gatsby-plugin-vercel-builder] Ignore `assetPrefix` completely (#9787)

Before, we were stripping off only the hostname portion of `assetPrefix`, so any pathname was still being ""handled"" by the plugin.

Instead, we should be ignoring the `assetPrefix` entirely, so that these two configurations are treated differently:

 * `{ assetPrefix: 'http://example.com', pathPrefix: '/foo' }` - Gatsby project is served from `/foo`
 * `{ assetPrefix: 'http://example.com/foo', pathPrefix: undefined }` - Gatsby project is served from the root `/`

Currently, both configuration behave as the first version listed above. This change makes it so they can behave differently, specifically for some proxy configurations.

In both cases, the generated HTML contains the full URL `http://example.com/foo/*` for JS/CSS/etc. assets",2023,4
136077ab6f93eb138c814201b08a61b96936b1b4,Ethan Arrowood,2023-04-10 21:01:17+00:00,GitHub,2023-04-10 21:01:17+00:00,"[scripts] Create internal-dependency-trace script package (#9783)

Adds a new package under `scripts/internal-dependency-trace` that can be used to generate a rendering of any internal file dependency graph.

Default configured to generate the directed dependency graph of `packages/cli/src/index.ts`",2023,4
8634f9cd7e0c663b77f3dd02789bcba0d20baed7,Lee Robinson,2023-04-10 08:35:00+00:00,GitHub,2023-04-10 08:35:00+00:00,"[examples] Update Astro example. (#9778)

This demo now showcases:

- `/` - A static page (pre-rendered)
- `/ssr` - A page that uses server-side rendering (through Vercel Edge Functions)
- `/ssr-with-swr-caching` - Similar to the previous page, but also caches the response on the Vercel Edge Network using `cache-control` headers
- `/edge.json` - An Astro API Endpoint that returns JSON data using Vercel Edge Functions

The new example has been deployed to https://astro.vercel.app.",2023,4
dc8523998c1b6b4b9df9491f22e49432e654991b,Sean Massa,2023-04-07 23:47:27+00:00,GitHub,2023-04-07 23:47:27+00:00,"[tests] combine examples e2e into one chunk (#9772)

We don't need 5 chunks of the very fast examples tests. We spend more time in setup for each one. We are also more likely to hit the [usage limit](https://docs.github.com/en/actions/learn-github-actions/usage-limits-billing-and-administration#usage-limits) with these.

This PR combines them into one test suite.",2023,4
925c8ba18ceec80174d9440cd2cad0e725ed4f56,Sean Massa,2023-04-07 21:43:42+00:00,Sean Massa,2023-04-07 21:43:42+00:00,"Publish Stable

 - @vercel/build-utils@6.7.1
 - vercel@28.18.4
 - @vercel/client@12.4.9
 - @vercel/edge@0.3.2
 - @vercel/error-utils@1.0.9
 - @vercel/frameworks@1.3.4
 - @vercel/fs-detectors@3.8.9
 - @vercel/gatsby-plugin-vercel-analytics@1.0.9
 - @vercel/gatsby-plugin-vercel-builder@1.2.7
 - @vercel/go@2.4.4
 - @vercel/hydrogen@0.0.62
 - @vercel/next@3.7.4
 - @vercel/node-bridge@4.0.1
 - @vercel/node@2.10.3
 - @vercel/python@3.1.58
 - @vercel/redwood@1.1.14
 - @vercel/remix-entry-server@0.1.1
 - @vercel/remix-builder@1.8.4
 - @vercel/routing-utils@2.2.0
 - @vercel/ruby@1.3.75
 - @vercel/static-build@1.3.22
 - @vercel/static-config@2.0.15",2023,4
19804b78a9d0335e8b9807317bc0c6c4b614725d,Sean Massa,2023-04-07 21:24:40+00:00,GitHub,2023-04-07 21:24:40+00:00,"[routing-utils] add `isInternal` flag (#9761)

Adds a new Route property called `isInternal` that indicates whether or not this is a project route or a Vercel platform route. Routes with this flag will be hidden from project-specific lists of routes to avoid confusion.

Verified on staging.",2023,4
f774d5f7a2c72e4b6c8fade5d28d939ab9a63135,Sean Massa,2023-04-07 20:42:36+00:00,GitHub,2023-04-07 20:42:36+00:00,"[next] use ""Page"" instead of ""SSR"" for `operationType` (#9770)

Update the `operationType` from ""SSR"" to ""Page"" for display in build outputs.",2023,4
9bf8a6868531f83731187faf0f93a6c6bdc2563d,JJ Kasper,2023-04-07 20:01:48+00:00,GitHub,2023-04-07 20:01:48+00:00,[next] Update allowQuery test case (#9767),2023,4
294935a9c5e9c8c625290eed840413707ed49788,Nathan Rajlich,2023-04-07 02:10:51+00:00,GitHub,2023-04-07 02:10:51+00:00,"[static-build] Remove Gatsby env var check (#9766)

This feature flag has been fully rolled out for a while now. Removing it makes the plugin work with `vc build` when running locally.",2023,4
778c2879640d81b2e87b684a75cc5b998f8c0b2e,Vercel Release Bot,2023-04-07 01:36:55+00:00,GitHub,2023-04-07 01:36:55+00:00,"[examples] Upgrade Next.js to version 13.3.0 (#9765)

This auto-generated PR updates Next.js to version 13.3.0",2023,4
7a9a51951783e67b77ce98413dcb6a0efa10502e,JJ Kasper,2023-04-07 00:04:58+00:00,GitHub,2023-04-07 00:04:58+00:00,"[next] Fix edge runtime for route groups (#9764)

This ensures we use the correct short name when generating edge
functions with route groups from app directory.

Example deployment with fix can be seen here
https://next-debug-edge-runtime-1ar7agbjh-vtest314-ijjk-testing.vercel.app/group-no-layout

Fixes: https://github.com/vercel/next.js/issues/43458",2023,4
52b2892b8015fe150659752104d19d3316b9446b,Espen Hovlandsdal,2023-04-06 23:18:07+00:00,GitHub,2023-04-06 23:18:07+00:00,"[build-utils][cli][fs-detectors] Upgrade minimatch to 3.1.2 (#9762)

Minimatch 3.0.4 has a [ReDoS
vulnerability](https://security.snyk.io/vuln/SNYK-JS-MINIMATCH-3050818).
While not likely to be an issue for the packages that use it here, a
simple version bump should prevent the issue and reduce vulnerability
noise on audits. 3.1.2 is the latest version within the 3.x range, so
prevents breaking changes.",2023,4
ee4ba6ccbeea068f6469635cfcbdb6e6e82ad3d8,Nathan Rajlich,2023-04-06 22:33:55+00:00,GitHub,2023-04-06 22:33:55+00:00,"[all] Use correct ""license"" field in `package.json` (#9754)

Follow-up to #9696. Ensures that all packages in this repository have
the correct ""license"" field in their respective `package.json` files set
to ""Apache-2.0"", to match the `LICENSE` file at the root of the
repository.

The `LICENSE` file the authoritative source, so the ""MIT"" value was
incorrect. This change corrects the previous values and is not
considered a relicensing.",2023,4
07a09b7880014fd6348dd96e8f71d40a151d52e0,Ethan Arrowood,2023-04-06 18:18:04+00:00,GitHub,2023-04-06 18:18:04+00:00,"[cli] refactor pkg.ts into `@vercel-internals/get-package-json` (#9719)

Extracts the logic from `pkg.ts` into a new utility function
`getPackageJSON` from `@vercel-internals/utils`.

---------

Co-authored-by: Nathan Rajlich <n@n8.io>",2023,4
b62c40586a899e48d8b163f45fff25e12b2b7b6e,JJ Kasper,2023-04-06 17:37:24+00:00,GitHub,2023-04-06 17:37:24+00:00,"[next] Update allowQuery test (#9758)

These values are now expected to be prefixed so we can isolate them from normal query params. 

x-ref: https://github.com/vercel/vercel/actions/runs/4624385719/jobs/8179201620?pr=9719#step:8:2982",2023,4
d07eb34e38a23d76938af20fbcfedd1842c5df29,Vercel Release Bot,2023-04-06 16:14:07+00:00,GitHub,2023-04-06 16:14:07+00:00,"[tests] Update Gatsby fixture versions (#9760)

Automatically generated PR to update Gatsby fixture versions in `@vercel/static-build`",2023,4
46d0503361a28cba7b09cc1a6dc843d6014d1265,Ethan Arrowood,2023-04-06 15:56:04+00:00,GitHub,2023-04-06 15:56:04+00:00,"Fix update gatsby fixture cron job (#9725)

This PR fixes the gatsby fixture update script to correctly create pull
requests after it updates the fixtures.",2023,4
349df907a84022ccd7b72f10bb7cf0d9cb711dca,Steven,2023-04-06 01:10:00+00:00,GitHub,2023-04-06 01:10:00+00:00,"[tests] Skip broken test temporarily (#9753)

Currently, `next@canary` is broken so we should temporarily skip this
test until it can be fixed


https://github.com/vercel/vercel/actions/runs/4622527617/jobs/8176298610?pr=9719#step:8:1695

---------

Co-authored-by: kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>
Co-authored-by: Ethan Arrowood <ethan.arrowood@vercel.com>",2023,4
e5f5ba0ae8281b2b7a5e971a230d6f4dd1287f3c,Espen Hovlandsdal,2023-04-05 22:04:27+00:00,GitHub,2023-04-05 22:04:27+00:00,"[frameworks][fs-detectors] Use correct ""license"" field in `package.json` (#9696)

Makes the ""license"" field in these two packages' `package.json` files
be consistent with the LICENSE file in the root of the repository.",2023,4
b2ccbf4881e52081d8a612e7ea4ff5e4d5e92449,Steven,2023-04-05 15:17:57+00:00,GitHub,2023-04-05 15:17:57+00:00,"[tests] update pnpm version to 7.31.0 (#9751)

- Closes #9750",2023,4
434c794713608a03fa9e05b489da9eb0d9e2604d,Kiko Beats,2023-04-04 16:49:41+00:00,GitHub,2023-04-04 16:49:41+00:00,"[tests] move test files to subdirectory (#9749)

Some unit tests didn't run since Aug 2022 because they are not included as part of the testing command.

This PR introduce `unit` and `integration` folders for testing, so anything that it's placed there will be run as part of the testing command.",2023,4
d8f5052d9a93646b88770e5336e2b497a1a44623,Vercel Release Bot,2023-03-31 21:49:36+00:00,GitHub,2023-03-31 21:49:36+00:00,"[remix] Upgrade @remix-run/dev to version 1.15.0 (#9740)

This auto-generated PR updates @remix-run/dev to version 1.15.0",2023,3
10d14488db21fe5c6ee4aa52b495663ed7027e1c,Nathan Hammond,2023-03-31 21:02:30+00:00,GitHub,2023-03-31 21:02:30+00:00,"[fs-detectors] Fix turbo@1.8 all filters are inferred (#9680)

We no longer need to specify the active folder for `turbo` to identify the context correctly.",2023,3
c29f2b2fbd5e36cc8395b81fed59fffe9803e886,Sean Massa,2023-03-31 20:04:02+00:00,GitHub,2023-03-31 20:04:02+00:00,"[tests] update typescript version used in next fixtures (#9739)

Updates the typescript version in next fixtures to accommodate newer syntax used in types for `next@canary`.",2023,3
46348201b4eadb03b403f99dc5574c31d2b3926e,Nathan Rajlich,2023-03-29 19:25:26+00:00,Nathan Rajlich,2023-03-29 19:25:26+00:00,"Publish Stable

 - @vercel/build-utils@6.7.0
 - vercel@28.18.3
 - @vercel/client@12.4.8
 - @vercel/fs-detectors@3.8.8
 - @vercel/gatsby-plugin-vercel-builder@1.2.6
 - @vercel/go@2.4.3
 - @vercel/hydrogen@0.0.61
 - @vercel/next@3.7.3
 - @vercel/node@2.10.2
 - @vercel/python@3.1.57
 - @vercel/redwood@1.1.13
 - @vercel/remix-builder@1.8.3
 - @vercel/ruby@1.3.74
 - @vercel/static-build@1.3.21",2023,3
509926545eea1c7ddde4484e7b75c03560efb74e,Nathan Rajlich,2023-03-29 19:11:09+00:00,GitHub,2023-03-29 19:11:09+00:00,[build-utils] Rename Lambda `experimentalResponseStreaming` prop to `supportsResponseStreaming` (#9721),2023,3
70c8b32cf0ca2ad52a2a342ab4d7e70bb868af28,Sean Massa,2023-03-29 07:44:42+00:00,GitHub,2023-03-29 07:44:42+00:00,"[tests] Split CLI integration tests into chunks (#9688)

Welcome to the grand splitting of CLI integration tests:

- replaced `test-cli` test suite with `test-e2e`
- made some small fixes along the way
- split integration tests into 3 files
- moved shared logic to `packages/cli/test/helpers/*`
- simplified `_execa` / `execa` / `execute` usage into `execCli` and `exec`
    - simplified arguments required to make these work
- defaulted `execCLI` to set `NO_COLOR=1` to make assertions simpler in tests that aren't testing color/emoji support
- expanded functionality of `formatOutput` to handle error states
- centralized temp dir handling and cleanup
- enhanced `waitForPrompt` to:
    - more clearly show what it was waiting for
    - support waiting for regex, string, or a function that returns a boolean
    - show what was the most recent thing it saw
    - end early if the process it's monitoring exits
- removed some test pollution where unnecessary, shifted some into `beforeAll`
- renamed unit tests helper from `setupFixture` to `setupUnitFixture` to avoid confusion with the new shared helper `setupE2EFixture`


Some of this could be pulled out into a separate PR, but the feedback cycle is a slog, which this PR is helping to address. I'd be happy to discuss what could be pulled out, but I'd also be happy to get the whole thing through.

---

Wait for prompt failures:

<img width=""939"" alt=""CleanShot 2023-03-27 at 10 24 21@2x"" src=""https://user-images.githubusercontent.com/41545/227987773-a3582549-32f9-4131-8a35-7be7cc265b66.png"">

---

Current Timing:

```
Tests / test-e2e (vercel, 1, ubuntu-latest) (pull_request) Successful in 3m
Tests / test-e2e (vercel, 2, ubuntu-latest) (pull_request) Successful in 8m
Tests / test-e2e (vercel, 3, ubuntu-latest) (pull_request) Successful in 8m
```

---

Before merge, I'll mark the original `CLI` integration test suite as no longer required.",2023,3
54514a44afef48726220bc8be8d20f4fda8e8b4f,Sean Massa,2023-03-28 03:25:08+00:00,Sean Massa,2023-03-28 03:25:08+00:00,"Publish Stable

 - @vercel/build-utils@6.6.0
 - vercel@28.18.2
 - @vercel/client@12.4.7
 - @vercel/fs-detectors@3.8.7
 - @vercel/gatsby-plugin-vercel-builder@1.2.5
 - @vercel/go@2.4.2
 - @vercel/hydrogen@0.0.60
 - @vercel/next@3.7.2
 - @vercel/node-bridge@4.0.0
 - @vercel/node@2.10.1
 - @vercel/python@3.1.56
 - @vercel/redwood@1.1.12
 - @vercel/remix-builder@1.8.2
 - @vercel/ruby@1.3.73
 - @vercel/static-build@1.3.20",2023,3
0db8fadf7411c748740689c23a5145e1901b831a,Ethan Arrowood,2023-03-27 23:07:39+00:00,GitHub,2023-03-27 23:07:39+00:00,"[build-utils] add pnpm v8 auto detection (#9720)

Adds automatic detection for pnpm v8 based on lockfile v6",2023,3
6f01e5ab757535e1c18198fdca10f5f681959a36,Sean Massa,2023-03-27 15:18:16+00:00,GitHub,2023-03-27 15:18:16+00:00,"[cli] support `build -y` shorthand (#9717)

The `build` command wasn't supporting the `-y` shorthand for `--yes`. Now it does.

I looked at the other uses and they all seem fine.",2023,3
78d45f9e7e96c1acf9d15bf3380cb862b3bd5f53,Kiko Beats,2023-03-26 08:34:12+00:00,GitHub,2023-03-26 08:34:12+00:00,"[node-bridge] add feature flags support (#9713)

This PR allows executing conditional logic based in feature flags.

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,3
22e1a6a9ce193373dbfe3a08d5385b6ec73a1b45,Kiko Beats,2023-03-24 19:12:36+00:00,GitHub,2023-03-24 19:12:36+00:00,"[node-bridge]: remove API Gateway normalization (#9711)

We no longer use since a long time ago",2023,3
8391734b5ef1c8a98afcf2db94ea3eb6955b52e5,Steven,2023-03-24 05:45:27+00:00,GitHub,2023-03-24 05:45:27+00:00,"[build-utils] Fix system env var detection for prefixed env vars (#9709)

This PR fixes a bug that was causing too many env vars to be exposed to the frontend by adding the framework `envPrefix`.

Some frameworks, such as CRA, will include all of these in the frontend even if not explicitly used so we must only prefix known [System Environment Variables](https://vercel.com/docs/concepts/projects/environment-variables/system-environment-variables).

This PR adds an allowlist to ensure this is handle properly.

- Fixes https://linear.app/vercel/issue/VCCLI-639",2023,3
6a7fa1526c6652c24350ef4797664a945775cf52,Sean Massa,2023-03-23 19:45:33+00:00,Sean Massa,2023-03-23 19:45:33+00:00,"Publish Stable

 - vercel@28.18.1
 - @vercel/gatsby-plugin-vercel-builder@1.2.4
 - @vercel/next@3.7.1
 - @vercel/node@2.10.0
 - @vercel/remix-builder@1.8.1
 - @vercel/static-build@1.3.19",2023,3
64b15d2409bb05cba1021a65ce0f8457550b7c11,Nathan Rajlich,2023-03-23 19:35:46+00:00,GitHub,2023-03-23 19:35:46+00:00,"[remix] Fix zero matching on sub catch-all routes (#9707)

Fixes https://github.com/vercel/remix/issues/20.",2023,3
40f73e7978efe63100afc1c3f395e6ad2a3a2328,Gal Schlezinger,2023-03-23 17:48:49+00:00,GitHub,2023-03-23 17:48:49+00:00,"[node] support node:[lib] in vc dev (#9694)

- [node] add edge-node-compat-plugin
- [node] implement edge-handler",2023,3
4c9ca27195815e9749151fe552e6d75fbeb2ec15,Nathan Rajlich,2023-03-23 15:35:05+00:00,GitHub,2023-03-23 15:35:05+00:00,"[examples] Remove `entry.server.tsx` file from ""remix"" template (#9698)

This file is now optional, and a default implementation is used when the
file does not exist.",2023,3
a847ef43fda6036d2089271f75824c08eefcf1e7,Steven,2023-03-23 15:34:46+00:00,GitHub,2023-03-23 15:34:46+00:00,"[tests] Try publishing with provenance (#9706)

This is a follow up to #9583 since it didn't work as expected.",2023,3
3b466232a9db629347795ec8d961dd5179a4deb5,JJ Kasper,2023-03-22 21:36:40+00:00,GitHub,2023-03-22 21:36:40+00:00,"[next] Remove extra env variables (#9704)

These env variables were temporarily added to bust turbo/nx cache although this should no longer be needed as a proper fix has been landed in Next.js itself. 

x-ref: [slack thread](https://vercel.slack.com/archives/C04Q0GWSB8W/p1679518040946589)",2023,3
efdeea9db221d866b07e81b7cc27421d6292cd88,Chris Barber,2023-03-22 19:39:36+00:00,GitHub,2023-03-22 19:39:36+00:00,"[tests] Disable Turbo's update notifier (#9302)

Since switching to the canary releases of Turbo, we are seeing the
update notification often. We have a cron job
(https://github.com/vercel/vercel/pull/9301) that will keep this
up-to-date for us, so we don't need to have Turbo notify us of updates.

<img width=""587"" alt=""image""
src=""https://user-images.githubusercontent.com/97262/214372374-a2682014-2deb-4942-b694-fd140c26a6ef.png"">",2023,3
ab9915af32e54338845f6ff32340dd0189474c55,Sean Massa,2023-03-22 17:37:51+00:00,Sean Massa,2023-03-22 17:37:51+00:00,"Publish Stable

 - @vercel/build-utils@6.5.0
 - vercel@28.18.0
 - @vercel/client@12.4.6
 - @vercel/fs-detectors@3.8.6
 - @vercel/gatsby-plugin-vercel-builder@1.2.3
 - @vercel/go@2.4.1
 - @vercel/hydrogen@0.0.59
 - @vercel/next@3.7.0
 - @vercel/node@2.9.14
 - @vercel/python@3.1.55
 - @vercel/redwood@1.1.11
 - @vercel/remix-builder@1.8.0
 - @vercel/ruby@1.3.72
 - @vercel/static-build@1.3.18",2023,3
d6dc27638c44f7676c50fae2a71c4c361beff372,Chris Barber,2023-03-22 17:16:44+00:00,GitHub,2023-03-22 17:16:44+00:00,"[build-utils][next] Add prerender source path (#9686)

Adds the `sourcePath` for ISR prerender lambdas so that the front end can associate derived pages with the source route.

There's an accompanying `api` PR (https://github.com/vercel/api/pull/17940) which uses this deployment's tarballs to test the functionality. Here's the result:

![image](https://user-images.githubusercontent.com/97262/226947180-a8e6b75e-f6a5-44fa-8034-08bd24569f3f.png)

Linear: https://linear.app/vercel/issue/VCCLI-410/communicate-how-functions-are-bundled",2023,3
0fb0601d1942c520f1291bb3421f28367ad1f8a1,Sean Massa,2023-03-22 16:31:44+00:00,GitHub,2023-03-22 16:31:44+00:00,[node] Improve edge-handler-template error handling (#9697),2023,3
ce25dec97d6dda8f16030bb8bca8be9af9a9b3e9,Nathan Rajlich,2023-03-22 01:06:14+00:00,GitHub,2023-03-22 01:06:14+00:00,"[remix] Inject `@vercel/remix` package instead of `@vercel/remix-entry-server` (#9684)

The `handleRequest()` function has been moved to the `@vercel/remix` package, so we can deprecate `@vercel/remix-entry-server` entirely and install `@vercel/remix` in the project instead, when there is no `app/entry.server.tsx` file defined in the project already.",2023,3
20bd71ce70aee9e8aa969ea19ef9e9d2a70aaa3d,Nathan Rajlich,2023-03-21 23:59:49+00:00,GitHub,2023-03-21 23:59:49+00:00,"[node][remix] Update nft conditions to include ""edge-light"" for Edge Functions (#9700)",2023,3
4c77dab5cb480ff2e40b1003e8446b171a15f30a,Sean Massa,2023-03-18 18:21:45+00:00,GitHub,2023-03-18 18:21:45+00:00,"[tests][cli] convert CLI integration tests to TS (#9672)

Converts the CLI integration tests to TypeScript. This will make it easier to pick apart the test pollution.",2023,3
151b0dfb636e9fefdea231e2ff357ba2b6ec4863,Sean Massa,2023-03-17 22:12:23+00:00,GitHub,2023-03-17 22:12:23+00:00,"[cli] handle `BUILD_UTILS_SPAWN_*` errors (#9689)

Some condition in the system caused `BUILD_UTILS_SPAWN_1` errors to be thrown for failed deployments. The error handling logic wasn't handling this properly, causing the error message to never show up in the output.

```
Error: Unexpected error. Please try again later. ()
```",2023,3
42e9bbea5bd25a170bf95f56f8d12e81578d94af,Nathan Rajlich,2023-03-17 21:47:05+00:00,GitHub,2023-03-17 21:47:05+00:00,"[examples] Update ""remix"" template to use `@vercel/remix` package (#9683)",2023,3
c0471302e968efc8e0a7d810e8b5871fb342ef9d,Steven,2023-03-16 23:57:33+00:00,GitHub,2023-03-16 23:57:33+00:00,"[cli] Ignore `vc build` subdirectory warning on vercel (#9685)

This warning is only relevant when running `vc build` locally so we can hide it for Vercel deployments.

I noticed this in the build logs here:

<img width=""862"" alt=""image"" src=""https://user-images.githubusercontent.com/229881/225774670-9b4aecf5-d020-489f-819f-7b55ce96f877.png"">",2023,3
b2c68f1301b6a5eb41b6261b7faac6a8fa4c53eb,Nathan Rajlich,2023-03-16 19:23:51+00:00,Nathan Rajlich,2023-03-16 19:23:51+00:00,"Publish Stable

 - @vercel/build-utils@6.4.0
 - vercel@28.17.0
 - @vercel/client@12.4.5
 - @vercel/frameworks@1.3.3
 - @vercel/fs-detectors@3.8.5
 - @vercel/gatsby-plugin-vercel-builder@1.2.2
 - @vercel/go@2.4.0
 - @vercel/hydrogen@0.0.58
 - @vercel/next@3.6.7
 - @vercel/node@2.9.13
 - @vercel/python@3.1.54
 - @vercel/redwood@1.1.10
 - @vercel/remix-builder@1.7.0
 - @vercel/routing-utils@2.1.11
 - @vercel/ruby@1.3.71
 - @vercel/static-build@1.3.17
 - @vercel/static-config@2.0.14",2023,3
9712640fe39d7d72e1bd10ec73291015ca97a15d,Vedant,2023-03-16 19:11:49+00:00,GitHub,2023-03-16 19:11:49+00:00,"[go] Add support for Go 1.20 (#9367)

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,3
0dd3711f63f5d25e8914c823e18f7a3428ec72b5,Chris Barber,2023-03-16 19:05:09+00:00,GitHub,2023-03-16 19:05:09+00:00,"[go] Go builder improvements (#9576)

This PR fixes a handful of Go builder issues all related to the selected Golang version being used to build the function:

- `go.mod` version ignored for `vc build` and `vc dev`, uses system `PATH` version only
- `vc dev` fails if `go.mod` does not exist
- If the analyze bin doesn‚Äôt exist, downloads golang into `.vercel/cache/golang` instead of a global shared dir
- When running `vc dev`, doesn‚Äôt reuse go build code/common settings
- go tidy fails when `go.mod` set to 1.19 or 1.20, but 1.18 or older is installed
- `vc build` builds wrong arch on Apple Silicon/arm64
- `vc build` on Windows doesn't properly resolve ""builds"" in `vercel.json` due to posix separator issue
- `vc build` on Windows fails with `package <pkg/name> is not in GOROOT` due to posix separator issue
- Removed `actions/setup-go` from all test workflows

I added a test that tests the `go tidy` issue.",2023,3
4b657debed28e32143a5c386b06b8acf27705615,Chris Barber,2023-03-16 18:31:43+00:00,GitHub,2023-03-16 18:31:43+00:00,"[cli] Honor `--local-config` when present during `vc build` (#9675)

As reported https://github.com/vercel/vercel/discussions/9648, `vc build` does not honor the `--local-config <file>` option.

`vc build` will only load the `vercel.json` (or `now.json`) in the `workPath` which is based on the `rootDirctory`.

If `--local-config` is specified in the command line arguments, then it should take precedence.",2023,3
ffdca76155a62a8832887d1e30d9ece58a87c616,Sean Massa,2023-03-16 18:00:56+00:00,GitHub,2023-03-16 18:00:56+00:00,"[gatsby-plugin-vercel-builder] link instead of move (#9673)

When creating the `./vercel/output/static` dir...

**Moving the `public` dir** is what currently happens. This causes Gatsby to believe that the build was not complete:

> info We've detected that the Gatsby cache is incomplete (the .cache directory exists but the public directory does not). As a precaution, we're deleting your site's cache to ensure there's no stale data.

**Copying the `public` dir** is not an option because it can cause a build to run out of space.

**Symlinking the `public` dir** would work, but it would require more changes throughout the system to make sure the symlink was followed properly.

**Hard Linking the `public` dir's files** is the best option. This PR links the directories instead of moving them. We did look for a library that already does the `hardlinkFileTree` thing, but couldn't find one.

---

**Testing**

This was manually tested with real deployments.

---

* paired with @TooTallNate 
* [user report](https://github.com/vercel/vercel/issues/9452#issuecomment-1432858615)",2023,3
af7b34aa45e04021c757bd71e1f67b59d2b687b6,Vladislav Ponomarev,2023-03-16 16:01:07+00:00,GitHub,2023-03-16 16:01:07+00:00,"[node] Handle multi-protocol in Edge Functions (#9502)

Co-authored-by: Chris Barber <chris.barber@vercel.com>
Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>
fix #9501",2023,3
e210977a9c05aca571ae4b4fadb1511427226fbc,Sean Massa,2023-03-16 14:41:40+00:00,GitHub,2023-03-16 14:41:40+00:00,"[tests] update python tests to use zero config (#9668)

This PR is some cleanup before splitting python e2e tests.

Changes:

- use `probes.json`
- use `/api` autodetection instead of `builds` array

---

I was also trying to figure out why these tests are so much faster when run locally (293s) vs. CI (1099s). I encountered issues trying to view the build logs for the deployments that are made.",2023,3
1c2ef371735cd922de150245b602cf07a0db2cff,Nathan Rajlich,2023-03-16 09:47:13+00:00,GitHub,2023-03-16 09:47:13+00:00,"[remix] Remove symlink creation warning (#9679)

We're now going to encourage users to use `@vercel/remix` instead of `@remix-run/node`. So switch the symlink warning to a `debug()` call instead.",2023,3
65bbcd3e6282300a261927e98a5380f326a1986c,matamatanot,2023-03-15 00:52:04+00:00,GitHub,2023-03-15 00:52:04+00:00,"[Astro example] Replace npm with pnpm (#9662)

Based on lockfile and `.npmrc`, pnpm seems to be correct.",2023,3
5caf73380d2120e151772299296c76970930a8ef,Vercel Release Bot,2023-03-15 00:32:54+00:00,GitHub,2023-03-15 00:32:54+00:00,"[remix] Upgrade @remix-run/dev to version 1.14.2 (#9676)

This auto-generated PR updates @remix-run/dev to version 1.14.2",2023,3
395929b36a9a68f8b774c3e1a82e0ad8d5cbf37a,Sean Massa,2023-03-14 16:18:56+00:00,GitHub,2023-03-14 16:18:56+00:00,"[tests] remove comment (#9671)

We don't need this comment.",2023,3
0e235a926a067d697879be322b5629b446e0e2c1,Sean Massa,2023-03-14 15:48:27+00:00,GitHub,2023-03-14 15:48:27+00:00,"[tests][cli] CLI Integration tests - better failure messages (#9667)

Co-authored-by: Steven <steven@ceriously.com>",2023,3
f1bdc0bfd105f616776e2b69dabb6bd7ee63bd06,Nathan Rajlich,2023-03-13 22:10:52+00:00,GitHub,2023-03-13 22:10:52+00:00,"[remix] Rename `@vercel/remix` to `@vercel/remix-builder` (#9665)

We're changing the name of the Remix Builder to free up the name `@vercel/remix` for user-facing usage within Remix applications.",2023,3
59ca86365cc6100de3465ee7adc9fc8cd468865a,Amy,2023-03-13 21:27:50+00:00,GitHub,2023-03-13 21:27:50+00:00,"[docs] Update issue and discussion templates (#9666)

Updates the existing [issue
template](https://github.com/vercel/vercel/issues/new/choose) and adds
[new discussion
forms](https://docs.github.com/en/discussions/managing-discussions-for-your-community/syntax-for-discussion-category-forms)
to direct Vercel platform questions to
https://github.com/vercel/community/discussions

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,3
13d54b2095382daf74188220875f523183c09be5,Nathan Rajlich,2023-03-13 20:47:56+00:00,GitHub,2023-03-13 20:47:56+00:00,"[remix] Support optional `entry.{server,client}.tsx` file (#9620)

Remix v1.14.0 added support for having no `app/entry.server.tsx`/`app/entry.client.tsx` files in a project (there are default versions bundled into `@remix-run/dev`). Projects configured like this are currently failing because we symlink our forked version of the `remix` CLI into the project, so it cannot resolve the necessary modules at build time.

To solve this, instead of relying on the default versions of these files in `@remix-run/dev` package, we'll include our own versions in `@vercel/remix`, and physically copy them into the project dir. This way, the modules used will be properly resolved relative to the project's own `node_modules` dir.

Our default version of `app/entry.server.tsx` is also slightly different then upstream one, because it uses `@vercel/remix-entry-server` to enable isomorphic React streaming on both Node + Edge runtimes. Because of this, if that dependency is not present, then we'll automatically install the dependency at build-time.",2023,3
bada86b8d69a2e8d8fe4a90d16d0ab2252b7212b,Steven,2023-03-13 19:55:59+00:00,GitHub,2023-03-13 19:55:59+00:00,"[tests] Add prettier check (#9664)

This PR fixes the formatting on several files that were never run through `prettier`.

It also makes sure to run `prettier` in CI to to [fail fast](https://github.com/vercel/vercel/actions/runs/4408442998/jobs/7723453978) when the incorrect formatting is attempted.",2023,3
7ec377757d14ccb3252e430d139f0b3fcd477670,Ethan Arrowood,2023-03-10 19:23:38+00:00,GitHub,2023-03-10 19:23:38+00:00,"[cli] update monorepo default setting log (#9654)

Updates the `setMonorepoDefaultSetting` log",2023,3
8040c8806b1e468a72dbf3c841266a06c02eef2a,Vercel Release Bot,2023-03-10 16:34:54+00:00,GitHub,2023-03-10 16:34:54+00:00,"[examples] Upgrade Next.js to version 13.2.4 (#9647)

This auto-generated PR updates Next.js to version 13.2.4",2023,3
2b1c8d89d41c15625f33bfe40699be6289949d9a,Chris Barber,2023-03-10 15:55:13+00:00,GitHub,2023-03-10 15:55:13+00:00,"[docs] Add more info about prepareCache (#9644)

I felt the `prepareCache()` docs could use an additional note and example.",2023,3
c5e9ccfacf2b9fcd82686550813171d4ed36f6c0,Sean Massa,2023-03-10 00:34:03+00:00,GitHub,2023-03-10 00:34:03+00:00,"[tests] convert CLI Integration tests from ava to jest (#9632)

Co-authored-by: Steven <steven@ceriously.com>",2023,3
66fe3db888ff1d736023ce7cb70e8cdd7ff69ed3,Sean Massa,2023-03-08 22:56:51+00:00,GitHub,2023-03-08 22:56:51+00:00,"[tests] add tests to edge handler template (#9528)

The Edge Handler wrapping logic we add during `vc dev` was not testable. This PR refactors it to be testable and adds some basic tests.",2023,3
765ec05cea66fac9cf8c42d01915f90a4aaea17d,Steven,2023-03-08 20:50:45+00:00,GitHub,2023-03-08 20:50:45+00:00,"[next] Fix `i18n` for `app` dir and sublocales (#9623)

- Applies this fix again #9582
- Applies a test for https://github.com/orgs/vercel/discussions/1714",2023,3
413706d72aed50a5e16ddb3f899bbc1aa0e6a25d,Chris Barber,2023-03-08 18:44:13+00:00,GitHub,2023-03-08 18:44:13+00:00,"[tests] Bump test timeouts for slow tests (#9631)

This PR address the following slow tests:

* https://linear.app/vercel/issue/VCCLI-560/flakey-test-login-with-no-color
* https://linear.app/vercel/issue/VCCLI-561/flakey-test-[vercel-dev]-04-create-react-app
* https://linear.app/vercel/issue/VCCLI-563/flakey-test-build-‚Ä∫-should-build-with-vercelnode
* https://linear.app/vercel/issue/VCCLI-574/flakey-test-build-output-api-v1-should-detect-the-output-format
* https://linear.app/vercel/issue/VCCLI-578/flakey-test-importbuilders-‚Ä∫-should-install-and-import-1st-party
* https://linear.app/vercel/issue/VCCLI-580/flakey-test-creategitmeta-‚Ä∫-detects-dirty-commit",2023,3
9bc8817f920fabb24527604c13c6c61e82586cd0,Sean Massa,2023-03-08 16:42:11+00:00,GitHub,2023-03-08 16:42:11+00:00,"[tests] remove eslint from fixture (#9629)

In a previous PR https://github.com/vercel/vercel/pull/9622/files#diff-508a8f08333e1f42e2b2f02e99081c181802b6b2e7baa4e75c18e51e1e703ce4, this fixture was added which contained an eslint config file. We do have these fixtures eslint ignored, but it seems the presence of this config file re-enables it. This causes eslint failures inside the fixture to bubble up and fail lint checks.

This PR removes eslint from the fixture.",2023,3
9da41dcafa6b94218b01cde5743cac80d36f5ffc,Steven,2023-03-08 15:17:44+00:00,GitHub,2023-03-08 15:17:44+00:00,"[tests] Change test-unit to test-lint (#9627)

In a previous PR (#9615) the unit tests were moved to separate jobs in
the `test.yml` workflow. So we can now change the `test-unit.yml`
workflow to simply be `test-lint.yml` to avoid redundancy.

I also checked to see if this would affect code coverage but it turns
out codecov was [disabled a long time
ago](https://app.codecov.io/gh/vercel/vercel).",2023,3
f1ab5704f1f9c67820442f8987cf69b163514e7c,Steven,2023-03-08 15:04:33+00:00,GitHub,2023-03-08 15:04:33+00:00,"[cli] Fix example list api to exclude `node_modules` (#9626)

<img width=""219"" alt=""image""
src=""https://user-images.githubusercontent.com/229881/223744886-e4bf430d-078c-49c4-81c3-0c30dce08f2e.png"">",2023,3
d8cf3e8831c2f79a84488db22a331cb4e33a7803,Nathan Rajlich,2023-03-08 06:58:18+00:00,GitHub,2023-03-08 06:58:18+00:00,"[remix] Add turborepo monorepo E2E test (#9622)

Adds a Remix E2E test with a Turborepo monorepo configuration.",2023,3
c06209901c504ee4033233259beff751f996ed42,Steven,2023-03-07 23:50:21+00:00,GitHub,2023-03-07 23:50:21+00:00,"[tests] Run unit tests concurrently in chunks (#9615)

We can separate each package `test-unit` into a separate job. This will help isolate problems and we can re-run CI for a specific package.",2023,3
f20756344e000ddd2fd50ddbf1e21478536d1d68,Ethan Arrowood,2023-03-07 21:52:01+00:00,GitHub,2023-03-07 21:52:01+00:00,"[internals] Initialize @vercel-internals/utils and create @vercel-internals/tsconfig (#9618)

- Creates `@vercel-internals/tsconfig`
- Changes `@vercel-internals/types` to depend on `@vercel-intenrals/tsconfig`
- Creates `@vercel-internals/utils`

Moving these to another PR:
- ~Moves all top level util files from `@vercel/cli` to `@vercel-internals/utils`~
- ~Updates all relevant imports within `@vercel/cli` to use `@vercel-internals/utils`~",2023,3
21a440b83262760ccae70f5c58dc73b3718182a5,Steven,2023-03-07 18:56:14+00:00,Steven,2023-03-07 18:56:14+00:00,"Publish Stable

 - @vercel/build-utils@6.3.4
 - vercel@28.16.15
 - @vercel/client@12.4.4
 - @vercel/fs-detectors@3.8.4
 - @vercel/gatsby-plugin-vercel-builder@1.2.1
 - @vercel/go@2.3.11
 - @vercel/hydrogen@0.0.57
 - @vercel/next@3.6.6
 - @vercel/node@2.9.12
 - @vercel/python@3.1.53
 - @vercel/redwood@1.1.9
 - @vercel/remix@1.6.2
 - @vercel/ruby@1.3.70
 - @vercel/static-build@1.3.16",2023,3
48d925f10589db37f21cb22d86cf749aacd3a2ba,Steven,2023-03-07 18:17:14+00:00,Steven,2023-03-07 18:17:14+00:00,"Publish Stable

 - @vercel/build-utils@6.3.3
 - vercel@28.16.14
 - @vercel/client@12.4.3
 - @vercel/fs-detectors@3.8.3
 - @vercel/gatsby-plugin-vercel-builder@1.2.0
 - @vercel/go@2.3.10
 - @vercel/hydrogen@0.0.56
 - @vercel/next@3.6.5
 - @vercel/node@2.9.11
 - @vercel/python@3.1.52
 - @vercel/redwood@1.1.8
 - @vercel/remix@1.6.1
 - @vercel/ruby@1.3.69
 - @vercel/static-build@1.3.15",2023,3
011f6ff1508cd5d77c6499d48ad15acabbdae019,Steven,2023-03-07 18:15:28+00:00,GitHub,2023-03-07 18:15:28+00:00,"Revert ""[next] Fix incorrect 404 when `i18n` and `appDir` configured"" (#9617)

Reverts vercel/vercel#9582

https://github.com/orgs/vercel/discussions/1714",2023,3
cd09a38c198f2d403e8df8c025e749479d508326,Sean Massa,2023-03-07 17:21:53+00:00,GitHub,2023-03-07 17:21:53+00:00,"[tests] skip recent flakey tests (#9613)

This test has been flakey on mac for a long time.",2023,3
af239b5fa59e672ad7e2f0642a5fe7bfe97ded24,Ethan Arrowood,2023-03-07 15:44:25+00:00,GitHub,2023-03-07 15:44:25+00:00,"[internals] Create `@vercel-internals/types` (#9608)

Moves the type file out of the cli package and into its own standalone
package. utilizes `@vercel/style-guide` too for typescript config,
eslint, and prettier.",2023,3
38244c8ed6e90f6c6845afdf281ec7eb6532adc4,Chris Barber,2023-03-07 06:04:41+00:00,GitHub,2023-03-07 06:04:41+00:00,"[next] Populate middlewareRawSrc using middleware originalSource (#9602)

Next.js will pass the original middleware matching routes through to the middleware manifest once https://github.com/vercel/next.js/pull/46753 lands. This PR will take those original values and put them in the middleware route `middlewareRawSrc` property.

NOTE: The tests will need to be updated once the Next.js version is updated in the fixtures.",2023,3
57e8ec13cf9d6cefd79e63a80c0f854bfaac245c,Nathan Rajlich,2023-03-07 00:50:37+00:00,GitHub,2023-03-07 00:50:37+00:00,"[remix] Support optional static path segments (#9607)

Fixes https://github.com/orgs/vercel/discussions/1707.",2023,3
2e8423e24e1f2aa746d0b2ddb8152bc3cc857ba1,Nathan Rajlich,2023-03-06 21:44:23+00:00,GitHub,2023-03-06 21:44:23+00:00,"[gatsby] Remove ""gatsby"" dependency, use typebox instead of ajv for validation (#9606)

The ""gatsby"" dependency is large and relies on native packages (""sharp"" specifically, which are error prone because it attempts to download a precompiled binary, of which the CDN has been down before causing us to not be able to merge anything).

The package is only used for TypeScript types, and we've decided that including the package only for those types is not worth the trouble. The existing JSON schemas already validate at runtime that the Gatsby redux store provides the values that we depend on.

`ajv` was ditched in favor of TypeBox types, which provide both JSON Schema and validation using a simpler syntax.",2023,3
a92c68e0ffc4d91fc2e11e703da445c285f0c926,Sean Massa,2023-03-06 19:47:36+00:00,Sean Massa,2023-03-06 19:47:36+00:00,"Publish Stable

 - vercel@28.16.13
 - @vercel/next@3.6.4
 - @vercel/remix@1.6.0",2023,3
84f3a5bc1b3f32f28d230248e927b5fd117b9bae,Vercel Release Bot,2023-03-06 16:26:41+00:00,GitHub,2023-03-06 16:26:41+00:00,"[tests] Upgrade Turbo to version 1.8.3 (#9604)

This auto-generated PR updates Turbo to version 1.8.3",2023,3
186bd9bb518c19d48cdd588073cff40b1a30b784,JJ Kasper,2023-03-04 01:50:54+00:00,GitHub,2023-03-04 01:50:54+00:00,"[next] Fix api prefixed app routes serverless streaming (#9603)

Fixes: [slack thread](https://vercel.slack.com/archives/C03S8ED1DKM/p1677753703572609)",2023,3
9ae84ba05fd3385ed00c2dccc9d94caa3c32ccc3,Nathan Rajlich,2023-03-03 21:33:12+00:00,GitHub,2023-03-03 21:33:12+00:00,"[remix] Add test for escaped route paths (#9516)

In Remix routes, you can [use bracket notation to escape the filesystem routing behavior](https://remix.run/docs/en/1.14.0/file-conventions/routes-files#escaping-special-characters). For example `app/routes/receipt[.]pdf.tsx` would be available at path `/receipt.pdf` (whereas, unescaped, it would be at `/receipt/pdf`).

This adds an e2e test for that behavior.",2023,3
a638755e95ceea3bb4ee430a35808da297025dcd,Jeemin Choi(ÏµúÏßÄÎØº),2023-03-03 20:27:11+00:00,GitHub,2023-03-03 20:27:11+00:00,"[cli] change patch-inquirer-legacy to patch-inquirer (#8919)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,3
15eb018f849da2b30248ae17c4fcf86142b444db,Nathan Rajlich,2023-03-03 20:02:27+00:00,GitHub,2023-03-03 20:02:27+00:00,"[remix] Clean up dev symlink upon config error (#9595)

Move the try/catch block to immediately after the symlink call, so that if reading the `remix.config.js` file throws an error or if there's an error parsing the `export const config` in a route, the catch block will clean up after itself properly.

I recommend reviewing with [whitespace changes hidden](https://github.com/vercel/vercel/pull/9595/files?w=1).",2023,3
7f89aca52cad7427a0ab6dfbdacb0709e7eabbdc,Ethan Arrowood,2023-03-03 18:18:14+00:00,GitHub,2023-03-03 18:18:14+00:00,"[tests] Add more remix tests (#9600)

Adds some more tests to the remix project. 

- 05-root-only : tests a remix app with only a `root.jsx` route.
  - https://kentcdodds.com/blog/super-simple-start-to-remix
- 06-v2-routing : tests the remix v2 routing works",2023,3
dc9ec1bc6deee215d04a8fb1483e2370dabad56a,Nathan Rajlich,2023-03-03 04:29:55+00:00,GitHub,2023-03-03 04:29:55+00:00,[remix] Return `framework.version` in build result (#9596),2023,3
df93b0124877c0ca33cc53b7189cb7ce3ae2e3d3,Nathan Rajlich,2023-03-03 01:58:15+00:00,GitHub,2023-03-03 01:58:15+00:00,[examples] Run `prettier` on Remix template (#9594),2023,3
fb37ad22abb6b2c4d53048455b245d3929fd8da8,Nathan Rajlich,2023-03-02 23:28:26+00:00,GitHub,2023-03-02 23:28:26+00:00,"[remix] Fix support for optional path params (#9590)

Changes the way that routes with optional params are stored on Vercel to not use `?` in the name, because it's not possible to have a route destination with a `?` that's pointing to a function.

So instead of the function with a name such as `:lang?`, it will be stored on Vercel with a name like `(:lang)`, which can be routed to.",2023,3
684f69bc5b55b71361b470a0947a59424dec13fd,Vercel Release Bot,2023-03-02 20:57:25+00:00,GitHub,2023-03-02 20:57:25+00:00,"[remix] Upgrade @remix-run/dev to version 1.14.0 (#9593)

This auto-generated PR updates @remix-run/dev to version 1.14.0",2023,3
ddae78458d8c2461b3b1264e56dbc3e1f68caf56,Ethan Arrowood,2023-03-02 19:54:29+00:00,GitHub,2023-03-02 19:54:29+00:00,Fix remix updater workflow when fetching latest version (#9592),2023,3
fc614a7a9212ea0dd0c8ebcdf18db122768918d3,Nathan Rajlich,2023-03-02 17:00:40+00:00,Nathan Rajlich,2023-03-02 17:00:40+00:00,"Publish Stable

 - vercel@28.16.12
 - @vercel/remix@1.5.1",2023,3
6e4ea0774e76cdf9ad77e1de2d91a6d67ea35759,Nathan Rajlich,2023-03-02 16:58:00+00:00,GitHub,2023-03-02 16:58:00+00:00,"[remix] Make symlink logic of `@remix-run/dev` work in monorepos (#9591)

Utilize `require.resolve()` to determine the correct location of
`@remix-run/dev`, instead of assuming it's in
""node_modules/@remix-run/dev"" relative to the project work path.

Fixes https://github.com/orgs/vercel/discussions/1671.

Manually tested with yarn and pnpm on this template:
https://github.com/remix-run/examples/tree/main/turborepo-vercel",2023,3
cfc1c9e818ebb55d440479cf0edf18536b772b28,Nathan Rajlich,2023-03-02 01:24:34+00:00,Nathan Rajlich,2023-03-02 01:24:34+00:00,"Publish Stable

 - vercel@28.16.11
 - @vercel/next@3.6.3
 - @vercel/remix@1.5.0",2023,3
62a872fc0e73cd3702385810c10671ae2a71c299,Vercel Release Bot,2023-03-02 00:10:12+00:00,GitHub,2023-03-02 00:10:12+00:00,"[remix] Upgrade @remix-run/dev to version 1.13.0-patch.2 (#9589)

This auto-generated PR updates @remix-run/dev to version 1.13.0-patch.2",2023,3
03b5bfbaa2a1245e45aa21631ef6d5da8dc5c936,Vercel Release Bot,2023-03-01 23:34:51+00:00,GitHub,2023-03-01 23:34:51+00:00,"[examples] Upgrade Next.js to version 13.2.3 (#9586)

This auto-generated PR updates Next.js to version 13.2.3",2023,3
aa305e5c66b78671edcdb69d04759d5536a312be,Nathan Rajlich,2023-03-01 23:08:44+00:00,GitHub,2023-03-01 23:08:44+00:00,"[remix] Add better error message when server build directory is missing (#9584)

Show a more helpful message instead of showing a cryptic error messsage:

> Error: ENOENT: no such file or directory, copyfile
'/var/task/node_modules/@vercel/remix/server-node.mjs' ->
'/vercel/path0/packages/web/build/server-node.mjs'

This is probably due to a bad user configuration (i.e. with Turbo), but
tell them to contact support anyways in case there is a different cause
that we would need to address.",2023,3
2309c43fceb141e4e36bfaa49749b29f7467a81b,Ethan Arrowood,2023-03-01 21:50:23+00:00,GitHub,2023-03-01 21:50:23+00:00,"add vercel/remix-run-dev updater workflow (#9588)

Adds a github workflow and javascript updater script that will update
the `@remix-run/dev` version to the latest release of
`@vercel/remix-run-dev`",2023,3
0bbb06daa706f562e8591cd0a99b09ccd88ade5f,Nathan Rajlich,2023-03-01 21:45:10+00:00,GitHub,2023-03-01 21:45:10+00:00,"[remix] Support ""regions"", ""memory"" and ""maxDuration"" in static config (#9442)

Apply the `regions` configuration (for both Edge and Node) and `memory`/`maxDuration` (only for Node) in a page's static config export, i.e.

```js
export const config = { runtime: 'edge', regions: ['iad1'] }

// or for Node
export const config = { runtime: 'nodejs', regions: ['iad1'], maxDuration: 5, memory: 3008 }
```

Similar to `runtime`, these config values can be inherited from a parent layout route to apply to all sub-routes. Routes with common config settings get placed into a common server bundle, meaning that there may now be more than 2 functions created (previously was one Edge, one Node), allowing for more granularity between the server build bundles.",2023,3
61de63d2859c740d49ba1d28288fb7242886420c,Nathan Rajlich,2023-03-01 03:10:42+00:00,GitHub,2023-03-01 03:10:42+00:00,"[remix] Split Edge and Node server builds using `serverBundles` config (#9504)

Utilize the [`serverBundles`](https://github.com/remix-run/remix/pull/5479) config option to generate two server bundle builds. One contains only the routes that should run in Node.js, and the other contains only the routes that should run in the Edge runtime. In the future we could update this configuration to generate more than two bundles to be more granular and allow for infinite scalability.

Because the `serverBundles` PR is not yet merged, this PR introduces usage of a forked version of `@remix-run/dev` which incorporates our changes. Hopefully usage of a fork is temporary, but it gets us unblocked for now.",2023,3
1ca3704297a2b54a520058c9066256fd2b5434ee,Steven,2023-03-01 02:02:55+00:00,GitHub,2023-03-01 02:02:55+00:00,"[next] Fix incorrect 404 when `i18n` and `appDir` configured (#9582)

Fix incorrect 404 when visiting the `/` route with `i18n` and `appDir` configured",2023,3
ae4180b28771c7c570f77af9489bf9eb024d5e09,Nathan Rajlich,2023-03-01 01:02:43+00:00,GitHub,2023-03-01 01:02:43+00:00,"[tests] Use `probes.json` instead of `vercel.json` for e2e tests (#9556)

Makes it easier to test fixtures directly via CLI deployments.

Coincidentally, this also revealed that auto-detection of Remix apps wasn't working correctly if there's a `remix.config.mjs` file. So `@vercel/frameworks` is updated to account for that case as well.",2023,3
40081cb3194013dc6df6879c8561303ffa5f14fa,Steven,2023-03-01 00:12:33+00:00,Steven,2023-03-01 00:12:33+00:00,"Publish Stable

 - vercel@28.16.10
 - @vercel/remix@1.4.3",2023,3
9200be61d2d382d229cb83fa8cbe23f49b7a0e38,Steven,2023-03-01 00:09:40+00:00,GitHub,2023-03-01 00:09:40+00:00,"[tests] Publish with npm@9 (#9583)

https://vercel.slack.com/archives/C04DUD7EB1B/p1676488464681929",2023,3
1390f6d2eeca4ead7025824e135644a433550af5,Nathan Rajlich,2023-02-28 22:51:58+00:00,GitHub,2023-02-28 22:51:58+00:00,"[remix] Gracefully handle symlink creation when updating Remix packages (#9569)

Fixes an edge-case error when changing the version of Remix and then making a deployment to Vercel when there is already an existing build cache:

> Error: EEXIST: file already exists, symlink '../.pnpm/@remix-run+server-runtime@1.5.0_biqbaboplfbrettd7655fr4n2y/node_modules/@remix-run/server-runtime' -> '/vercel/path0/node_modules/@remix-run/server-runtime'

This would happen because the symlink was created in a previous run, but no longer points to a valid path because it's a different version. To fix we'll delete the previous symlink when the target value does not match.",2023,2
b78cfc9ba5587f943e55d6707033bac44ffdc09c,Nathan Rajlich,2023-02-28 22:16:05+00:00,GitHub,2023-02-28 22:16:05+00:00,[remix] Set `framework` property on Lambda / EdgeFunction (#9579),2023,2
803a9363f93c3f2be0f0ea2bce3ba64eefa78e04,Chris Barber,2023-02-28 21:32:23+00:00,Chris Barber,2023-02-28 21:32:23+00:00,"Publish Stable

 - vercel@28.16.9
 - @vercel/gatsby-plugin-vercel-analytics@1.0.8
 - @vercel/gatsby-plugin-vercel-builder@1.1.11
 - @vercel/node-bridge@3.1.14
 - @vercel/node@2.9.10
 - @vercel/static-build@1.3.14",2023,2
4a0a3b64a274c6421c9af8f4726570800e43a2cd,Chris Barber,2023-02-28 21:26:26+00:00,GitHub,2023-02-28 21:26:26+00:00,"[node] Added middlewareRawSrc to BOA route config (#9435)

Blocked by https://github.com/vercel/vercel/pull/9564

The build output's route configuration contains a compiled `src` from the list of `matchers` in middleware config, however we need to also save the original inputs so that we can render something meaningful in the web UI. The new prop added to the route is called `middlewareRawSrc` of type `string[]`.

This PR depends on https://github.com/vercel/api/pull/17231.

Linear: https://linear.app/vercel/issue/VCCLI-411/display-uncompressed-edge-middleware-matcher-show-the-list-of-matches",2023,2
347c2de3a2f2d1477253cf682a83adbeed63c9ec,Mehul Kar,2023-02-28 20:49:28+00:00,GitHub,2023-02-28 20:49:28+00:00,[tests] Adopt Workspace Configurations from turbo@1.8 (#9573),2023,2
a05cc117197d4d8daaa255ed04d5141af8851f32,Ethan Arrowood,2023-02-28 20:13:57+00:00,GitHub,2023-02-28 20:13:57+00:00,"[tests] Fix gatsby cron job script - git diff operation (#9577)

as titled",2023,2
55b999ea9b3c754acf444185df28e70354422a66,Ethan Arrowood,2023-02-28 20:05:31+00:00,GitHub,2023-02-28 20:05:31+00:00,"[tests] add missing -w option for pnpm in gatsby cron job script (#9575)

as titled",2023,2
8babc3694ff7fa3f28e2c5b5d65d313c1a5cd2a0,Ethan Arrowood,2023-02-28 19:59:58+00:00,GitHub,2023-02-28 19:59:58+00:00,"[tests] Fix gatsby cron job (#9574)

Changes logic so its a single npm call instead of multiple",2023,2
6dc03212169864a1d4d84ae4904d1561c6712c03,Ethan Arrowood,2023-02-28 19:40:05+00:00,GitHub,2023-02-28 19:40:05+00:00,"[tests] add missing __dirname from gatsby cron job script (#9572)

as titled",2023,2
3df8c057926582749594f81b4a9dda482b8d7982,Ethan Arrowood,2023-02-28 19:32:00+00:00,GitHub,2023-02-28 19:32:00+00:00,"[tests] Add cron job to update gatsby fixtures (#9510)

PR to add a cron job and script that automatically updates gatsby
fixture versions.",2023,2
e0f8bc98202146eda0f2b85efac74b803654e786,Sean Massa,2023-02-28 16:26:29+00:00,Sean Massa,2023-02-28 16:26:29+00:00,"Publish Stable

 - @vercel/build-utils@6.3.2
 - vercel@28.16.8
 - @vercel/client@12.4.2
 - @vercel/edge@0.3.1
 - @vercel/frameworks@1.3.2
 - @vercel/fs-detectors@3.8.2
 - @vercel/gatsby-plugin-vercel-builder@1.1.10
 - @vercel/go@2.3.9
 - @vercel/hydrogen@0.0.55
 - @vercel/next@3.6.2
 - @vercel/node-bridge@3.1.13
 - @vercel/node@2.9.9
 - @vercel/python@3.1.51
 - @vercel/redwood@1.1.7
 - @vercel/remix@1.4.2
 - @vercel/routing-utils@2.1.10
 - @vercel/ruby@1.3.68
 - @vercel/static-build@1.3.13",2023,2
ebd2e1822c5e8180143254eae198aa8af4b9575c,Chris Barber,2023-02-28 03:59:06+00:00,GitHub,2023-02-28 03:59:06+00:00,"[routing-utils] Add missing 'middlewareRawSrc' to route schema (#9564)

Need to add `middlewareRawSrc` to route schema so the build container will accept the new property.

This PR blocks https://github.com/vercel/vercel/pull/9435.

Linear: https://linear.app/vercel/issue/VCCLI-411/display-uncompressed-edge-middleware-matcher-show-the-list-of-matches",2023,2
31bc2581f30f43a1ad358771bd4fd97bb082a98a,Steven,2023-02-27 21:23:49+00:00,GitHub,2023-02-27 21:23:49+00:00,"[cli] Remove unncessary warning when monorepo setting override (#9565)

This warning is not actionable by the user so this PR removes it.",2023,2
96759a9fda7d20f1f61e2de8f41715302848cdaf,Steven,2023-02-27 20:01:05+00:00,GitHub,2023-02-27 20:01:05+00:00,"[hydrogen] Add missing envPrefix (#9551)

- Follow up to #9326",2023,2
ad2864bca53abec514a812276aa7ff77e3340fb0,Jimmy Lai,2023-02-27 18:58:12+00:00,GitHub,2023-02-27 18:58:12+00:00,"[next] add support for the integration hook file tracing (#9562)

Adds support for bundling properly the dependencies used by the experimental instrumentation hook file, `instrumentation.js`, by adding the generated nft file to the list of server deps

fixes NEXT-631",2023,2
40fbc993d7d8cad6d4d994e95bcf3995093ac7bf,Sean Massa,2023-02-27 17:05:27+00:00,GitHub,2023-02-27 17:05:27+00:00,"[tests] extract noisey setup to make test clearer (#9509)

Clarify dev server tests with a small function extraction.",2023,2
1f30e56a6d338bb49985251c4356c1b65ba5e351,Sean Massa,2023-02-27 16:37:57+00:00,GitHub,2023-02-27 16:37:57+00:00,[cli][dev] remove link to 404 FAQ (#9508),2023,2
58d6268899c6c21949e16cccfac648196ccab936,Nathan Rajlich,2023-02-27 15:07:32+00:00,GitHub,2023-02-27 15:07:32+00:00,"[frameworks] Check for `remix.config.mjs` for ""remix"" auto-detection (#9558)

Moving this to a separate PR based on this comment:
https://github.com/vercel/vercel/pull/9556#discussion_r1117939290

This will need to be merged and released before the relevant E2E test in
#9556 will pass.

Co-authored-by: Steven <steven@ceriously.com>",2023,2
4e6659ace760b189719f70dd0bfb6d5128004ebe,Nathan Rajlich,2023-02-27 07:19:58+00:00,GitHub,2023-02-27 07:19:58+00:00,"[remix] Fix sending multiple response headers with the same name with Node.js (#9533)

i.e. `Set-Cookie`. Right now only one will be sent and others will be lost. This update matches the code being used in `@remix-run/vercel`.",2023,2
769234b6a61fd18d7d10c43661db641b100ecac3,Nathan Rajlich,2023-02-25 08:53:30+00:00,GitHub,2023-02-25 08:53:30+00:00,"[remix] Inject Edge entrypoint into `@remix-run/vercel` during Edge Function creation (#9553)

There's [a PR](https://github.com/remix-run/remix/pull/5537) opened on
Remix to add an Edge compatible entrypoint to `@remix-run/vercel`. This
is only really needed specifically for projects that have a custom
server.js entrypoint file, which is not strictly necessary anymore, but
there are some edge cases where a project might still want to have one.
So this PR is necessary for those kinds of projects to be able to use
Edge runtime.

Even when they merge the PR, it would be good to leave this injection
code around for some time to continue support for older
`@remix-run/vercel` versions in existing projects.",2023,2
53cab61e885b45c2b13367d4ec00909347603163,JJ Kasper,2023-02-25 02:46:06+00:00,GitHub,2023-02-25 02:46:06+00:00,"[next] Fix deploying with cached build (#9555)

This leverages the relative app dir field in the required files manifest when available so that we don't rely on absolute paths from a cached build since the cache can be restored in a separate context where the value no longer applies.

x-ref: https://github.com/vercel/next.js/pull/45864
x-ref: https://github.com/vercel/next.js/pull/46393
x-ref: https://github.com/vercel/next.js/discussions/39432#discussioncomment-4914549
x-ref: [slack thread](https://vercel.slack.com/archives/C03S8ED1DKM/p1675821643786319)",2023,2
3a65acfb321980413604aa1a6ba01754307d82d7,Nathan Rajlich,2023-02-25 01:17:01+00:00,GitHub,2023-02-25 01:17:01+00:00,"[remix] Don't create output for Pathless Layout Routes without any child routes at the root level (#9539)

Fixes https://github.com/vercel/community/discussions/1587.",2023,2
48eed7532a5c13f60769add9269f33df9a81ab1a,Nathan Rajlich,2023-02-24 22:07:00+00:00,GitHub,2023-02-24 22:07:00+00:00,"[tests] Properly test for multiple headers with same name in probes (#9538)

Updates the `responseHeaders` probe checks to properly test for multiple headers with the same name.

Previously the probes were using `headers.get()` which concats multiple headers into a single string, which results in the test not really checking if there are in fact multiple headers with the same name. Using `headers.raw()` allows us to properly test for that.

A couple of Python tests that were already checking for multiple `set-cookie` headers needed to be updated to match the full value, since the check now properly validates the full string match of each header (before it was basically just doing a `string.includes()` check).

This is a precursor for https://github.com/vercel/vercel/pull/9533.",2023,2
f09d6fce85d214a839d2e7f2e60e72cfdbe39ffa,Cody Olsen,2023-02-24 20:40:55+00:00,GitHub,2023-02-24 20:40:55+00:00,"[frameworks] add `envPrefix` to `hydrogen` framework (#9326)

Hydrogen uses the `PUBLIC_` env prefix, [it also supports
`VITE_`](https://github.com/Shopify/hydrogen/blob/8168cd2dd850b59fb051e610d1db918f7e4ef327/packages/hydrogen/src/framework/plugins/vite-plugin-hydrogen-config.ts#L127)
but [the docs only talk about
`PUBLIC_`](https://shopify.dev/custom-storefronts/hydrogen/environment-variables#public-variables).",2023,2
cc82c499db2ca7f4414e0815ee2bee69b6b2b5c0,Chris Barber,2023-02-24 20:14:53+00:00,GitHub,2023-02-24 20:14:53+00:00,"[cli] Added fetch dist-tags http status validation (#9549)

If for some reason the `get-latest-worker.js` fails to get the dist-tags, it doesn't check the status code and proceeds to `JSON.parse()` the response. If for example npm returns 401 Unauthorized, you get a cryptic JSON parse error message.",2023,2
f0bc207717d3489a5846ee15e9a048684c291832,Steven,2023-02-24 18:02:35+00:00,GitHub,2023-02-24 18:02:35+00:00,"[build-utils] Handle error during `readConfigFile()` (#9542)

This fixes a confusing error:

```
$ vercel build
Vercel CLI 28.16.6
Error: duplicated mapping key in ""/vercel/path0/pnpm-lock.yaml"" at line 1215, column -164:
      /@react-dnd/asap/4.0.1:
      ^
```",2023,2
151c7f99eed3539e54162557d5ce022187e8f984,Steven,2023-02-24 16:14:17+00:00,GitHub,2023-02-24 16:14:17+00:00,"[tests] Pass token to cron github actions (#9544)

https://github.com/actions/github-script#using-a-separate-github-token",2023,2
61c2c494bf63e047189b2afcd93c6e69ea253850,Steven,2023-02-24 16:07:29+00:00,GitHub,2023-02-24 16:07:29+00:00,"Revert ""[tests] Update cron with token in git checkout"" (#9543)

Reverts vercel/vercel#9541",2023,2
7f49816129608f623cc6ed2d8024d8958bde7f4b,Steven,2023-02-24 15:51:03+00:00,GitHub,2023-02-24 15:51:03+00:00,"[tests] Update cron with token in git checkout (#9541)

Hopefully this will fix the issue where actions do not run against the
automated PR.",2023,2
7845bef8268b191f422f493fca6e2772bee7ac86,Nathan Rajlich,2023-02-24 12:04:16+00:00,Nathan Rajlich,2023-02-24 12:04:16+00:00,"Publish Stable

 - vercel@28.16.7
 - @vercel/edge@0.3.0
 - @vercel/gatsby-plugin-vercel-builder@1.1.9
 - @vercel/next@3.6.1
 - @vercel/node-bridge@3.1.12
 - @vercel/node@2.9.8
 - @vercel/static-build@1.3.12",2023,2
7acb2e4b0790c5642c2df9cdea81f962752c0064,github-actions[bot],2023-02-24 11:55:18+00:00,GitHub,2023-02-24 11:55:18+00:00,"[examples] Upgrade Next.js to version 13.2.1 (#9536)

This auto-generated PR updates Next.js to version 13.2.1",2023,2
abea002e93053e8e34b3211bf4ee84a195bf7b5c,Gal Schlezinger,2023-02-24 11:07:16+00:00,GitHub,2023-02-24 11:07:16+00:00,"[edge] Add RequestContext type (#9526)

Co-authored-by: Kiko Beats <josefrancisco.verdu@gmail.com>",2023,2
2db9678bd49cfe44266094517400d54ebd23aaed,Nathan Rajlich,2023-02-24 04:03:37+00:00,GitHub,2023-02-24 04:03:37+00:00,"[node-bridge] Fix multiple `Set-Cookie` headers in streaming mode (#9520)

Multiple `Set-Cookie` headers are being concat'd instead of being sent individually when in streaming mode.

**Non-streaming:**

```
$ curl -v https://01-remix-basics-eqztqyq3y.vercel-support.app/set-cookie 2>&1 | grep cookie
* h2h3 [:path: /set-cookie]
> GET /set-cookie HTTP/2
< set-cookie: foo=bar
< set-cookie: sessionId=38afes7a8
```

**Streaming:**

```
$ curl -v https://01-remix-basics-9b18alizh.vercel-support.app/set-cookie 2>&1 | grep cookie
* h2h3 [:path: /set-cookie]
> GET /set-cookie HTTP/2
< set-cookie: foo=bar,sessionId=38afes7a8
```",2023,2
05f942c53fa655b4646ab89ccc35746f2b4ef4f2,JJ Kasper,2023-02-24 00:29:34+00:00,GitHub,2023-02-24 00:29:34+00:00,"[tests] Update app-dir integration test (#9532)

The cache heuristic changed so there are now two separate serverless functions expected.",2023,2
6c5f0b7aa08ed2e2612557ca8bc0f509d55b374d,Nathan Rajlich,2023-02-23 23:53:45+00:00,Nathan Rajlich,2023-02-23 23:53:45+00:00,"Publish Stable

 - vercel@28.16.6
 - @vercel/remix@1.4.1",2023,2
fea05383b9d4d69c4f8b327cc50ede2a04d6c7a1,Nathan Rajlich,2023-02-23 23:52:27+00:00,GitHub,2023-02-23 23:52:27+00:00,"[remix] Ignore `serverBuildPath` from Remix config (#9531)

We are explicitly overriding `serverBuildPath` so there is no need to use the value that `readConfig()` gives to us.

Fixes #9524.",2023,2
247f49f765017665ffbfc21166bdf6e644e0e88a,github-actions[bot],2023-02-23 20:28:38+00:00,GitHub,2023-02-23 20:28:38+00:00,"[examples] Upgrade Next.js to version 13.2.0 (#9529)

This auto-generated PR updates Next.js to version 13.2.0

Co-authored-by: vercel-release-bot <infra+release@vercel.com>",2023,2
231714c71b172dd49f390e23e5270826a59654b0,Nathan Rajlich,2023-02-23 19:18:40+00:00,GitHub,2023-02-23 19:18:40+00:00,"[remix] `cd` to the project directory during `readConfig()` (#9518)

Sometimes the `cwd` needs to be properly set for some Remix configurations. This is problematic in monorepos because the default `cwd` is the root of the monorepo, and not the project directory.

So `cd` to the project directory when reading the Remix config file to account for that.

Fixes https://github.com/kiliman/remix-flat-routes/issues/42.
Fixes https://github.com/vercel/vercel/discussions/9478.",2023,2
73d6f0d0fa74482153f2382426974b88e8092ee2,Nathan Rajlich,2023-02-23 03:44:37+00:00,GitHub,2023-02-23 03:44:37+00:00,"[remix] Update `@remix-run/dev` dep to v1.13.0 (#9519)

There were some fixes to thier new v2 filesystem routing that this will help with.

Related to https://github.com/remix-run/remix/issues/5322 and https://github.com/remix-run/remix/pull/5228.",2023,2
34d199bd4925fab1fb32b8dae507e2383d38493a,Steven,2023-02-23 01:23:55+00:00,Steven,2023-02-23 01:23:55+00:00,"Publish Stable

 - @vercel/build-utils@6.3.1
 - vercel@28.16.5
 - @vercel/client@12.4.1
 - @vercel/fs-detectors@3.8.1
 - @vercel/gatsby-plugin-vercel-builder@1.1.8
 - @vercel/go@2.3.8
 - @vercel/hydrogen@0.0.54
 - @vercel/next@3.6.0
 - @vercel/node@2.9.7
 - @vercel/python@3.1.50
 - @vercel/redwood@1.1.6
 - @vercel/remix@1.4.0
 - @vercel/ruby@1.3.67
 - @vercel/static-build@1.3.11",2023,2
1dd421e1f630662c3e6cd5ab77f0aab20c94469e,Steven,2023-02-23 01:13:16+00:00,GitHub,2023-02-23 01:13:16+00:00,"[build-utils][next] Add `images.contentDispositionType` (#9513)

- Related to https://github.com/vercel/next.js/pull/46254
- Depends on https://github.com/vercel/api/pull/17434",2023,2
a91690fb8abb00b444fda1742715523622629c3e,Nathan Rajlich,2023-02-23 00:07:37+00:00,GitHub,2023-02-23 00:07:37+00:00,"[tests] Remove `watchPaths` from remix test fixture (#9517)

Follow-up to https://github.com/vercel/vercel/pull/9512 which is a
revert of the test fixture.

The fixture was actually broken in the previous commit
(https://github.com/vercel/vercel/pull/9506) since it now is trying to
read the config file before running the Build Command. Having a setup
like this will not be able to be supported, especially in order to land
https://github.com/vercel/vercel/pull/9504.",2023,2
264437c751498e896c8375a647dab02c3a81c3af,Steven,2023-02-22 23:50:25+00:00,GitHub,2023-02-22 23:50:25+00:00,"[tests] Increase test timeout from 5s to 10s (#9515)

Fixes this error:

```
@vercel/node:test-unit: FAIL test/dev.test.ts (14.891 s)
@vercel/node:test-unit:   √ó runs a mjs endpoint (5057 ms)
@vercel/node:test-unit:   √ó runs a esm typescript endpoint (5122 ms)
@vercel/node:test-unit: 
@vercel/node:test-unit:   ‚óè runs a mjs endpoint
@vercel/node:test-unit: 
@vercel/node:test-unit:     thrown: ""Exceeded timeout of 5000 ms for a test.
@vercel/node:test-unit:     Use jest.setTimeout(newTimeout) to increase the timeout value, if this is a long-running test.""
```


https://github.com/vercel/vercel/actions/runs/4247588973/jobs/7385801227#step:9:1039",2023,2
b8cce66eff2102c2aec7943f5bdb2bdf7c954777,Nathan Rajlich,2023-02-22 23:22:18+00:00,GitHub,2023-02-22 23:22:18+00:00,"[remix] Simplify ESM detection of `remix.config.js` (#9512)

In a Turborepo setup, there was this in the `remix.config.js` file:

```js
  watchPaths: [require.resolve(""ui"")],
```

Since we attempt to `require()` the `remix.config.js` file in order to
determine whether or not it is using ESM syntax, this would fail since
the require happens before the Build Command is executed.

To fix, treat any non `ERR_REQUIRE_ESM` error as CJS, instead of
re-throwing the error. If there really is an issue with importing the
config, then that'll happen right after when `remix build` is doing it.",2023,2
cbad57d14f94984687e644ab554dcc4487668f16,Nathan Rajlich,2023-02-22 22:19:40+00:00,GitHub,2023-02-22 22:19:40+00:00,"[remix] Restore support for a custom `server.js` entrypoint file (#9506)

When the project defines a custom `server.js` file in `remix.config.js`,
then don't override that with the bundled
`server-node.mjs`/`server-edge.mjs` file. This allows for a custom
`getLoadContext()` function to remain supported.

In order for Edge runtime to be supported, a [companion
PR](https://github.com/remix-run/remix/pull/5537) for
`@remix-run/vercel` adapter has been created with a dedicated entrypoint
for when Edge runtime is being used. In order to support Edge on
previous versions of the adapter, we may end up patching the package to
enable support, but that will happen in a follow-up PR.

Related to https://github.com/orgs/vercel/discussions/1596.

---------

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,2
4da176d26fd38b358c0943d0a16a91a8c9f72918,Nathan Rajlich,2023-02-22 20:35:12+00:00,GitHub,2023-02-22 20:35:12+00:00,"[remix] Allow `runtime` to be defined from a parent route (#9473)

Make it so that the `export const config = { runtime }` value is ""inherited"" from a parent route, if it is defined.

For example, ""edge"" can be defined in `app/root.tsx`, and so all routes will use the Edge runtime by default, unless `""runtime"": ""nodejs""` is used more specifically in a route deeper in the route hierarchy.",2023,2
1f51e043877fdf232fea3d51b0e56d7219546754,Chris Barber,2023-02-22 18:02:54+00:00,GitHub,2023-02-22 18:02:54+00:00,"[cli] Fix 'vc remove --safe <project>' (#9477)

`vc remove --safe <project>` has a unique code path that queries all deployments by project id. This function calls v4 deployments endpoint and returns the legacy deployment structure.

The problem is the `vc remove` command relies on the new `Deployment` structure defined by the v13 get deployment endpoint.

I've updated the `getDeploymentsByProjectId()` function to transform the legacy structure into the current one.

Fixes #9321 

Linear: https://linear.app/vercel/issue/VCCLI-538/vc-rm-project-safe-is-not-working",2023,2
756174714f35ad205e06614f79e5010fc1d482be,Sean Massa,2023-02-22 17:23:12+00:00,GitHub,2023-02-22 17:23:12+00:00,"[cli] fix content type determination logic (#9498)

The logic behind `getMimeType` only works for file names, not file paths. This PR fixes the logic to work regardless and adds a couple tests.",2023,2
6e32832f947212e755e0513c4a2daad0679db5bc,Ethan Arrowood,2023-02-22 15:48:21+00:00,GitHub,2023-02-22 15:48:21+00:00,"[tests] Delete monorepo tests (#9499)

Deletes flaky monorepo tests as the logic is well tested within the fs-detectors repo.",2023,2
e682e9cd7d1f1d4473057eb7628576f4c62e3b48,Gal Schlezinger,2023-02-22 05:54:39+00:00,GitHub,2023-02-22 05:54:39+00:00,"[node] fix TypeScript + ESM in Windows (#9487)

ESM on Windows versions of Node.js require `--loader PATH` to be a `file://` protocol.
This PR allows `vc dev` to be used with both TypeScript and ESM",2023,2
b30f000d2ab37bea5ec67c5461bb68d1a007cc3b,Sean Massa,2023-02-22 00:51:33+00:00,Sean Massa,2023-02-22 00:51:33+00:00,"Publish Stable

 - vercel@28.16.4
 - @vercel/next@3.5.2",2023,2
f78051ada951008280a468a9d61b7f568bb7ba7b,JJ Kasper,2023-02-22 00:41:54+00:00,GitHub,2023-02-22 00:41:54+00:00,[next] Ensure .rsc outputs are not created for route handlers (#9503),2023,2
10bc74904ca246df30449c742d2c9d38218df3b5,Don Alvarez,2023-02-21 16:32:03+00:00,GitHub,2023-02-21 16:32:03+00:00,"[docs] Improve docs for `@vercel/next` no pages built message (#9494)

After many hours of debugging, I tracked down that having an old Node
version (eg 14.x) listed in your Vercel project settings can result in
the build step failing with a confusing and unhelpful error message
""`@vercel/next` No Serverless Pages Built"". Note that this is a case
where it ""can"" cause it to fail, including with NextJS 13.1.6 and Vercel
CLI 28.16.2, but it is not guaranteed to fail. I have six NextJS
projects. They have identical next.config.js, tsconfig.json,
eslintrc.js, and .gitignore files, and other than a few seemingly
non-critical dependencies they have identical package.json files. Four
of the six consistently built and deployed in the cloud without issue.
Two consistently failed to build in the cloud. All built successfully
locally including using vercel build locally, and all would vercel
deploy --prebuilt successfully. Switching all the vercel cloud project
settings from Node 14.x to Node 18.x enabled all the projects to build
and deploy successfully in the vercel cloud without needing local vercel
build and local vercel deploy --prebuilt steps.

---------

Co-authored-by: Steven <steven@ceriously.com>",2023,2
c8f7a9a8741451c45dbafe584d8273f5a5b8cc50,Steven,2023-02-21 15:11:08+00:00,GitHub,2023-02-21 15:11:08+00:00,"[cli] Fix global detection for fnm (#9496)

Fix `--global` install detection when
[fnm](https://github.com/Schniz/fnm) was used to install node",2023,2
2fd33152219e7a2485b85b698e339c9c5cee23cf,Sean Massa,2023-02-21 14:53:23+00:00,Sean Massa,2023-02-21 14:53:23+00:00,"Publish Stable

 - vercel@28.16.3
 - @vercel/next@3.5.1
 - @vercel/remix@1.3.5",2023,2
54ef027cbe373781cf9d08ab5f875a36c40fe6fe,JJ Kasper,2023-02-21 01:54:17+00:00,GitHub,2023-02-21 01:54:17+00:00,"[next] Fix rsc routes order (#9493)

This ensures we maintain the correct order for our rsc routes with
reference to middleware so that they match correctly. This also adds a
regression test to ensure it's working as expected.

Fixes: https://github.com/vercel/next.js/issues/45331
x-ref: [slack
thread](https://vercel.slack.com/archives/C035J346QQL/p1676926522772859?thread_ts=1676926096.412539&cid=C035J346QQL)",2023,2
6620c7f6005b68b7c6a5cf8a10d3c4ccef7d92ce,Shu Ding,2023-02-20 19:35:06+00:00,GitHub,2023-02-20 19:35:06+00:00,"[next] Add initial `vary` header to all prerendered pages when RSC is enabled (#9481)

This PR changes the fallback headers that relate to RSC to the defaults that Next.js currently uses. Also, it sets the initial `vary` header to all prerendered routes when RSC is enabled (`routesManifest?.rsc`), even for the pages directory. 

That's because although the pages directory won't return any RSC payload, it can still be used in a project that contains app routes. When the app route requests a page route for RSC data, it's important for the browser to not accidentally cache that result hence we need the `vary` header to set there as well.

More related discussions can be found [here](https://linear.app/vercel/issue/NEXT-382/add-vary-rsc-etc-header-to-all-responses-to-ensure-browser-caching).",2023,2
38f40f1c15417d8da70a9270d2d62486272360f3,JJ Kasper,2023-02-20 10:41:24+00:00,GitHub,2023-02-20 10:41:24+00:00,"[next] Handle prerender-manifest v4 (#9489)

Co-authored-by: Tim Neutkens <tim@timneutkens.nl>",2023,2
63211b8b89f7d3e5147a49c1de9cc66424c51d45,Nathan Rajlich,2023-02-17 18:46:33+00:00,GitHub,2023-02-17 18:46:33+00:00,"[remix] Add unit tests (#9469)

Moves parts of the `@vercel/remix` builder into util functions that have isolated unit tests. No functionality changes.",2023,2
83ee5ea2b84a7818e12a787c2d1a3179a434447c,Ikko Eltociear Ashimine,2023-02-17 16:45:44+00:00,GitHub,2023-02-17 16:45:44+00:00,"[cli] Fix typo in get-latest-worker.js (#9470)

persistance -> persistence

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,2
f063645646a11049212e358eb7e6ac11f1a2fa78,Ethan Arrowood,2023-02-17 16:42:26+00:00,GitHub,2023-02-17 16:42:26+00:00,"[examples] Update remix template (#9472)

Previous PR was merged automatically but need to fix a dependency
version",2023,2
4f8c5e344d030db9b503e8e9f98f5c70293562a0,Ethan Arrowood,2023-02-17 15:10:17+00:00,GitHub,2023-02-17 15:10:17+00:00,"[examples] update remix template (#9455)

Updates our remix template so that it works with our new Remix changes",2023,2
70a53515bd12202f895c369504e2d5be6c9469f4,Nathan Rajlich,2023-02-16 23:12:31+00:00,Nathan Rajlich,2023-02-16 23:12:31+00:00,"Publish Stable

 - vercel@28.16.2
 - @vercel/fs-detectors@3.8.0
 - @vercel/next@3.5.0
 - @vercel/remix@1.3.4
 - @vercel/ruby@1.3.66
 - @vercel/static-build@1.3.10",2023,2
4d4f0fa672d31fea6ec034936e64ebd2909e4cbf,Sean Massa,2023-02-16 22:59:14+00:00,GitHub,2023-02-16 22:59:14+00:00,"[next] Add Operation Types to Next.js Lambdas (#9196)

In order to have Next.js Lambdas show their operation types more specifically in the build output in the dashboard, the builder needs to return the Lambdas with `operationType` set to the appropriate value.

This PR adds those values. This allows the Richer Deployment Outputs to show the different types of serverless functions:
<img width=""228"" alt=""Screenshot 2023-02-03 at 3 49 42 PM"" src=""https://user-images.githubusercontent.com/41545/216717479-d02fbd4a-fa62-479d-8b65-bd77fdcdb26c.png"">",2023,2
46c0fd153a23e7c4dc9a29d578f7683e42c10547,Felix Haus,2023-02-16 21:42:42+00:00,GitHub,2023-02-16 21:42:42+00:00,"[fs-detectors] Remove increments of 64 limit for function memory (#9465)

Missed this occurrence so it still prevents the upload of serverless
functions that have a mem value that is not dividable by 64.
Should be the last place before we can ship the documentation update.

#### Related PRs
- #9440

Co-authored-by: Steven <steven@ceriously.com>",2023,2
1c8b4717e362a8e0826596c9793565ef1ca4c88c,Marc Greenstock,2023-02-16 21:41:56+00:00,GitHub,2023-02-16 21:41:56+00:00,"[ruby] fix: HEAD requests (#9436)

When WEBrick receives `HEAD` requests it discards the body (i.e.
`req.body.nil? => true`), this causes Vercel to throw a
`BODY_NOT_A_STRING_FROM_FUNCTION` since it is expecting the serverless
function to respond with a string in the body.

---------

Co-authored-by: Nathan Rajlich <n@n8.io>
Co-authored-by: Steven <steven@ceriously.com>",2023,2
d52d26eaac1306e81deb4008f1c441f24d1c5512,Nathan Rajlich,2023-02-16 21:25:19+00:00,GitHub,2023-02-16 21:25:19+00:00,"[remix] Install Node globals (#9467)

Fixes https://github.com/vercel/community/discussions/1547.
Fixes https://github.com/vercel/community/discussions/1549.",2023,2
db65728fc4f87b26dbeeb632a4e202dc144cb061,Vincent Voyer,2023-02-16 14:36:16+00:00,Vincent Voyer,2023-02-16 14:36:16+00:00,"Publish Stable

 - vercel@28.16.1",2023,2
a788d06f850208d5a04658a6eed4663a6a5168e1,Vincent Voyer,2023-02-16 14:34:56+00:00,GitHub,2023-02-16 14:34:56+00:00,"[cli]: fix merging of vercel.json and build result crons (#9464)

Ensures that existing crons and crons from vercel.json are merged
together correctly.",2023,2
3d98d1cdea151b7125deb082c2c8469c865027d0,Vincent Voyer,2023-02-16 11:08:50+00:00,Vincent Voyer,2023-02-16 11:08:50+00:00,"Publish Stable

 - @vercel/build-utils@6.3.0
 - vercel@28.16.0
 - @vercel/client@12.4.0
 - @vercel/fs-detectors@3.7.14
 - @vercel/gatsby-plugin-vercel-builder@1.1.7
 - @vercel/go@2.3.7
 - @vercel/hydrogen@0.0.53
 - @vercel/next@3.4.7
 - @vercel/node@2.9.6
 - @vercel/python@3.1.49
 - @vercel/redwood@1.1.5
 - @vercel/remix@1.3.3
 - @vercel/ruby@1.3.65
 - @vercel/static-build@1.3.9
 - @vercel/static-config@2.0.13",2023,2
667af829c42b97988c161810c8c7404567b23ddb,Vincent Voyer,2023-02-16 10:49:09+00:00,GitHub,2023-02-16 10:49:09+00:00,"[build-utils][cli][client][node][next][static-config]: forward `crons` from vercel.json to config.json (#9454)

This PR changes the way cron jobs are being created in the build output
API. This is my first time contributing here. If you see something
unusual, let me know.

‚úÖ Good for review

Our goal is to:
- Allow creating cron jobs via the `crons` property of `vercel.json` for
end users
- Allow framework authors to create cron jobs on Vercel via the `crons`
property of the Build Output API configuration

---

As you can see, we removed the previous implementation where cron jobs
could be configured at the function code level (export const cron = """"),
on top of vercel.json `functions` property. Here's why:

- All frameworks would have to implement the configure at the function
code level
- Not all frameworks can easily map a path to a specific function
(example: SvelteKit) and would have to bail on bundling functions inside
the same lambda
- Configuring a path + scheduler provides a better mapping of what cron
jobs are as of today: API routes on a schedule and not functions on a
schedule
- Dynamic routes Cron Jobs will be supported:
/api/crons/sync-slack-team/230
- Query parameters will be supported support:
/api/crons/sync-slack-team/230?secret=32k13l2k13lk21 (= securing cron
jobs v0)
- 100% frameworks compatibility from day one

Next.js and other frameworks may choose to implement their own cron jobs
feature that will then need to be configured through the `crons`
property of `config.json` (build output API).

cc @timneutkens @Rich-Harris 

Internal thread:
https://vercel.slack.com/archives/C04DWF5HB6K/p1676366892714349",2023,2
1bb7b37e0ce3ea25fad81f9a328de466de67a14e,Nathan Rajlich,2023-02-16 07:41:25+00:00,Nathan Rajlich,2023-02-16 07:41:25+00:00,"Publish Stable

 - vercel@28.15.7
 - @vercel/next@3.4.6
 - @vercel/remix@1.3.2",2023,2
ca81c133b981af237514fc7188576631db4e0bf9,Nathan Rajlich,2023-02-16 07:32:53+00:00,GitHub,2023-02-16 07:32:53+00:00,"[remix] Fix root-level splat path (#9457)

Fixes https://github.com/orgs/vercel/discussions/1545.",2023,2
f332b7856cd12820dbc819b9afa8f4abd1c6dfe9,Luba Kravchenko,2023-02-15 22:56:29+00:00,GitHub,2023-02-15 22:56:29+00:00,"Adds framework fields to build outputs (#9449)

Adds framework to Lambda and edge build outputs so that we can distinguish which framework they originated from when certain features should be applied to specific frameworks.

This PR adds framework to the outputs. Part 1: https://github.com/vercel/vercel/pull/9448

ticket: ED-131

x-ref: [slack channel](https://vercel.slack.com/archives/C042LHPJ1NX)",2023,2
9308a0fda5e14ee8a07b9a3506e4480f5f67d212,Sean Massa,2023-02-15 18:26:53+00:00,Sean Massa,2023-02-15 18:26:53+00:00,"Publish Stable

 - @vercel/build-utils@6.2.4
 - vercel@28.15.6
 - @vercel/client@12.3.10
 - @vercel/frameworks@1.3.1
 - @vercel/fs-detectors@3.7.13
 - @vercel/gatsby-plugin-vercel-builder@1.1.6
 - @vercel/go@2.3.6
 - @vercel/hydrogen@0.0.52
 - @vercel/next@3.4.5
 - @vercel/node@2.9.5
 - @vercel/python@3.1.48
 - @vercel/redwood@1.1.4
 - @vercel/remix@1.3.1
 - @vercel/routing-utils@2.1.9
 - @vercel/ruby@1.3.64
 - @vercel/static-build@1.3.8",2023,2
c2f8a5990ad9bddd01f660473522772059893569,Steven,2023-02-15 17:11:54+00:00,GitHub,2023-02-15 17:11:54+00:00,"[tests] Fix gh actions cron job to update next/turbo (#9453)

This token should run the tests automatically",2023,2
fc2f0b919b07b3cddde4620328378962eb47616e,JJ Kasper,2023-02-15 09:00:24+00:00,GitHub,2023-02-15 09:00:24+00:00,[next] Ensure app routes are handled (#9450),2023,2
a606ab8678cf465c6f4691727becbe95fd3141c8,Luba Kravchenko,2023-02-15 03:14:21+00:00,GitHub,2023-02-15 03:14:21+00:00,"[build-utils] add framework slug and version to build output (#9448)

Adds framework to Lambda and edge build outputs so that we can distinguish which framework they originated from when certain features should be applied to specific frameworks.

Breaking up https://github.com/vercel/vercel/pull/9447 into two parts:
This PR introduces the frameworks type. Part 2: https://github.com/vercel/vercel/pull/9449

ticket: ED-131

x-ref: [slack channel](https://vercel.slack.com/archives/C042LHPJ1NX)",2023,2
13062cd47d84729bf4a49eba30be54610e7fb5b7,Chris Barber,2023-02-14 23:45:03+00:00,GitHub,2023-02-14 23:45:03+00:00,"[routing-utils] Added middlewareRawSrc to RouteWithSrc type (#9443)

This PR adds a new `middlewareRawSrc` prop to the `RouteWithSrc` type which is used for edge middleware routes. The existing `middlewarePath` prop contains a regex of all the middleware `matcher` routes which isn't very user friendly on the front end.

By preserving the original middleware matchers, the front end can display the list in a much more presentable fashion.

This feature blocks 3 other PRs.
1. https://github.com/vercel/api/pull/17231 depends on `Route` type for schema validation and translates `middlewareRawSrc` to `rawMatchers` for front end consumption
2. https://github.com/vercel/vercel/pull/9435 sets the `middlewareRawSrc` in the BOA output
3. https://github.com/vercel/front/pull/19606 displays the `rawMatchers` under the Edge Middleware section for a deployment

Linear: https://linear.app/vercel/issue/VCCLI-411/display-uncompressed-edge-middleware-matcher-show-the-list-of-matches",2023,2
bb9faaed99d52a8569c72fb3e4bd012ca64665b1,Chris Barber,2023-02-14 22:59:52+00:00,GitHub,2023-02-14 22:59:52+00:00,"[test] Use execFileSync() to get processes (#9445)

`spawnSync()` does not throw if the command can't be found in the PATH or if an error occurs. If we use `execFileSync()`, it will throw and that was likely the desired behavior in this test utility function.",2023,2
881e43a0e2d6daa2f7654ad16566960b00d412aa,Sean Massa,2023-02-14 21:38:34+00:00,Sean Massa,2023-02-14 21:38:34+00:00,"Publish Stable

 - @vercel/build-utils@6.2.3
 - vercel@28.15.5
 - @vercel/client@12.3.9
 - @vercel/fs-detectors@3.7.12
 - @vercel/gatsby-plugin-vercel-builder@1.1.5
 - @vercel/go@2.3.5
 - @vercel/hydrogen@0.0.51
 - @vercel/next@3.4.4
 - @vercel/node@2.9.4
 - @vercel/python@3.1.47
 - @vercel/redwood@1.1.3
 - @vercel/remix-entry-server@0.1.0
 - @vercel/remix@1.3.0
 - @vercel/ruby@1.3.63
 - @vercel/static-build@1.3.7",2023,2
578a7742fe706d0ff918675f03089203693dc9e5,Steven,2023-02-14 20:32:18+00:00,GitHub,2023-02-14 20:32:18+00:00,"[next] Improve error message when routes-manifest.json not found (#9441)

The dashboard doesn't handle multiline errors very well because other lines are collapsed.

https://vercel.com/changelog/deployment-logs-filtering-now-available

<img width=""1237"" alt=""image"" src=""https://user-images.githubusercontent.com/229881/218832497-0bcd9404-b4f5-49fe-9edd-bd6de6d8bb8f.png"">


We also show the complete error in the top and it doesn't show newlines properly.

<img width=""428"" alt=""image"" src=""https://user-images.githubusercontent.com/229881/218832603-065e0d4d-ae6e-4b44-b2db-b2fff063da58.png"">

The ""Learn More"" link already has the relevant information so we can reduce this error message to a single line to improve the call to action.",2023,2
2d84a6443069a7f3fda33816833e646bf3c51e7f,Nathan Rajlich,2023-02-14 18:09:07+00:00,GitHub,2023-02-14 18:09:07+00:00,"[remix-entry-server] Add initial implementation (#9417)

This adds a new package to the monorepo: `@vercel/remix-entry-server`

The purpose of this package is to provide most of the implementation of
the Remix `app/entry.server.tsx` file with proper support for the Vercel
Serverless and Edge runtimes, specifically in regards to React 18
streaming.

The reason that this package is necessary, as opposed to just updating
our Remix template, is due to the fact that Serverless and Edge runtimes
require a different implementation. This is because the
`react-dom/server` package exports different functions for the Node
(`renderToPipeableStream()`) vs. Edge (`renderToReadableStream()`)
bundles, and thus this package also has two different implementations
(by utilizing the `main` and `browser` fields in `package.json`).

Usage of this package in a Remix application's `app/entry.server.tsx`
file looks like:

```tsx
import handleRequest from ""@vercel/remix-entry-server"";
import { RemixServer } from ""@remix-run/react"";
import type { EntryContext } from ""@remix-run/server-runtime"";

export default function (
  request: Request,
  responseStatusCode: number,
  responseHeaders: Headers,
  remixContext: EntryContext
) {
  const remixServer = <RemixServer context={remixContext} url={request.url} />;
  return handleRequest(request, responseStatusCode, responseHeaders, remixServer)
}
```

Once this package is published then we can update our own Remix template
to utilize it, enabling React 18 streaming for both Vercel runtimes.",2023,2
200ac9964764672e67146acccf140dd9ebe9b89e,Felix Haus,2023-02-14 18:08:40+00:00,GitHub,2023-02-14 18:08:40+00:00,"[build-utils][cli] Remove 64 increment limit for serverless functions (#9440)

We no longer require the memory to be provided in steps of 64mb for
serverless functions.
Instead the memory can now be chosen freely from `128mb` to `3008mb` in
`1mb increments`.

Updates the `vercel.json` schema to reflect that change.",2023,2
1d3f2b5a62b6f9b78fa7dbd91d988382c72c8913,Felix Haus,2023-02-14 16:44:24+00:00,GitHub,2023-02-14 16:44:24+00:00,"[build-utils][cli] Update link to project-configuration (#9439)

The link to the documentation has changed.
It is now available under https://vercel.com/docs/concepts/projects/project-configuration

This updates:
- link generation `https://vercel.com/docs/configuration#project/*` -> `https://vercel.com/docs/concepts/projects/project-configuration#*`
-  Updates test files
- Updates static references of https://vercel.com/docs/configuration across the repo",2023,2
8f499695853c6689cb231c6f3f6020feb95b4713,Steven,2023-02-14 15:31:46+00:00,GitHub,2023-02-14 15:31:46+00:00,"[tests] Update tests script names (#9433)

### Description 

These script names are currently really long and that makes it difficult
to read.

In particular, the most important part (the package name) is often
truncated.

See before/after below.

## Before

<img width=""302"" alt=""image""
src=""https://user-images.githubusercontent.com/229881/218588978-b8ed9a7a-f4da-4d58-af3f-2b1a7087737d.png"">

## After

<img width=""290"" alt=""image""
src=""https://user-images.githubusercontent.com/229881/218596895-65627ad0-2895-4bd7-8506-f5f545a419d3.png"">",2023,2
cfbfaa7cd09a77c4f2818ca073b6fbd6433f6f9b,Steven,2023-02-14 14:58:10+00:00,GitHub,2023-02-14 14:58:10+00:00,"[tests] Fix memory limit test (#9438)

This error message was adjusted recently",2023,2
25747a76216a56733e9a96dd09437296e3430627,Nathan Rajlich,2023-02-14 01:01:46+00:00,GitHub,2023-02-14 01:01:46+00:00,"[remix] Support per-page Edge functions and replace ""@remix-run/vercel"" (#9375)

Adds support for server-side rendered Remix using Edge Functions. This runtime can be enabled on a per-page basis, by adding the following to a page within the `app/routes` directory:

```js
export const config = {
  runtime: 'edge'
};
```

Additionally, this PR further supersedes the `@remix-run/vercel` runtime adapter, because we will always inject our own server entrypoint. So the logic to ensure that package exists in the project's `package.json` has been removed (so this closes #9011). The only requirement is that the Remix project has `@remix-run/node` as a dependency, which is the case for the vanilla Remix template so I think that's a fair assumption.

To make Edge Functions work, we need to ensure that `remix build` is executed with a few specific configuration values in place, so this change wraps the existing `remix.config.js` file and adds our own to make sure those values are in place (and then cleans itself up after the build command is executed).

Finally, the reading of the Remix config logic was simplified by using the `readConfig()` function from the `@remix-run/dev` package, which also includes the routes manifest, so the hacky `vm` running logic to retrieve the manifest was able to be removed.

Closes #8784.
Closes #9011.

---

# To test this out:

1. Ensure that Remix dependencies are running _at least version `1.5.0`_ (which is when `writeReadableStreamToWritable()` was added to `@remix-run/node`).

2. Add the following line of code¬†to any page in your Remix application‚Äôs¬†`app/routes/*` directory:
    
    ```jsx
    export const config = { runtime: 'edge' };
    ```
    
3. Set an Environment Variable on your Vercel Project:
    - Name:¬†`VERCEL_CLI_VERSION`
    - Value: `https://vercel-git-update-remix-edge.vercel.sh/tarballs/vercel.tgz`
    
4. Make a deployment, either by running `vercel deploy` in the CLI, or by pushing a Git commit to your repository which has a Vercel Git integration enabled.",2023,2
8d635beed75241aeda78ccfc751c6009769b502e,github-actions[bot],2023-02-14 00:01:45+00:00,GitHub,2023-02-14 00:01:45+00:00,"[tests] Upgrade Turbo to version 1.7.4 (#9431)

This auto-generated PR updates Turbo to version 1.7.4",2023,2
6225f050faa1dded954ab50cc928b114d4cb3f5f,JJ Kasper,2023-02-13 23:22:33+00:00,GitHub,2023-02-13 23:22:33+00:00,"[next] Fix app-dir tests from new content-type (#9434)

x-ref: https://github.com/vercel/vercel/pull/9408
x-ref:
https://github.com/vercel/vercel/actions/runs/4168082693/jobs/7214887847",2023,2
30a899bab1c33df9e5ad85cbc7b73e44fbcefbe4,Steven,2023-02-13 21:39:15+00:00,GitHub,2023-02-13 21:39:15+00:00,"[tests] Add `workflow_dispatch` to cron workflows (#9430)

This `workflow_dispatch` prop allows manual runs by clicking a button on
https://github.com/vercel/vercel/actions",2023,2
a010d8fe8af5786c16c9d1d40c730e2302d02c00,Sean Massa,2023-02-13 21:37:16+00:00,GitHub,2023-02-13 21:37:16+00:00,"[cli] add slash before url for edge function errors (#9428)

Edge Functions and Serverless Functions were both updated to show the path of their entry points, but it turns out Serverless Function paths started with a slash and Edge Function paths did not.

The [related code for Serverless Functions](https://github.com/vercel/vercel/blob/d62888094236c6f2afdc34a5db2f098adf575470/packages/node-bridge/helpers.ts) does not need to be updated.

---

Before:

<img width=""996"" alt=""CleanShot 2023-02-13 at 13 23 42@2x"" src=""https://user-images.githubusercontent.com/41545/218554154-2b112a68-2d68-4968-bae7-acf6e85a72a2.png"">

---

After: 

<img width=""921"" alt=""CleanShot 2023-02-13 at 13 20 22@2x"" src=""https://user-images.githubusercontent.com/41545/218554029-c3dce6b1-b01f-4a78-aa32-f6891ff16e51.png"">",2023,2
a9ff23fe22939ee2a170b42142ac39087f9d256a,Steven,2023-02-13 21:00:42+00:00,GitHub,2023-02-13 21:00:42+00:00,"[test] Switch to turbo main release line (#9429)

Per @tknickman, we don't need to be testing every turbo canary in this
repo, that will happen in the turborepo tests",2023,2
b60d3f657a5a5410b83c31268818c22ae1393b4c,Steven,2023-02-13 20:59:05+00:00,GitHub,2023-02-13 20:59:05+00:00,"[tests] Update CI to Node.js 16 (#9397)

In an effort to speed up CI, we should update the lowest common
denominator to Node.js 16

Note: In April, Node.js 14 will reach EOL so we can update tsconfig
targets and ship a major semver at that time.

---------

Co-authored-by: JJ Kasper <jj@jjsweb.site>",2023,2
e7947a1b3384a09e264a50cbd3ff259c4dd59870,Nathan Rajlich,2023-02-13 20:27:37+00:00,GitHub,2023-02-13 20:27:37+00:00,"[node] Make NFT resolve ""worker""/""browser"" exports for Edge Functions (#9377)

This makes `react-dom` work as expected from within Edge Functions. Otherwise, NFT will only select the Node.js version of the files which do not work with react-dom within an Edge Function.",2023,2
95a4dcfb33d813f1a0ef18d766232d42c876ce69,Sean Massa,2023-02-13 18:47:15+00:00,Sean Massa,2023-02-13 18:47:15+00:00,"Publish Stable

 - @vercel/build-utils@6.2.2
 - vercel@28.15.4
 - @vercel/client@12.3.8
 - @vercel/fs-detectors@3.7.11
 - @vercel/gatsby-plugin-vercel-builder@1.1.4
 - @vercel/go@2.3.4
 - @vercel/hydrogen@0.0.50
 - @vercel/next@3.4.3
 - @vercel/node-bridge@3.1.11
 - @vercel/node@2.9.3
 - @vercel/python@3.1.46
 - @vercel/redwood@1.1.2
 - @vercel/remix@1.2.13
 - @vercel/ruby@1.3.62
 - @vercel/static-build@1.3.6",2023,2
124b747b0e13e1437d64b46de477b6afee7a4b8b,Tim Neutkens,2023-02-13 13:04:54+00:00,GitHub,2023-02-13 13:04:54+00:00,Read rscContentType from routes manifest (#9408),2023,2
a735527d8fbbc4ba09a7f14a3babb6bfa664dcca,Nathan Rajlich,2023-02-11 20:42:39+00:00,GitHub,2023-02-11 20:42:39+00:00,"[build-utils] Filter out files outside of `cwd` when glob is in ""follow"" mode (#9412)

Enables `glob()` to operate in ""follow"" mode, but filters out any values where a symlink points to a target that lives outside of the `cwd.",2023,2
d62888094236c6f2afdc34a5db2f098adf575470,Sean Massa,2023-02-11 00:14:58+00:00,GitHub,2023-02-11 00:14:58+00:00,"[cli][node][node-bridge] improve edge/serverless function error messages (#9410)

The error messages shown during `vc dev` when an Edge or Serverless functions returns a promise that ends up being rejected could be better.

Main changes:

- removed ""socket hang up"" error messages because they were not helpful to the user
- changed serverless function error handling to log explicitly and exit
- changed serverless function error message to include the request path
- changed edge function error message to include request path and a faked (but useful) stack trace

## Current

### In Production

**Serverless Function:** In production, for a serverless function rejected promise, you'll see this in the logs:

```
Unhandled Promise Rejection 	{
  ""errorType"": ""Runtime.UnhandledPromiseRejection"",
  ""errorMessage"": ""Error: intentional break!"",
  ""reason"": {
    ""errorType"": ""Error"",
    ""errorMessage"": ""intentional break!"",
    ""stack"": [
      ""Error: intentional break!"",
      ""    at handler (/var/task/api/node.js:3:9)"",
      ""    at Server.<anonymous> (/var/task/___vc/__helpers.js:813:19)"",
      ""    at Server.emit (node:events:527:28)"",
      ""    at parserOnIncoming (node:_http_server:956:12)"",
      ""    at HTTPParser.parserOnHeadersComplete (node:_http_common:128:17)""
    ]
  },
  ""promise"": {},
  ""stack"": [
    ""Runtime.UnhandledPromiseRejection: Error: intentional break!"",
    ""    at process.<anonymous> (file:///var/runtime/index.mjs:1194:17)"",
    ""    at process.emit (node:events:539:35)"",
    ""    at process.emit (/var/task/___vc/__sourcemap_support.js:559:21)"",
    ""    at emit (node:internal/process/promises:140:20)"",
    ""    at processPromiseRejections (node:internal/process/promises:274:27)"",
    ""    at processTicksAndRejections (node:internal/process/task_queues:97:32)""
  ]
}
Unknown application error occurred
Runtime.Unknown
```

**Edge Function:** In production, for an edge function rejected promise, you'll see this in the logs:

```
Error: intentional break!
    at (api/edge.js:10:10)
```

In both cases, in the browser, you see the ""This Serverless/Edge Function has crashed."" template with no error message or stack trace.


### In `vc dev`


**Serverless Function:** In `vc dev`, for a serverless function rejected promise, you'll see this in the output:

```
Unhandled rejection: Error: intentional break!
    at handler (/Users/smassa/source/demo/edge-errors/api/node.js:3:9)
    at Server.<anonymous> (/Users/smassa/source/vercel/vercel/packages/node-bridge/helpers.js:813:19)
    at Server.emit (node:events:513:28)
    at Server.emit (node:domain:489:12)
    at parserOnIncoming (node:_http_server:998:12)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:128:17)
Error: Failed to complete request to /api/node: Error: socket hang up
```

**Edge Function:** In `vc dev`, for an edge function rejected promise, you'll see this in the output:

```
Unhandled rejection: intentional break!
Error: Failed to complete request to /api/edge: Error: socket hang up
```

## After Changes

### In `vc dev`


**Serverless Function:** In `vc dev`, for a serverless function rejected promise, you'll see this in the output:

```
Rejected Promise returned from /api/node: Error: intentional break!
    at handler (/Users/smassa/source/demo/edge-errors/api/node.js:3:9)
    at Server.<anonymous> (/Users/smassa/source/vercel/vercel/packages/node-bridge/helpers.js:824:19)
    at Server.emit (node:events:513:28)
    at Server.emit (node:domain:489:12)
    at parserOnIncoming (node:_http_server:998:12)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:128:17)
```

**Edge Function:** In `vc dev`, for an edge function rejected promise, you'll see this in the output:

```
Rejected Promise returned from api/edge: intentional break!
    at (api/edge.ts)
```

We can't show the real stack trace for Edge Functions because the bundling + VM execution mangles it. What's rendered here is a fake one, but it's still useful to the user.

If we currently showed the real stack trace for edge functions, it would look like:

```
Rejected Promise returned from api/edge: intentional break!
    at edge (evalmachine.<anonymous>:35:9)
    at FetchEvent.<anonymous> (evalmachine.<anonymous>:87:26)
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async EdgeRuntime.dispatchFetch (evalmachine.<anonymous>:29:7)
    at async Server.handler (/Users/smassa/source/vercel/vercel/node_modules/.pnpm/edge-runtime@2.0.0/node_modules/edge-runtime/src/server/create-handler.ts:46:26)
```

## Follow Up

We'll look into improving the Edge Function error stack traces later.",2023,2
084125d90ff025ad3fa70403bc89de1583d7a6d9,chloetedder,2023-02-10 22:56:01+00:00,GitHub,2023-02-10 22:56:01+00:00,"[fs-detectors] Add main to test package.json files (#9416)

Fix flakey tests",2023,2
2b483b0fd0cc7cd60613fbcad26230f1de0d1cb2,Steven,2023-02-10 22:32:45+00:00,GitHub,2023-02-10 22:32:45+00:00,"[tests] Fix examples tests with shared util (#9415)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>",2023,2
fdcd86d37cf125a2f0078ccb537361d646e2323a,Sean Massa,2023-02-10 21:33:38+00:00,GitHub,2023-02-10 21:33:38+00:00,"[tests] add missing dep that used to be hoisted (#9413)

It looks like `find-up` was working before because of yarn hoisting, but not anymore. I don't know why this works sometimes and not others, though.

This module is imported from: https://github.com/vercel/vercel/blob/main/packages/cli/test/helpers/setup-fixture.ts#L1

I stuck with version `4.1.0` because that looks like the version being used before.

---

Trying to fix: https://github.com/vercel/vercel/actions/runs/4147054878/jobs/7174327469#step:9:2622",2023,2
f5280cb3752f2c02b50cd75ba56fd32d8b7ae477,Steven,2023-02-10 20:29:45+00:00,GitHub,2023-02-10 20:29:45+00:00,"[node] Fix incorrect stack trace of TS error (#9409)

### Description

TS has an option, `noEmitOnError`, that is used to either fail the build by throwing when `true` or just print the error and continuing to build when `false`.

This PR fixes the case when `noEmitOnError: false`. Previously showing an error stack trace but now it correctly shows the error message without the stack.

### Before

<img width=""1186"" alt=""image"" src=""https://user-images.githubusercontent.com/229881/218186616-9e6f04ea-0256-4ed6-8705-50e8dd5090f5.png"">

### After

<img width=""1195"" alt=""image"" src=""https://user-images.githubusercontent.com/229881/218186818-526b2b6a-599e-43e1-aa7b-7f536887730a.png"">",2023,2
26773daf05af3aa274f95fc3e506619d5be8566c,Steven,2023-02-09 14:58:37+00:00,GitHub,2023-02-09 14:58:37+00:00,"[tests] Add tests for `examples` (#9403)

These tests will run if one of the conditions is met:

- any change to `./examples`
- any changes to `./packages/frameworks`

The test ensures that examples can build and deploy without errors.

In a future PR, we could improve these tests to make requests to the
test deployment (like we do for probes).",2023,2
8087b7804e37e0eb8cdea593b6e131f4bd6d98df,Steven,2023-02-09 14:56:17+00:00,GitHub,2023-02-09 14:56:17+00:00,"[tests] Fix app-dir test assertion (#9404)

This was changed in `next@canary`",2023,2
c8690190f67702b7a9b7feb3d892c8789d18d9b6,Chris Barber,2023-02-09 05:03:52+00:00,GitHub,2023-02-09 05:03:52+00:00,"[cli] Update notification redesign (#9392)

This PR does a couple fantastic things:

1. Increases latest version check from once a week to once a day
2. Increases latest version notification from once a week to once every 3 days unless an even newer version is available
3. Update changelog link to all releases and make text an actual link
4. Redesign of the update notification to be more visible by wrapping in a box
5. Replace `boxen` (500KB) (used by `vc bisect`) with slimmed down built-in version (3.4KB)
6. Update notification appears at the end of the command regardless if an error occurred

Regular notification: displayed once every 3 days or sooner if a new release first day:

<img width=""438"" alt=""image"" src=""https://user-images.githubusercontent.com/97262/217167938-40baa1fe-2ab7-4092-a8a0-c4a968d5fc17.png"">

Same as above, but formats the notification to adapt to narrow terminals:

<img width=""389"" alt=""image"" src=""https://user-images.githubusercontent.com/97262/217170374-b3f23ffc-47cc-45ca-aa0b-1dde4fb1c66c.png"">

Whenever any command (aside from `help`) returns a non-zero exit code, show an additional message to encourage updating:

<img width=""436"" alt=""image"" src=""https://user-images.githubusercontent.com/97262/217172208-b9e24e67-669f-4403-8bf2-29f896b27f06.png"">

Linear: https://linear.app/vercel/issue/VCCLI-504/investigate-old-update-notifier-behavior",2023,2
74f6cf31fc09923ec6f6412fea7459d425fe0f7a,JJ Kasper,2023-02-09 00:45:16+00:00,JJ Kasper,2023-02-09 00:45:16+00:00,"Publish Stable

 - vercel@28.15.3
 - @vercel/gatsby-plugin-vercel-builder@1.1.3
 - @vercel/next@3.4.2
 - @vercel/static-build@1.3.5",2023,2
abd5310e58e1ebc737781f4185320ce7a3e95421,JJ Kasper,2023-02-09 00:38:18+00:00,GitHub,2023-02-09 00:38:18+00:00,"[next] Update env variable for output trace root (#9402)

Since turbo and nx only consider `NEXT_PUBLIC_` prefixed env variables for the cache key this ensures we expose variables that affect the build in that format as well so that an incompatible build cache isn't attempted to be leveraged. No additional tests were added here as this related to build cache which can't be reliably tested here. 

x-ref: [slack thread](https://vercel.slack.com/archives/C03S8ED1DKM/p1675821643786319)",2023,2
f3ef9696d76463556bd6f38c6a4234af8181f40a,Steven,2023-02-09 00:12:53+00:00,GitHub,2023-02-09 00:12:53+00:00,"[tests] Fix test for `functions` config (#9401)

This message was recently updated in the API response

- https://github.com/vercel/api/pull/17126

---------

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,2
86eb67c3becd9e687dba6e1a918456e1919307bb,Sean Massa,2023-02-08 21:41:12+00:00,GitHub,2023-02-08 21:41:12+00:00,"[examples] update Vite example lockfile (#9400)

The [Vite example update](https://github.com/vercel/vercel/pull/8362)
looked like it would install dependencies just fine because if you
navigate to `./examples/vite` and run `pnpm i --frozen-lockfile`, it
will work. If instead you copy that example outside of this repo and run
the same command, you'll get an error.

We'll fix that elsewhere, but for now, let's fix the Vite example
itself.

---

* [Failed Deployment with Current
Example](https://vercel.com/endangeredmassa/vite-new-example/5vULFx1U5ob8t7sjuTGGw9AY8xdL)
* [Successful Deployment with Updated
Example](https://vercel.com/endangeredmassa/vite-new-example/4gVTJbUAdR4BmQfoxfhUrLrXpxx5)",2023,2
1ec44ee1e360f4ff1356df4c20aab3d6324a44c8,MoskalykA,2023-02-08 17:48:06+00:00,GitHub,2023-02-08 17:48:06+00:00,"[examples] Bump Vite.js (#8362)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>
Co-authored-by: Lee Robinson <me@leerob.io>",2023,2
e24f42e9bc92ca7982644b70360f3544f80158f1,Nathan Rajlich,2023-02-08 16:15:20+00:00,GitHub,2023-02-08 16:15:20+00:00,"[gatsby-plugin-vercel-builder] Strip `assetPrefix` from `pathPrefix` (#9394)

Removes the `assetPrefix` value from the `pathPrefix` config value,
since Gatsby concats them for some reason.",2023,2
c1c8b454cc29de4bd306b87078f36d6416ceb90f,JJ Kasper,2023-02-07 19:51:17+00:00,JJ Kasper,2023-02-07 19:51:17+00:00,"Publish Stable

 - @vercel/build-utils@6.2.1
 - vercel@28.15.2
 - @vercel/client@12.3.7
 - @vercel/fs-detectors@3.7.10
 - @vercel/gatsby-plugin-vercel-builder@1.1.2
 - @vercel/go@2.3.3
 - @vercel/hydrogen@0.0.49
 - @vercel/next@3.4.1
 - @vercel/node@2.9.2
 - @vercel/python@3.1.45
 - @vercel/redwood@1.1.1
 - @vercel/remix@1.2.12
 - @vercel/ruby@1.3.61
 - @vercel/static-build@1.3.4",2023,2
e2105e47b547a21344e6e4747a30731b3b0efbd6,JJ Kasper,2023-02-07 00:57:17+00:00,GitHub,2023-02-07 00:57:17+00:00,[build-utils] Add passQuery field to Prerender (#9388),2023,2
76d58673fccd538b026bc7640ee469a93108b8ab,ÏµúÏßÄÎØº(Jeemin Choi),2023-02-06 22:45:17+00:00,GitHub,2023-02-06 22:45:17+00:00,"[cli] Add `--no-color` mode (#8826)

Co-authored-by: Sean Massa <EndangeredMassa@gmail.com>
Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,2
a585969dd3b77a4ed36d6a2ca11b34f9050489f1,Andy Bitz,2023-02-06 16:24:54+00:00,Andy Bitz,2023-02-06 16:24:54+00:00,"Publish Stable

 - @vercel/build-utils@6.2.0
 - vercel@28.15.1
 - @vercel/client@12.3.6
 - @vercel/fs-detectors@3.7.9
 - @vercel/gatsby-plugin-vercel-builder@1.1.1
 - @vercel/go@2.3.2
 - @vercel/hydrogen@0.0.48
 - @vercel/next@3.4.0
 - @vercel/node@2.9.1
 - @vercel/python@3.1.44
 - @vercel/redwood@1.1.0
 - @vercel/remix@1.2.11
 - @vercel/ruby@1.3.60
 - @vercel/static-build@1.3.3",2023,2
35eca33b443eae7ab1c553b421119f8453a99195,Andy,2023-02-06 14:46:18+00:00,GitHub,2023-02-06 14:46:18+00:00,[redwood] Consider all Lambda options (#9386),2023,2
d60815396122d9f98e9541beeecf84e5946019d5,Andy,2023-02-06 11:28:41+00:00,GitHub,2023-02-06 11:28:41+00:00,[next][build-utils] Add support for cron to vercel.json (#9374),2023,2
a4cfc5f9430d8a9393b28f5177f85417a86917a0,Bishal Shrestha,2023-02-03 23:23:20+00:00,GitHub,2023-02-03 23:23:20+00:00,[docs] Add troubleshooting step for no serverless pages error  (#9333),2023,2
2eef3e3ddbc459f507b819c3d96c6c193cefc845,chloetedder,2023-02-03 22:56:22+00:00,GitHub,2023-02-03 22:56:22+00:00,"[fs-detectors] Add fix for if monorepo and proj at root (#9353)

If there is a monorepo that has one project at the root level we want to
return commands without the relative to root prefixes

---------

Co-authored-by: Chris Barber <chris.barber@vercel.com>",2023,2
8120fd3d7a7a02de6aabc0d72e61e4ea99114dc6,Swarnava Sengupta,2023-02-03 19:12:29+00:00,GitHub,2023-02-03 19:12:29+00:00,[examples] Update Astro example to v2 (#9371),2023,2
ba498f3a8e7dc7097d34fc380f097f9a55197c90,Andy McKay,2023-02-03 17:01:02+00:00,GitHub,2023-02-03 17:01:02+00:00,"[python] Cope with duplicate header values (#9205)

There are times when a request can arrive for a Python function with headers as a list. One of those examples is this header `x-vercel-proxied-for` which apparently is set twice. Example:

`[b'x-vercel-proxied-for', [b'207.81.134.243', b'172.71.147.74']]`

I took a quick scan through the other Python server implementations and I don't think any of them manipulate the value of the HTTP headers, the way the ASGI one does so I think we are good there.

To reproduce:

`curl https://..../ -H ""foo: bar"" -H ""foo: bar""`

Will fail.

Fixes: https://github.com/vercel/vercel/issues/9132",2023,2
b5a940827266893fb5649afc539630d2de1f4821,Steven,2023-02-03 15:46:18+00:00,GitHub,2023-02-03 15:46:18+00:00,"[node] Add log for unused config runtime (#9373)

Both `runtime: undefined` and `runtime: nodejs` have the same behavior
but we want to change that in the future.

The first step is to see if `runtime: nodejs` is currently used at all.",2023,2
946f7f0bfcd939bba29da54dd4718a0adab45572,Nathan Rajlich,2023-02-02 22:29:52+00:00,GitHub,2023-02-02 22:29:52+00:00,"[remix] Remove `render` path (#9365)

Instead of outputting a single SSR function at `/render` path, scan the
build manifest file to determine the proper paths to output the SSR
function at.",2023,2
804a3863e77a72ed1c33a75783586f17dbe03ebf,Ethan Arrowood,2023-02-02 01:07:08+00:00,GitHub,2023-02-02 01:07:08+00:00,"[cli] add charset to content-type headers for `vc dev` (#9364)

Adds `charset: utf8` to the `content-type` header",2023,2
a4d16c681a7e85f64a2d78432d499c599b398bde,Andy Bitz,2023-02-01 22:26:52+00:00,Andy Bitz,2023-02-01 22:26:52+00:00,"Publish Stable

 - @vercel/build-utils@6.1.0
 - vercel@28.15.0
 - @vercel/client@12.3.5
 - @vercel/fs-detectors@3.7.8
 - @vercel/gatsby-plugin-vercel-builder@1.1.0
 - @vercel/go@2.3.1
 - @vercel/hydrogen@0.0.47
 - @vercel/next@3.3.21
 - @vercel/node@2.9.0
 - @vercel/python@3.1.43
 - @vercel/redwood@1.0.54
 - @vercel/remix@1.2.10
 - @vercel/ruby@1.3.59
 - @vercel/static-build@1.3.2
 - @vercel/static-config@2.0.12",2023,2
61bbd4f98b5fdf4f37bfc4af0d0b08aa63c6c183,Andy,2023-02-01 21:47:55+00:00,GitHub,2023-02-01 21:47:55+00:00,"[cli] Add crons to build output (#9360)

Co-authored-by: George Karagkiaouris <gkaragkiaouris2@gmail.com>
Co-authored-by: Chris Barber <chris.barber@vercel.com>
Co-authored-by: Nathan Rajlich <n@n8.io>",2023,2
fedf264862da300653e2b441ed830ff203703c1e,Nathan Rajlich,2023-02-01 20:27:36+00:00,GitHub,2023-02-01 20:27:36+00:00,"[cli] Merge build output contents instead of copying (#9358)

When Root Directory setting is used, and/or `vc build --output` is used,
do an intelligent ""merge"" (move) operation rather than copying the
contents of the build output directory to the destination. This should
overall be faster and avoid disk space issues for larger projects.",2023,2
6420e54b35ec34907bd063f2b1772d534152ceef,Nathan Rajlich,2023-02-01 20:27:24+00:00,GitHub,2023-02-01 20:27:24+00:00,"[gatsby-plugin-vercel-builder] Use `pathPrefix` from BuildArgs (#9362)

Instead of using `pathPrefix` from the Redux store, grab the value
directly from the ""BuildArgs"" passed to `onPostBuild()`. This value
seems to properly reflect whether or not `--prefix-path` mode was
enabled during the Gatsby build process.",2023,2
aa6b957b23101cff6c265bd4baa1c06a3fd1f1bd,Nathan Rajlich,2023-02-01 19:05:45+00:00,GitHub,2023-02-01 19:05:45+00:00,"[gatsby-plugin-vercel-builder] Move ""public"" dir instead of copying (#9356)

We are getting reports of some larger Gatsby projects running out of
disk space during build which seem to be the result of copying the
static directory multiple times.

So move instead of copying, which doesn't fully solve the problem, but
it does kick the can down the road a bit. Very large projects would
probably still hit the disk limit at some point. Anyways, moving is
faster than copying so this is still a net positive.",2023,2
c6717a1492f049f3b7479661fdd1f232e45a768e,Nathan Rajlich,2023-02-01 02:57:06+00:00,GitHub,2023-02-01 02:57:06+00:00,"[static-build] Add Gatsby `GENERATED_FILE_COMMENT` for non-existing config file cases (#9354)

Follow-up to #9312 which missed these two cases.",2023,2
0b33c1c3e71ec3b4e3bea69dfc91cf0a0ace9b09,Steven,2023-01-31 23:58:43+00:00,GitHub,2023-01-31 23:58:43+00:00,"[tests] Remove `actions/cache` since its actually slower than no cache (#9359)

This PR removes `actions/cache` since it is actually **slower** than no cache.

## ubuntu-latest
- [with cache](https://github.com/vercel/vercel/actions/runs/4059017971/jobs/6986950123): 21s + 3s + 1m4s = 88s
- [without cache](https://github.com/vercel/vercel/actions/runs/4059216913/jobs/6987026470): 44s

## macos-latest
- [with cache](https://github.com/vercel/vercel/actions/runs/4059017971/jobs/6986950275): 2m55s + 8s + 3m20s = 383s
- [without cache](https://github.com/vercel/vercel/actions/runs/4059216913/jobs/6987026554): 2m21s = 141s

## windows-latest
- [with cache](https://github.com/vercel/vercel/actions/runs/4059017971/jobs/6986950359): 1m10s + 6s + 3m29s = 285s
- [without cache](https://github.com/vercel/vercel/actions/runs/4059216913/jobs/6987026661): 1m25s = 85s",2023,1
dbea973546e1cb0cec3fe45d87650ced9451d2c5,Steven,2023-01-31 23:27:36+00:00,GitHub,2023-01-31 23:27:36+00:00,"[build-utils][cli] Add env vars for `VERCEL_PROJECT_SETTINGS_` (#9332)

This PR adds a few new environment variables for project settings.

This allows frameworks targeting the [Build Output API](https://vercel.com/docs/build-output-api/v3) to read data that is normally only available in through the `config` object when developing a [Builder/Runtime](https://github.com/vercel/vercel/blob/main/DEVELOPING_A_RUNTIME.md).

This will also solve the problem of old Builders/Runtimes that never passed the `config` through to `getNodeVersion()`.

- Related to https://github.com/unjs/nitro/pull/879",2023,1
8ac481470287761c7a5cbd88ddc0da3851d31750,Nathan Rajlich,2023-01-31 22:10:40+00:00,GitHub,2023-01-31 22:10:40+00:00,"[cli] Remove `.vercel/output` during `vc build --output` (#9357)

The `.vercel/output` directory gets wiped away when `--output` is _not_ being used, but it should be deleted even when the flag is being used so that build scripts targeting Build Output API directly always start with a fresh slate.",2023,1
c84d6c4355d10e87673f45f10e9190ca9b32c7f8,github-actions[bot],2023-01-31 17:20:53+00:00,GitHub,2023-01-31 17:20:53+00:00,"[examples] Upgrade Next.js to version 13.1.6 (#9334)

This auto-generated PR updates Next.js to version 13.1.6

Co-authored-by: vercel-release-bot <infra+release@vercel.com>
Co-authored-by: Steven <steven@ceriously.com>",2023,1
61b6e879876e06fb2f7932db958c10ee37806701,Steven,2023-01-31 17:06:44+00:00,GitHub,2023-01-31 17:06:44+00:00,"[tests] Add labels to cron-update-next (#9351)

See example PR: https://github.com/vercel/vercel/pull/9334",2023,1
ada9a48d57be8f4375494a369aaa98cee1f5eae2,chloetedder,2023-01-30 22:19:54+00:00,chloetedder,2023-01-30 22:19:54+00:00,"Publish Stable

 - @vercel/build-utils@6.0.1
 - vercel@28.14.1
 - @vercel/client@12.3.4
 - @vercel/fs-detectors@3.7.7
 - @vercel/gatsby-plugin-vercel-builder@1.0.3
 - @vercel/go@2.3.0
 - @vercel/hydrogen@0.0.46
 - @vercel/next@3.3.20
 - @vercel/node@2.8.17
 - @vercel/python@3.1.42
 - @vercel/redwood@1.0.53
 - @vercel/remix@1.2.9
 - @vercel/ruby@1.3.58
 - @vercel/static-build@1.3.1",2023,1
31f3daa5b48dec9956feafb1411b3b031239274e,chloetedder,2023-01-30 18:35:42+00:00,GitHub,2023-01-30 18:35:42+00:00,"[fs-detectors] getMonorepoDefaultSettings: Fix settings (#9315)

1. `commandForIgnoringBuildStep` should be run at the project directory level not the monorepo root level
2. Simplifying the `installCommand` because doesn't need the relative root unless it is `npm`",2023,1
fdf7fd6784af2fbb266e59403bc06cf604dad3ec,Steven,2023-01-30 17:08:10+00:00,GitHub,2023-01-30 17:08:10+00:00,"[go] Add support for Go 1.19 (#9343)

![image](https://user-images.githubusercontent.com/229881/215526900-fef3e4e0-d1a6-4327-b68f-d8bb9068e2a0.png)",2023,1
db216f903f4dbf3944743f0e416e6dca371ea0c7,Bryan Eaton,2023-01-30 15:42:00+00:00,GitHub,2023-01-30 15:42:00+00:00,"[tests] Fix github action restore cache timeout (#9342)

Github Action for actions/cache has an issue that could cause it to take
1 hour and then timeout while trying to restore the cache.

Since `actions/setup-node` is no longer used to restore the pnpm cache,
the `timeout-minutes: 5` doesn't do anything for this action.

Instead we need to put an env variable on the `actions/cache` Github
Action to actually set the restore cache timeout.

```
env:
  SEGMENT_DOWNLOAD_TIMEOUT_MINS: 5 # See https://github.com/actions/cache/issues/810
```

- See discussion here https://github.com/vercel/vercel/discussions/9340
- Related to actions/cache#810
- Follow up to #8639",2023,1
40a55b11d527f45da51f485246547a7b1435127b,Nathan Rajlich,2023-01-28 17:03:27+00:00,GitHub,2023-01-28 17:03:27+00:00,"[gatsby-plugin-vercel-builder] Downgrade `esbuild` to v0.14.47 (#9329)

So that there will only be one copy in the dependency tree between `@vercel/node` and `@vercel/gatsby-plugin-vercel-builder`",2023,1
5da537124ca4e9c2682c45443a336ff3d464caa7,Nathan Rajlich,2023-01-27 22:00:29+00:00,GitHub,2023-01-27 22:00:29+00:00,[static-build] Add integration test for Gatsby Function (#9330),2023,1
54aaab83aad2a63ef7d8adb30acf4ef30051f2c7,JJ Kasper,2023-01-27 21:59:42+00:00,GitHub,2023-01-27 21:59:42+00:00,"[docs] Replace references to @now/next in error docs (#9331)

It's been long enough I think we can change these to refer to
`@vercel/next` instead.

x-ref: [slack
thread](https://vercel.slack.com/archives/C03DQ3QFV7C/p1674849801196389)",2023,1
7110cb449b23d9ef2f0987afe6d5323e8a1d0dd7,Chris Barber,2023-01-27 20:07:03+00:00,GitHub,2023-01-27 20:07:03+00:00,"[go] Improved 'go build' error handling (#9320)

The `go` builder doesn't properly handle when `go build` fails. There are 2 failure scenarios:

1. The `go` binary is not found in the `PATH`. There is no message that the `go` executable was not found. Worse, the builder continues and fails trying to run the compiled executable:

![image](https://user-images.githubusercontent.com/97262/214765157-f5244467-7bc8-48e8-8fcf-385efc32b283.png)

The solution is to switch from `spawnSync()` to `execFileSync()` so that if `go` is not found, it will throw like this:

<img width=""507"" alt=""image"" src=""https://user-images.githubusercontent.com/97262/214765388-792ce59a-79f5-4bc8-8088-472969729558.png"">
Note: I temporarily changed the code to spawn `gooooo` to simulate `go` not being found. Either way, `execFileSync()` will throw and we get a helpful message.

2. The `go build` fails due to some actual build error. This should never happen, but better safe than sorry.

The solution here is to allow `go build` to inherit stdout/stderr and if `go build` should fail, we can see the output:

<img width=""574"" alt=""image"" src=""https://user-images.githubusercontent.com/97262/214765614-c414f160-ad8e-4bd2-a628-b5a91dcc88d8.png"">",2023,1
89a15681d5f51a0e9685635c03bb1d6e24ce219f,Chris Barber,2023-01-27 18:21:59+00:00,GitHub,2023-01-27 18:21:59+00:00,"[build-utils] Rewrite rename() to be more efficient (#9322)

Around 6 months ago, @styfle brought to my attention how `rename()` in build-utils used `reduce()` and could be written better. So, I rewrote it.

Before, the code would create a new `Files` object and copy the contents of the previous `Files` object. This caused heavy garbage collection and memory thrashing.

Instead, I created a single `Files` object, then add the files to it.

Results:

| # Files | Before | After |
|---|---|---|
| 1,000 | 75 ms | 1 ms |
| 10,000 | 10.6 s | 7 ms |
| 20,000 | 44.6 s | 16 ms |
| 30,000 | 105.5 s | 22 ms |
| 100,000 | Too long | 73 ms |",2023,1
9317543c48a039bda0ae91f0819f38f789d98338,Ethan Arrowood,2023-01-27 17:12:32+00:00,Ethan Arrowood,2023-01-27 17:12:32+00:00,"Publish Stable

 - vercel@28.14.0
 - @vercel/gatsby-plugin-vercel-builder@1.0.2
 - @vercel/static-build@1.3.0",2023,1
e3f326f714ac304856fb7f42666f44b9c6849e7f,Nathan Rajlich,2023-01-27 17:08:22+00:00,GitHub,2023-01-27 17:08:22+00:00,"[gatsby-plugin-vercel-builder] Don't delete `.vercel/output` (#9327)

`.vercel/output` is already made fresh when running `vc build`, so the
plugin should not be doing this. In fact, it makes the `builds.json`
file be wiped away, which we don't want to happen.",2023,1
eed6a377f1a14cf06cc6bb1e6bde6547e194d302,Ethan Arrowood,2023-01-27 16:23:02+00:00,GitHub,2023-01-27 16:23:02+00:00,"[static-build] Cleanup gatsby file changes after static-build completes (#9312)

Adds a new function that restores the user's `gatsby-config.(j|t|mj)s` and `gatsby-node.(j|t|mj)s` files",2023,1
c16d9e67849d29d5f508f8b076933ebfe29d1d5f,Nathan Rajlich,2023-01-26 20:15:58+00:00,GitHub,2023-01-26 20:15:58+00:00,"[static-build] Include Gatsby plugins as regular dependencies (#9313)

Right now, static-build will add the necessary Gatsby plugins to the project's `package.json` at build-time, which has been bothersome for package managers when using a frozen lockfile.

Another issue with it is that we install `latest` version of the plugin, so the version used becomes disjointed from the CLI version itself, which leads to unpredictability when trying to debug issues or help users roll back to a previous behavior if something breaks.

So instead of patching `package.json` directly, include the plugins as deps of static-build itself, and create symlinks to those paths into the project's `node_modules` directory.",2023,1
25f6595d3698546ba69c7fe9f601a906167fef3f,Steven,2023-01-26 16:19:03+00:00,Steven,2023-01-26 16:19:03+00:00,"Publish Stable

 - @vercel/build-utils@6.0.0
 - vercel@28.13.2
 - @vercel/client@12.3.3
 - @vercel/edge@0.2.7
 - @vercel/frameworks@1.3.0
 - @vercel/fs-detectors@3.7.6
 - @vercel/gatsby-plugin-vercel-builder@1.0.1
 - @vercel/go@2.2.31
 - @vercel/hydrogen@0.0.45
 - @vercel/next@3.3.19
 - @vercel/node@2.8.16
 - @vercel/python@3.1.41
 - @vercel/redwood@1.0.52
 - @vercel/remix@1.2.8
 - @vercel/ruby@1.3.57
 - @vercel/static-build@1.2.1",2023,1
e8385566fad2ff56efec64fd7250909789662790,JJ Kasper,2023-01-26 04:54:24+00:00,GitHub,2023-01-26 04:54:24+00:00,"[next] Ensure we warn when leveraging next export (#9319)

We currently don't make it obvious when `next export` is being leveraged which de-opts features like `middleware`, `rewrites`, `redirects`, etc. so this adds a notice to let users know when we are using `next export` output.",2023,1
52ca35252ac9c911ca78ee1117b541cf3b72761b,Ethan Arrowood,2023-01-26 03:33:18+00:00,GitHub,2023-01-26 03:33:18+00:00,"[tests] add gatsby related unit tests to static-build (#9318)

Adds some unit tests for the gatsby injection logic. 

These are net new since we've heavily changed the injection logic. The tests and fixtures in `build-fixtures` and `builds.test.js` are seemingly not executed. We may delete those here too.",2023,1
2004e3d7340ff2bcd57a52d3169d4ed364042c02,Steven,2023-01-26 00:59:39+00:00,GitHub,2023-01-26 00:59:39+00:00,"[tests] Fix jest-haste-map: Haste module naming collision (#9317)

```
jest-haste-map: Haste module naming collision: app-three
The following files share their name; please adjust your hasteImpl:
  * <rootDir>/test/fixtures/33-hybrid-monorepo/backend/app-three/package.json
  * <rootDir>/test/fixtures/34-monorepo-no-workspaces/backend/app-three/package.json
```",2023,1
49b4394c446a90600b9b17f08a51aded1e3eb478,Steven,2023-01-25 22:53:06+00:00,GitHub,2023-01-25 22:53:06+00:00,"[next] Remove hardcoded NODE_OPTIONS (#9314)

The `NODE_OPTIONS` env var value is wrong here and we shouldn't be overriding the user's setting to begin with.

Typically, it will be assigned in a build container or project settings.",2023,1
08cdfa2a057e835d13957933b8ec12a19e2031b4,Steven,2023-01-25 20:45:56+00:00,GitHub,2023-01-25 20:45:56+00:00,"[tests] Fix turbo config and bump to latest version (#9307)

We had Turborepo miscofigured. The `dependsOn: [""^build""]` means run all dependencies' build script, but it doesn't mean the package's build script will run first. For tests, it should always `dependsOn: [""build""]` (without the upcaret) instead to ensure its own build is complete before testing. I also learned that `outputs: []` can be dropped now since thats the default behavior.",2023,1
f18fa8546f73e394efcba426f2c3833c97d04d7c,Nathan Rajlich,2023-01-25 19:07:04+00:00,GitHub,2023-01-25 19:07:04+00:00,"[static-build] Patch the `gatsby-node` config file to invoke `@vercel/gatsby-plugin-vercel-builder` (#9308)

We need to ensure that `@vercel/gatsby-plugin-vercel-builder` is executed as the very last plugin, which Gatsby itself doesn't really support in the plugins listing. So instead we'll patch the `gatsby-node` file to invoke the plugin in the project's own `onPostBuild()` hook, which does get executed last. The patching is similar to how is done with the `gatsby-config` file.",2023,1
025344c4a7ecbbc580e0d901fb01f601d9089048,Swarnava Sengupta,2023-01-25 15:08:45+00:00,GitHub,2023-01-25 15:08:45+00:00,"[examples] Update Parcel version to support Node 18 (#9310)

Looks like our Parcel examples are currently failing in Node 18.x.
Updating the version which also Support Node 18.x

<img width=""814"" alt=""image""
src=""https://user-images.githubusercontent.com/1162991/214491854-92dc39a4-d7b7-442a-a16c-88621b52621a.png"">",2023,1
8b036e97eacf28d35161f65dce81ea1b561459cb,Chris Swithinbank,2023-01-25 00:05:13+00:00,GitHub,2023-01-25 00:05:13+00:00,"[frameworks] Add default immutable cache path for Astro v2 (#9305)

Astro v2 was released today. It includes [improved support for caching
all hashed build
assets](https://docs.astro.build/en/guides/upgrade-to/v2/#changed-_astro-folder-for-build-assets)
by gathering these all in a single `_astro` directory in build output
(previously these ended up in a number of different places).

This PR updates the Vercel frameworks config to provide out-of-the-box
immutable caching for these assets.

Co-authored-by: Steven <steven@ceriously.com>",2023,1
a4240e89e113c6ec238a1d8dbc09244a81122f2b,Ethan Arrowood,2023-01-24 23:37:03+00:00,GitHub,2023-01-24 23:37:03+00:00,"[gatsby-plugin-vercel-builder] add support for pathPrefix (#9294)

This pr adds support for the gatsby `pathPrefix`  properties",2023,1
0863ae0c6f98dbca841ecfbd56a24ca20894ef49,Nathan Rajlich,2023-01-24 22:10:43+00:00,GitHub,2023-01-24 22:10:43+00:00,"[gatsby-plugin-vercel-builder] Get rid of the `_ssr` function (#9304)

Right now we create the SSR serverless function at path `_ssr`, and then symlink all the other pages to that function.

Instead just make the first page encountered be the ""real"" function, and symlink all the other pages to that endpoint.",2023,1
e09d3d5928cc36ae429e3e4480df3e0ce4564451,github-actions[bot],2023-01-24 21:52:38+00:00,GitHub,2023-01-24 21:52:38+00:00,"[examples] Upgrade Next.js to version 13.1.5 (#9288)

This auto-generated PR updates Next.js to version 13.1.5",2023,1
f5f544ffd22a47b4d0e1808ab9a3130cc094a79a,Nathan Rajlich,2023-01-24 19:36:47+00:00,GitHub,2023-01-24 19:36:47+00:00,"[gatsby-plugin-vercel-builder] Merge SSR and page-data into single Serverless Function (#9292)

Previously, the page-data Serverless Function and SSR Serverless Function were two distinct functions. They had almost identical file contents and just slightly different handler logic. So here we merge the handler logic into a single function and re-use the same Serverless Function for both page-data and SSR.

This simplifies the output quite a bit and deletes a good amount of code, and helps with build output size, cold boot times, etc.",2023,1
4eb1ff87304a589e1b2946d42ac480e0a2abc9d3,Lee Robinson,2023-01-24 18:48:04+00:00,GitHub,2023-01-24 18:48:04+00:00,chore: Update Gatsby example README (#9300),2023,1
d4b604f05c8301bf76f24fc34f4a92e35e2b83e0,Chris Barber,2023-01-24 18:17:39+00:00,GitHub,2023-01-24 18:17:39+00:00,"[tests] Added cron workflow to update turbo (#9301)

Linear: https://linear.app/vercel/issue/VCCLI-450/add-cron-update-turbo-workflow

Based on the Next.js update script, this PR adds a cron job that checks for the latest Turbo canary release, then updates the `package.json` and `pnpm-lock.yaml` files.",2023,1
a3cf05af0609107b5a9f945fc7cea1a91bd8f73d,Sean Massa,2023-01-24 15:20:03+00:00,GitHub,2023-01-24 15:20:03+00:00,[tests] Update CODEOWNERS (#9277),2023,1
df2bcec8303ca0226d821d722ef6a19af846c60a,Steven,2023-01-24 09:11:14+00:00,GitHub,2023-01-24 09:11:14+00:00,"[edge] Add missing metadata to package.json (#9293)

I noticed this was missing when visiting https://www.npmjs.com/package/@vercel/edge",2023,1
f5e81273af2bb3d89a4c40029b322babf3a39b25,Nathan Rajlich,2023-01-24 05:32:03+00:00,GitHub,2023-01-24 05:32:03+00:00,"[static-build] Add Gatsby plugins as dev dependencies (#9298)

So that the test runs get invalidated by Turbo when code changes within one of the plugin files. This is to avoid a PR breaking something in a plugin, but we don't notice it because the static-build tests still ""pass"" due to cache hit.",2023,1
e75d900eafb69006e9c645df483e5e1c72481c41,Nathan Rajlich,2023-01-24 04:43:07+00:00,GitHub,2023-01-24 04:43:07+00:00,"[static-build] Use tarball URLs for Gatsby plugin E2E tests (#9297)

When running the static-build integration tests, use the tarball URL for the Gatsby plugins, so that any changes made to the plugin(s) in the PR will be reflected in the test deployments without having to publish to npm first.

Example screenshots of a deployment's build logs before I removed the debugging:

<img width=""1045"" alt=""Screenshot 2023-01-23 at 7 35 32 PM"" src=""https://user-images.githubusercontent.com/71256/214207250-24695a11-051d-4abb-a132-729ab0ab167a.png"">
<img width=""517"" alt=""Screenshot 2023-01-23 at 7 35 41 PM"" src=""https://user-images.githubusercontent.com/71256/214207254-74265e05-ed17-4fbb-b54d-9edc2234a3e4.png"">",2023,1
1a4f185045729400c2fefd189a9b15b8be3a13bf,Chris Barber,2023-01-24 01:05:44+00:00,GitHub,2023-01-24 01:05:44+00:00,"[build-utils] Removed unused execAsync() function (#9200)

This function can sometimes give a TypeScript error if @types/node says 'code' should be a `number | null` and yet the code is returns as a `number`:

```
@vercel/build-utils:build: src/fs/run-user-scripts.ts(140,13): error TS2322: Type 'number \| null' is not assignable to type 'number'.
@vercel/build-utils:build:   Type 'null' is not assignable to type 'number'.
```

I'm not sure if there are any other projects that depend on `@vercel/build-utils`, but it doesn't appear that the Vercel CLI nor the build container use this `execAsync()` function. If I'm mistaken, feel free to close this PR.

As this removal is a breaking change, setting the semver to major and not auto-merging unless others are in agreement.",2023,1
35cc7db1a727fe5afbcb98f31e688bd38081e721,Steven,2023-01-23 23:51:58+00:00,GitHub,2023-01-23 23:51:58+00:00,"[cli] add missing deprecation warnings for builders/runtimes (#9289)

We used to print deprecations on the old build pipeline but this was lost when switching to `vercel build`.

This PR ensures that `vercel build` prints deprecation warnings if available.

## Example

https://npmjs.com/package/@now/node

<img width=""751"" alt=""image"" src=""https://user-images.githubusercontent.com/229881/214143779-f71c88c8-6ee3-47ce-b459-a86154474991.png"">",2023,1
f535a20aad9b600088cbf4334ee25cd717a5a943,Nathan Rajlich,2023-01-23 21:31:49+00:00,GitHub,2023-01-23 21:31:49+00:00,[gatsby-plugin-vercel-builder] Remove `vercel.config.js` file handling (#9290),2023,1
fcea36bf044017ba7831d97d34fe83fcbc1710f4,Ethan Arrowood,2023-01-23 19:22:45+00:00,Ethan Arrowood,2023-01-23 19:22:45+00:00,"Publish Stable

 - vercel@28.13.1
 - @vercel/gatsby-plugin-vercel-analytics@1.0.7
 - @vercel/gatsby-plugin-vercel-builder@1.0.0",2023,1
93f5a4438b7d553e0f9eae83af541c14195cde71,Steven,2023-01-23 17:49:24+00:00,GitHub,2023-01-23 17:49:24+00:00,"[cli] Improve error message when using legacy `@now` builders (#8677)

This PR adds a helpful error message when using a legacy `@now` builder.

This mimics the behavior of the build-container.",2023,1
72265aa9a117e881d8ae4aab6c00d49503e7b0e3,github-actions[bot],2023-01-21 00:23:59+00:00,GitHub,2023-01-21 00:23:59+00:00,"[examples] Upgrade Next.js to version 13.1.4 (#9279)

This auto-generated PR updates Next.js to version 13.1.4

Co-authored-by: vercel-release-bot <infra+release@vercel.com>",2023,1
6ee5eb137ba6744b948506247415eaab52b5fd4a,Felix Haus,2023-01-20 23:32:04+00:00,GitHub,2023-01-20 23:32:04+00:00,"[examples] Restrict node version for gridsome example (#9275)

Gridsome was not updated for [more than 2 years](https://www.npmjs.com/package/gridsome) and still relies on Webpack 4 what makes it incompatible with >= Node.js 17.
To make the example still deployable on Vercel, this adds an engine restriction to the `package.json` for that example.

Same as #9007.",2023,1
c4f1c2f5edd44201bbd79199172d85ed398c1136,Ethan Arrowood,2023-01-20 22:31:41+00:00,GitHub,2023-01-20 22:31:41+00:00,"[gatsby-plugin-vercel-analytics] add build script (#9260)

Adds the previously omitted build script. Includes necessary changes to turbo.json too",2023,1
f35a77c2920310f6b229f2174198682b5ad38dc8,Ethan Arrowood,2023-01-20 21:15:58+00:00,GitHub,2023-01-20 21:15:58+00:00,"[gatsby-plugin-vercel-builder] support `trailingSlash` configuration (#9278)

Connects the gatsby trailingslash configuration property to our BOA3
trailingslash property",2023,1
4bf3c237ee2352b5d59f6f3d2869a6da2d082182,Andy McKay,2023-01-20 20:58:28+00:00,GitHub,2023-01-20 20:58:28+00:00,"[cli] Revert some tables back to stdout (#9227)

In https://github.com/vercel/vercel/pull/8735 some output was sent to `stderr`, this sends them `stdout` instead.",2023,1
62c991f25e7274acd54c1a89471714aed940aa5f,github-actions[bot],2023-01-20 20:39:26+00:00,GitHub,2023-01-20 20:39:26+00:00,"[examples] Upgrade Next.js to version 13.1.3 (#9271)

This auto-generated PR updates Next.js to version 13.1.3",2023,1
6ea2db4ae9782406d53bf65f353725f641a90c58,Nathan Rajlich,2023-01-20 18:49:44+00:00,GitHub,2023-01-20 18:49:44+00:00,"[gatsby-plugin-vercel-builder] Various fixes and refactoring (#9268)

* Sets a valid number of seconds for DSG expiration (10 minutes - do we want to make that configurable somehow?)
* Sets the `group` of DSG pages, so that the page-data and SSR pages are associated
* Outputs SSR/DSG pages with `/index.html` suffix so that those paths are accessible
* Updates SSR and page-data functions URL path parsing logic to handle querystrings and the `index.html` scenario
* Remove the unnecessary `rewrite` related to page-data URL paths
* Remove the page-data function static file fallback handling (they are accessible as just regular static files)
* Correct the path for the page-data endpoing when the root-level index page is SSR/DSG",2023,1
1943b1ecc0494b2c800203de23112627a27f89fc,Ethan Arrowood,2023-01-20 18:07:25+00:00,GitHub,2023-01-20 18:07:25+00:00,"[gatsby-plugin-vercel-builder] add documentation to README (#9264)

Adds some basic documentation to the plugin",2023,1
92f5b6e0c9be947a68b617d282fc39144f530813,Ethan Arrowood,2023-01-20 17:27:31+00:00,Ethan Arrowood,2023-01-20 17:27:31+00:00,"Publish Stable

 - vercel@28.13.0
 - @vercel/gatsby-plugin-vercel-builder@0.1.2
 - @vercel/next@3.3.18
 - @vercel/node@2.8.15
 - @vercel/static-build@1.2.0",2023,1
ed6ce1149a8ac46569cf489ef8e5ff6cd242da4f,JJ Kasper,2023-01-20 17:08:32+00:00,GitHub,2023-01-20 17:08:32+00:00,"[next] Ensure outputDirectory is normalized (#9269)

This ensures we normalize an absolute `outputDirectory` passed into the Next.js builder as this can cause incorrect resolving. We should probably normalize this higher up as well but this is a starting point. 

Fixes: [slack thread](https://vercel.slack.com/archives/C0289CGVAR2/p1674176040821579?thread_ts=1674168748.257019&cid=C0289CGVAR2)",2023,1
fc3611fb80e938be499c143196b2157351516019,Ethan Arrowood,2023-01-20 11:02:26+00:00,GitHub,2023-01-20 11:02:26+00:00,"[static-build] add gatsby v5 fixture (#9267)

Adds a gatsby v5 fixture using ssr and dsg to demonstrate plugin works

Co-authored-by: Nathan Rajlich <n@n8.io>",2023,1
ed33c2b27c1b6c679f03ef9a4e6d9e09cacae569,Nathan Rajlich,2023-01-20 00:05:48+00:00,GitHub,2023-01-20 00:05:48+00:00,[gatsby-plugin-vercel-builder] Remove some leftover `console.log` calls (#9265),2023,1
a7a5bf1a1293b23360833a8dc5e9286f3b41c6e9,Nathan Rajlich,2023-01-19 23:10:06+00:00,GitHub,2023-01-19 23:10:06+00:00,"[tests] Pass in builder to `runBuildLambda()` (#9262)

Removes the need for `next`/`static-build` to be present in the root `package.json` file.",2023,1
cc687b3880c2f6a05429a1618dd2314d66a03938,JJ Kasper,2023-01-19 23:03:58+00:00,GitHub,2023-01-19 23:03:58+00:00,[next] Correct RSC route for app dir with trailingSlash (#9263),2023,1
053ec92d5f0b5d278f5fd6dd6abe3974fa3ab66c,Nathan Rajlich,2023-01-19 21:39:27+00:00,GitHub,2023-01-19 21:39:27+00:00,"[node] Add build logs probe for TypeScript usage messages (#9261)

Follow-up to https://github.com/vercel/vercel/pull/9258, even though that issue seemed to only happen when linked to the monorepo locally. In any case, this test will ensure those log messages are intact for any other change around that part of the codebase in the future.",2023,1
4838dc336a578251efef73bbf110f6e8109311df,Ethan Arrowood,2023-01-19 20:07:53+00:00,GitHub,2023-01-19 20:07:53+00:00,"[static-build] run pnpm install --lockfile-only after injecting gatsby plugins (#9259)

Fixes a bug where after injecting plugins and modifying the users package.json, pnpm would fail normal install",2023,1
eae45f4019a011dbae489618e5635545c223d0cb,Nathan Rajlich,2023-01-19 13:12:31+00:00,GitHub,2023-01-19 13:12:31+00:00,"[node] Fix TypeScript built-in compiler log message check (#9258)

This check started breaking probably after the pnpm switch, so switch to a simpler solution that doesn't require comparing the paths.",2023,1
02feb564a73412ba52091e993bec42187447aff0,Ethan Arrowood,2023-01-19 03:34:47+00:00,GitHub,2023-01-19 03:34:47+00:00,"[static-build][fs-detectors] add gatsby builder plugin injection (#9252)

Modifies the `@vercel/static-build` injection logic in order to now inject both the analytics and builder gatsby plugins.",2023,1
e174a06673de32a4d0db58e9f6343db5d476e7d0,Nathan Rajlich,2023-01-18 23:19:12+00:00,Nathan Rajlich,2023-01-18 23:19:12+00:00,"Publish Stable

 - vercel@28.12.8
 - @vercel/gatsby-plugin-vercel-builder@0.1.1
 - @vercel/next@3.3.17
 - @vercel/remix@1.2.7",2023,1
de034943af3c0dd260b5f5d58dedd578fdd7a5cd,Nathan Rajlich,2023-01-18 23:10:28+00:00,GitHub,2023-01-18 23:10:28+00:00,"[gatsby-plugin-vercel-builder] Fix turbo cache outputs configuration (#9257)

The published version on npm was missing the compiled code because Turbo
was not configured to cache them properly.",2023,1
b3862271a5826b27cd6b3c65dafc58ee508e59f0,JJ Kasper,2023-01-18 21:30:30+00:00,GitHub,2023-01-18 21:30:30+00:00,"[next] Fix normalize route with middleware and basePath (#9255)

This ensures we properly match the index route when normalizing routes with `x-nextjs-data` for middleware. 

x-ref: [slack thread](https://vercel.slack.com/archives/C03S8ED1DKM/p1674034533265989)",2023,1
aaceeef604ffe432af15d5f8f315c8ebc5db98f5,Steven,2023-01-18 19:13:55+00:00,GitHub,2023-01-18 19:13:55+00:00,"[tests] Add test for `./examples/remix` (#9251)

- Related to #9249",2023,1
ad107ecf79a15082dff683855e066d0b251e9127,Steven,2023-01-18 17:35:45+00:00,GitHub,2023-01-18 17:35:45+00:00,"[tests] Split more dev tests (#9230)

This PR attempts to balance the tests so they run concurrently and therefore faster.

I also sorted the tests so they are deterministic when splitting/chunking.",2023,1
79ef5c37246c75973c0af9f5fd04afa51f0859ba,Steven,2023-01-18 13:39:44+00:00,Steven,2023-01-18 13:39:44+00:00,"Publish Stable

 - vercel@28.12.7
 - @vercel/client@12.3.2
 - @vercel/gatsby-plugin-vercel-builder@0.1.0
 - @vercel/next@3.3.16
 - @vercel/node-bridge@3.1.10
 - @vercel/node@2.8.14
 - @vercel/remix@1.2.6",2023,1
02ff265074a0b9434703e23f088a4f4305b63608,Nathan Rajlich,2023-01-18 11:24:42+00:00,GitHub,2023-01-18 11:24:42+00:00,"[remix] Fix config file dynamic import (#9249)

Follow-up to https://github.com/vercel/vercel/pull/8793, which breaks dynamic import of the config file, causing some issues for remix users: https://github.com/orgs/vercel/discussions/1282

The underlying error is `MODULE_NOT_FOUND`.

`import()` should work with `file://` URIs, however, since it's using typescript, the `import` gets compiled to `require()`, which does not support `file://` protocol scheme.

Supersedes https://github.com/vercel/vercel/pull/9248.",2023,1
ae89b8b8bee068cf9499867d6c794cb2ccc47c24,Ethan Arrowood,2023-01-18 02:24:32+00:00,GitHub,2023-01-18 02:24:32+00:00,"[gatsby-plugin-vercel-builder] Implement `@vercel/gatsby-plugin-vercel-builder` (#9218)

<picture data-single-emoji="":gatsby:"" title="":gatsby:""><img class=""emoji"" src=""https://single-emoji.vercel.app/api/emoji/eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..Dli3tTuity9MEBnK.YyaiT9ASg3XvFmlx5q0Ovkdbkto2fgJGjIJhsLcraR_hqYG0DAC6CcBMiaARcI_hF0502EnqhkrHQLeYfEoxfomLi9iKk4WBAe-oSfsENsG9oAwzYdH4LA.VMtHCMaOXNOqpB2xvph3Kg"" alt="":gatsby:"" width=""20"" height=""auto"" align=""absmiddle""></picture> 

Implement the Build Output API v3 Gatsby plugin for use within `@vercel/static-build`.

Supersedes https://github.com/vercel/vercel/pull/8259.",2023,1
4ccdcde463560dc44da89edf52523419fc56ab62,Steven,2023-01-18 00:25:26+00:00,Steven,2023-01-18 00:25:26+00:00,"Publish Stable

 - @vercel/build-utils@5.9.0
 - vercel@28.12.6
 - @vercel/client@12.3.1
 - @vercel/fs-detectors@3.7.5
 - @vercel/go@2.2.30
 - @vercel/hydrogen@0.0.44
 - @vercel/next@3.3.15
 - @vercel/node@2.8.13
 - @vercel/python@3.1.40
 - @vercel/redwood@1.0.51
 - @vercel/remix@1.2.5
 - @vercel/ruby@1.3.56
 - @vercel/static-build@1.1.7",2023,1
22d3ee160b727bc83f8f7e5f4539db86cf2ad94e,Nathan Rajlich,2023-01-18 00:21:40+00:00,GitHub,2023-01-18 00:21:40+00:00,"[build-utils] Add `includeDirectories` option to `glob()` (#9245)

Instead of always including empty directories in `glob()`, make it an
opt-in behavior because technically it's a breaking change to include
them by default.",2023,1
6d97e1673e8466cae9689cbb9f03e2a2255c2aa3,Sean Massa,2023-01-17 19:46:58+00:00,Sean Massa,2023-01-17 19:46:58+00:00,"Publish Stable

 - vercel@28.12.5
 - @vercel/client@12.3.0
 - @vercel/node-bridge@3.1.9
 - @vercel/node@2.8.12",2023,1
522565f6e5018ce0dbedeb058853bfe746581a83,Nathan Rajlich,2023-01-14 01:41:50+00:00,GitHub,2023-01-14 01:41:50+00:00,"[node-bridge] Add missing lazy dependencies (#9231)

These were missing from the compiled ncc build of `helpers.ts`, and thus causing an error at runtime because the deps are not available within the Serverless Function.",2023,1
07bf81ab102e67301bc31da98df8faa7ee5fced0,Steven,2023-01-14 00:27:14+00:00,GitHub,2023-01-14 00:27:14+00:00,"[client] Add sliding window delay when polling deployment complete (#9222)

The previous delay of 1500ms was causing some users to hit the API rate limits. This doesn't normally happen with a single deployment, but it can happen with several concurrent deployments (for example a monorepo with many projects).

We don't need to be polling so often, so this PR changed the polling delay to the following:

- During 0s-15s: check every 1 second
- During 15s-60s: check every 5 seconds
- During 1m-5m: check every 15 seconds
- During 5m-10m: check every 30 seconds",2023,1
35024a4e3af019c42d7fc5a49f60959d3c7cfd44,Steven,2023-01-13 23:53:57+00:00,GitHub,2023-01-13 23:53:57+00:00,"[tests] Split up dev tests to increase concurrency (#9228)

This will speed up CI because we can run more tests concurrently.

Co-authored-by: kodiakhq[bot] <49736102+kodiakhq[bot]@users.noreply.github.com>",2023,1
c1df9bca1997715308e22fff9449908be55724d9,Sean Massa,2023-01-13 23:24:50+00:00,GitHub,2023-01-13 23:24:50+00:00,[tests] skip private packages (#9229),2023,1
4c1cdd1f0faecd363a26c2b3b2145aa667ecaa4c,Nathan Rajlich,2023-01-13 22:24:31+00:00,GitHub,2023-01-13 22:24:31+00:00,"[client] Send empty directory entries to POST create deployment (#9118)

Update `@vercel/client` to send empty directory entries to the `POST` create deployment endpoint. This makes it so that CLI deployments will have empty directories re-populated in the build-container when doing `vc deploy`.

Follow-up to #9103.",2023,1
b5cdc82a1cca4d0b3369490f8a19fd8f8478fe94,Sean Massa,2023-01-13 21:45:03+00:00,Sean Massa,2023-01-13 21:45:03+00:00,"Publish Stable

 - @vercel/build-utils@5.8.3
 - vercel@28.12.4
 - @vercel/client@12.2.31
 - @vercel/edge@0.2.6
 - @vercel/error-utils@1.0.8
 - @vercel/frameworks@1.2.4
 - @vercel/fs-detectors@3.7.4
 - @vercel/gatsby-plugin-vercel-analytics@1.0.6
 - @vercel/go@2.2.29
 - @vercel/hydrogen@0.0.43
 - @vercel/next@3.3.14
 - @vercel/node-bridge@3.1.8
 - @vercel/node@2.8.11
 - @vercel/python@3.1.39
 - @vercel/redwood@1.0.50
 - @vercel/remix@1.2.4
 - @vercel/routing-utils@2.1.8
 - @vercel/ruby@1.3.55
 - @vercel/static-build@1.1.6
 - @vercel/static-config@2.0.11",2023,1
c7851404b34f5a9ba30e048471031246101bce96,Nathan Rajlich,2023-01-13 21:42:29+00:00,GitHub,2023-01-13 21:42:29+00:00,"[*] Remove ""workspace:"" (#9225)",2023,1
e54da8a2e5504987a956e2baaad6d817028b597f,Sean Massa,2023-01-13 21:06:45+00:00,Sean Massa,2023-01-13 21:06:45+00:00,"Publish Stable

 - @vercel/build-utils@5.8.2
 - vercel@28.12.3
 - @vercel/client@12.2.30
 - @vercel/edge@0.2.5
 - @vercel/error-utils@1.0.7
 - @vercel/frameworks@1.2.3
 - @vercel/fs-detectors@3.7.3
 - @vercel/gatsby-plugin-vercel-analytics@1.0.5
 - @vercel/go@2.2.28
 - @vercel/hydrogen@0.0.42
 - @vercel/next@3.3.13
 - @vercel/node-bridge@3.1.7
 - @vercel/node@2.8.10
 - @vercel/python@3.1.38
 - @vercel/redwood@1.0.49
 - @vercel/remix@1.2.3
 - @vercel/routing-utils@2.1.7
 - @vercel/ruby@1.3.54
 - @vercel/static-build@1.1.5
 - @vercel/static-config@2.0.10",2023,1
a066bedf952f07e4f7cbb5dd50870bfa9ee8738c,Sean Massa,2023-01-13 21:06:16+00:00,Sean Massa,2023-01-13 21:06:16+00:00,add the lockfile before commit,2023,1
09b23e53baff1f11d07a5cdef1b3d67114e3abe5,Sean Massa,2023-01-13 21:05:29+00:00,Sean Massa,2023-01-13 21:05:29+00:00,update lockfile because lerna did not do its job,2023,1
b793a6758890d12aef76c48339412b641b14c3b1,Sean Massa,2023-01-13 21:01:55+00:00,Sean Massa,2023-01-13 21:01:55+00:00,"Publish Stable

 - @vercel/build-utils@5.8.1
 - vercel@28.12.2
 - @vercel/client@12.2.29
 - @vercel/edge@0.2.4
 - @vercel/error-utils@1.0.6
 - @vercel/frameworks@1.2.2
 - @vercel/fs-detectors@3.7.2
 - @vercel/gatsby-plugin-vercel-analytics@1.0.4
 - @vercel/go@2.2.27
 - @vercel/hydrogen@0.0.41
 - @vercel/next@3.3.12
 - @vercel/node-bridge@3.1.6
 - @vercel/node@2.8.9
 - @vercel/python@3.1.37
 - @vercel/redwood@1.0.48
 - @vercel/remix@1.2.2
 - @vercel/routing-utils@2.1.6
 - @vercel/ruby@1.3.53
 - @vercel/static-build@1.1.4
 - @vercel/static-config@2.0.9",2023,1
31dd354b3ad45f0c30a381659c14b81b915a6e74,Sean Massa,2023-01-13 21:00:52+00:00,Sean Massa,2023-01-13 21:00:52+00:00,remove unnecessary checkout,2023,1
529ff3b2d7ecde2df34cc59ca9d8b4397ae62159,Sean Massa,2023-01-13 20:59:49+00:00,Sean Massa,2023-01-13 20:59:49+00:00,"add ""version"" lifecycle hook for lerna to update lockfile before commit",2023,1
e71d5638ee1c8f9f2bae396a4868928e2ef9e8a3,Sean Massa,2023-01-13 20:47:25+00:00,Sean Massa,2023-01-13 20:47:25+00:00,"Publish Stable

 - @vercel/build-utils@5.8.0
 - vercel@28.12.1
 - @vercel/client@12.2.28
 - @vercel/edge@0.2.3
 - @vercel/error-utils@1.0.5
 - @vercel/frameworks@1.2.1
 - @vercel/fs-detectors@3.7.1
 - @vercel/gatsby-plugin-vercel-analytics@1.0.3
 - @vercel/go@2.2.26
 - @vercel/hydrogen@0.0.40
 - @vercel/next@3.3.11
 - @vercel/node-bridge@3.1.5
 - @vercel/node@2.8.8
 - @vercel/python@3.1.36
 - @vercel/redwood@1.0.47
 - @vercel/remix@1.2.1
 - @vercel/routing-utils@2.1.5
 - @vercel/ruby@1.3.52
 - @vercel/static-build@1.1.3
 - @vercel/static-config@2.0.8",2023,1
8c16e765ee4562cd3d2da8856664b561a69fd5ae,Ethan Arrowood,2023-01-13 20:29:23+00:00,GitHub,2023-01-13 20:29:23+00:00,[tests] adjust root and api deps to use worskpace:* (#9223),2023,1
a008c9c7fe1a0a6b5885edaabc057c1eb5266896,Ethan Arrowood,2023-01-13 20:01:37+00:00,GitHub,2023-01-13 20:01:37+00:00,"[build-utils] Support empty directory entries for `glob()` and `download()` (#9164)

Reopening #9103 since it was reverted.",2023,1
62b28ad0b4633d8307d0dda293ba4abe2701ee18,Sean Massa,2023-01-13 20:00:46+00:00,Sean Massa,2023-01-13 20:00:46+00:00,"Publish Stable

 - @vercel/build-utils@5.7.6
 - vercel@28.12.0
 - @vercel/client@12.2.27
 - @vercel/edge@0.2.2
 - @vercel/error-utils@1.0.4
 - @vercel/frameworks@1.2.0
 - @vercel/fs-detectors@3.7.0
 - @vercel/gatsby-plugin-vercel-analytics@1.0.2
 - @vercel/go@2.2.25
 - @vercel/hydrogen@0.0.39
 - @vercel/next@3.3.10
 - @vercel/node-bridge@3.1.4
 - @vercel/node@2.8.7
 - @vercel/python@3.1.35
 - @vercel/redwood@1.0.46
 - @vercel/remix@1.2.0
 - @vercel/routing-utils@2.1.4
 - @vercel/ruby@1.3.51
 - @vercel/static-build@1.1.2
 - @vercel/static-config@2.0.7",2023,1
7c50f2916e43799635438b6f4c843f2449fb02c0,Sean Massa,2023-01-13 19:04:59+00:00,GitHub,2023-01-13 19:04:59+00:00,"[frameworks] update framework detectors with packages (#9167)

In [a different PR](https://github.com/vercel/vercel/pull/9009), detecting frameworks by package name will also provide framework version metadata to the build. Should we update these framework detectors to look up their respective packages or were they not doing that already for a reason?

I left the old detectors in place as fallbacks, which looks like:

```
some: [
  {
    path: 'package.json',
    matchContent:
      '""(dev)?(d|D)ependencies"":\\s*{[^}]*""remix"":\\s*"".+?""[^}]*}',
  },
  {
    path: 'remix.config.js',
  },
],
```

Please review carefully.",2023,1
a521dadafb1443372f33b9d442d3f1324d157362,github-actions[bot],2023-01-13 18:26:57+00:00,GitHub,2023-01-13 18:26:57+00:00,"[examples] Upgrade Next.js to version 13.1.2 (#9217)

This auto-generated PR updates Next.js to version 13.1.2

Co-authored-by: vercel-release-bot <infra+release@vercel.com>",2023,1
1efb5d6c0df08b660ad4cafc8255af1d811bc8e5,Steven,2023-01-13 17:59:49+00:00,GitHub,2023-01-13 17:59:49+00:00,"[fs-detectors] Add support for `api/**/*.tsx` zero config detection (#9216)

There are cases where you would want to use `.tsx` with Serverless Functions, such as OG Image Generation.

This PR adds zero config detection for `.tsx` file extensions and also consolidates the glob pattern into a single string matching all valid `@vercel/node` cases.

https://twitter.com/hasparus/status/1593136849404694528

https://linear.app/vercel/issue/VCCLI-322",2023,1
72df5ce8f6ac6e77f279630e32422b6affccadf2,Sean Massa,2023-01-13 17:24:00+00:00,GitHub,2023-01-13 17:24:00+00:00,"[examples][frameworks] add tests for all examples being detected (#9197)

This PR adds tests (under `packages/fs-detectors`) that ensure are `./examples` get detected as the appropriate framework.",2023,1
e20b74687f41d5abef9179e08b0a04700b68011e,Chris Barber,2023-01-13 16:25:53+00:00,GitHub,2023-01-13 16:25:53+00:00,"[docs] Updated local dev instructions in CLI readme (#9215)

When I run `pnpm`, it just prints the help screen. I need to specify the install command `pnpm i`.",2023,1
8f1358bd15e045f5f8076aef09eae9fc78c722b2,Sean Massa,2023-01-13 07:50:00+00:00,GitHub,2023-01-13 07:50:00+00:00,"[cli][frameworks][fs-detectors][next] detect framework versions (#9009)

This PR:

- updates `packages/frameworks` to have most supported frameworks specify which dependency version should reflect the overall framework version
- updates `packages/fs-detectors` to allow framework detection that returns the full `Framework` record instead of just the slug
- updates `packages/next` to return the detected Next.js version in the build result
- updates `packages/cli` to leverage these changes so that `vc build` can add `framework: { version: string; }` to `config.json` output

The result is that Build Output API and supported frameworks will return their framework version in the build result of `vc build` when possible, which is used by the build container  when creating the deployment. The dashboard later retrieves this value to display in richer deployment outputs.

Supports:

- https://github.com/vercel/api/pull/15601
- https://github.com/vercel/front/pull/18319

---

With the related build container updates, we get to see Next.js version in the build output. You'll see this with BOA+Prebuilt or a normal deploy:

<img width=""1228"" alt=""Screen Shot 2022-12-09 at 2 48 12 PM"" src=""https://user-images.githubusercontent.com/41545/206793639-f9cd3bdf-b822-45dd-9564-95b94994271d.png"">

---

### The Path to this PR

I went through all the supported frameworks and figured out how to best determine their versions. For most of them, we can check a known dependency's installed version number. 

We can get most of the way only checking npm. For a handful, we'd have to support Go/Ruby/Rust/Whatever dependencies.

I started with a more complex method signature to allow for later expansion without changing the signature. It looked like this, in practice:

```
async getVersion(dependencies: DependencyMap) => depedencies['next']
```

However, after checking all currently supported frameworks, I don't think this will end up being necessary. It also has the constraint that all dependencies have to be gathered and presented to the function even though it only needs to check for one or two. That's not a huge deal if we have them already where we need them, but we don't. We could use a variant here where this function does its own lookups, but this seemed unnecessary and would beg for duplication and small variances that could cause bugs.

Further, if we only look at `package.json`, we're going to either see a specific version of a version range. To be precise, we have to look at the installed version of the package. That means checking one of the various types of lockfiles that can exist or poking into node_modules.

If we poke into node_modules to detect the installed version, we introduce another point where Yarn 3 (default mode) will not be supported. If we read lockfiles, we have to potentially parse `npm`, `pnpm`, and `yarn` lockfiles.

If we use `npm ls <package-name>`, that also fails in Yarn 3 (default mode). We could accept that and go forward anyway, which would look like:

```
const args = `ls ${packageName} --depth=0 --json`.split(' ');
const { stdout } = await execa('npm', args, { cwd });
const regex = new RegExp(String.raw`${packageName}@([\.\d]+)`);
const matches = stdout.match(regex);
if (matches) {
  return matches[1];
}
```

But it turns out there's a `--json` option! That's what I ended up using, for now.

We could explore the lockfile route more, but after some initial digging, it' non-trivial. There are 3 main lockfiles we'd want to check for (npm, pnpm, and yarn) and there are different lockfile versions that put necessary data in different places. I looked for existing tools that parse this, but I didn't find any. We could certainly go down this path, but the effort doesn't seem worth it when `npm ls` gets us really close.

---

### Follow-up Versioning

Now that we know how to determine version per framework, we can vary configuration by version. In a future PR, we could allow a given value to vary by version number:

```
name: (version) => {
  if (semver.gt(version, '9.8.7')) {
    return 'some-framework-2''
  }

  return 'some-framework';
}
```

However, it may still be easier to differentiate significant versions by adding multiple entries in the list.",2023,1
74c0b3e1bbe8ba70e6d69f02f811c4d84ea5c003,Logan McAnsh,2023-01-13 03:26:52+00:00,GitHub,2023-01-13 03:26:52+00:00,"[remix] Add support for `.cjs` and `.mjs` extensions for ""remix.config"" (#8793)

Adds support for `remix.config.mjs` and `remix.config.cjs` and
also updates the example/fixtures to the latest version of Remix.

See: https://github.com/remix-run/remix/pull/3675",2023,1
eb0a031aeb60836552ac8eb2dc6c8e022bf71ab6,Chris Barber,2023-01-12 23:32:11+00:00,GitHub,2023-01-12 23:32:11+00:00,"[tests] Adding missing jest-matcher-utils dependency (#9214)

Fixes the following error when tests are run:

```
Cannot find module 'jest-matcher-utils' from 'test/mocks/matchers/to-output.ts'
```

Log: https://github.com/vercel/vercel/actions/runs/3898221824/jobs/6656730316#step:10:3049",2023,1
f327be2d1f9c41dc534efd28385358c0738d775a,Chris Barber,2023-01-12 22:45:21+00:00,GitHub,2023-01-12 22:45:21+00:00,[cli] Bumped get latest version test timeouts (#9213),2023,1
16a5867f6bd523bda603d916b99f2f73fd042d79,Ethan Arrowood,2023-01-12 18:01:38+00:00,GitHub,2023-01-12 18:01:38+00:00,"[fs-detectors] use project path instead of name for turbo filter (#9210)

Fixes: https://github.com/orgs/vercel/discussions/1218",2023,1
90cbd675fae752efa2fcb25d36e4185513303979,Steven,2023-01-12 02:01:16+00:00,GitHub,2023-01-12 02:01:16+00:00,"[cli] Remove `qs` dependency (#9206)

There is no need for `qs` because the query string for `teamId` is already handled here:

https://github.com/vercel/vercel/blob/5b88f673f89c44b9e91e44247e29be6bed43805a/packages/cli/src/util/client.ts#L99",2023,1
9c768b98b71cfc72e8638bf5172be88c39e8fa69,Ethan Arrowood,2023-01-11 23:35:13+00:00,GitHub,2023-01-11 23:35:13+00:00,"[tests] Migrate from yarn to pnpm (#9198)

<picture data-single-emoji="":pnpm:"" title="":pnpm:""><img class=""emoji"" src=""https://single-emoji.vercel.app/api/emoji/eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..4mJzrO94AnSn0Pue.4apgaKtTUdQ-wxNyahjdJj28u8bbXreLoTA8AGqYjLta3MrsFvbo9DsQFth4CoIkBgXFhQ5_BVcKNfYbwLg4bKzyIvItKe4OFS8AzG7Kkicz2kUUZk0.nXyK_PvHzZFGA-MQB6XHfA"" alt="":pnpm:"" width=""20"" height=""auto"" align=""absmiddle""></picture> 

yarn has become increasingly more difficult to use as the v1 we rely on no longer receives updates. pnpm is faster and is actively maintained. 

This PR migrates us to pnpm.",2023,1
4c3bc0532216f21f354623ada76b2315ef8ba519,JJ Kasper,2023-01-11 20:01:03+00:00,JJ Kasper,2023-01-11 20:01:03+00:00,"Publish Stable

 - @vercel/build-utils@5.7.5
 - vercel@28.11.1
 - @vercel/client@12.2.26
 - @vercel/fs-detectors@3.6.2
 - @vercel/gatsby-plugin-vercel-analytics@1.0.1
 - @vercel/go@2.2.24
 - @vercel/hydrogen@0.0.38
 - @vercel/next@3.3.9
 - @vercel/node@2.8.6
 - @vercel/python@3.1.34
 - @vercel/redwood@1.0.45
 - @vercel/remix@1.1.7
 - @vercel/ruby@1.3.50
 - @vercel/static-build@1.1.1",2023,1
3f47587a8b204ecc5782fde77dabcee5f1d6e7e7,JJ Kasper,2023-01-11 17:35:21+00:00,GitHub,2023-01-11 17:35:21+00:00,"[next] fix lambda creation when using edge runtime (#9204)

Co-authored-by: remorses <beats.by.morse@gmail.com>",2023,1
84f93d8af44caa64d4741c07564922a41c17911b,Nathan Rajlich,2023-01-11 10:21:42+00:00,GitHub,2023-01-11 10:21:42+00:00,"[build-utils] Support directory entries in `Lambda#createZip()` (#9201)

Adds support for empty directory entries in the Lambda `createZip()` function.",2023,1
e1aaf8080bb413fad5ad0c4c10efdd6785b09908,Chris Barber,2023-01-11 03:45:36+00:00,GitHub,2023-01-11 03:45:36+00:00,"[cli] Replace update-notifier dependency with build in (#9098)

This PR replaces the `update-notifier` dependency with a custom implementation.

There are a few reasons: the dependency is quite large, it requires ESM in order to update, can sometimes suggest an update to an older version, and used dependencies with known security issues.

The result looks like:

<img width=""768"" alt=""image"" src=""https://user-images.githubusercontent.com/97262/208452226-b7508299-f830-4d42-a96a-7646ec8227aa.png"">

Note: This PR is the successor to https://github.com/vercel/vercel/pull/8090.",2023,1
08573529674ef5a726eafa9b5754cfe0040e0320,JJ Kasper,2023-01-11 00:24:28+00:00,GitHub,2023-01-11 00:24:28+00:00,"[next] Fix dynamic routes order for app dir (#9202)

This ensures the RSC dynamic routes come before the HTML route as it's more specific and the HTML route can end up matching first unexpectedly. 

Test deployment with fix: https://discord-gmki6w031-vtest314-ijjk-testing.vercel.app/

Fixes: https://github.com/vercel/next.js/issues/44728",2023,1
f92d229a63dc6beb0f860396a862dc059145eea1,Chris Barber,2023-01-10 21:05:08+00:00,GitHub,2023-01-10 21:05:08+00:00,"[cli] Rollback team check (#9120)

https://linear.app/vercel/issue/VCCLI-377/rollback-failing-for-enterprise-teams

When running `vc rollback` for a deployment belonging to another team, the command will fail requesting the rollback. Technically, the command should have failed trying to get the deployment. This PR checks that the current team matches the deployment being rolled back.

![image](https://user-images.githubusercontent.com/97262/210431585-ffb73658-b15c-4adb-b110-a8c5e816db32.png)

This PR also cleans up a bunch of deployment related things. There were 3 functions to get a deployment and now there's just one which uses the latest v13 API. Get deployment error handling now throws instead of returning an error. The `Deployment` type definition has been updated to match the v13 response and mock deployment data was also updated.",2023,1
427a2a58cf8114d19244b635b479f0e65d37e290,Steven,2023-01-10 17:51:12+00:00,GitHub,2023-01-10 17:51:12+00:00,"[tests] Update turbo to 1.7.0-canary.9 (#9193)

Let's try out turbo canary

Co-authored-by: tknickman <tom.knickman@vercel.com>",2023,1
ccb5f301ad3690d5892c72df5bb410788637cd47,Ethan Arrowood,2023-01-10 15:22:31+00:00,GitHub,2023-01-10 15:22:31+00:00,"[static-build] @vercel/static-build to use @vercel/gatsby-plugin-vercel-analytics (#9194)

Updates the `static-build` injector to use the new plugin.

Still need to verify somehow that the newly published plugin is working as expected. It should be fine since it was a copy-paste from the previous plugin repo, but always good to verify before we break everything! 

This PR also updates the README in `@vercel/gatsby-plugin-vercel-analytics`",2023,1
721cd3afcbff994fa96704b4eb79e5f6da7ab73c,Ethan Arrowood,2023-01-09 22:53:47+00:00,Ethan Arrowood,2023-01-09 22:53:47+00:00,"Publish Stable

 - @vercel/build-utils@5.7.4
 - vercel@28.11.0
 - @vercel/client@12.2.25
 - @vercel/frameworks@1.1.18
 - @vercel/fs-detectors@3.6.1
 - @vercel/gatsby-plugin-vercel-analytics@1.0.0
 - @vercel/go@2.2.23
 - @vercel/hydrogen@0.0.37
 - @vercel/next@3.3.8
 - @vercel/node@2.8.5
 - @vercel/python@3.1.33
 - @vercel/redwood@1.0.44
 - @vercel/remix@1.1.6
 - @vercel/ruby@1.3.49
 - @vercel/static-build@1.1.0",2023,1
3c8f20047ffec7ce345e4676f1c3479b6e360060,Ethan Arrowood,2023-01-09 22:30:28+00:00,GitHub,2023-01-09 22:30:28+00:00,"Migrate gatsby-plugin-vercel to @vercel/gatsby-plugin-vercel-analytics (#9191)

This PR migrates https://github.com/vercel/gatsby-plugin-vercel to this
repo so that we can eventually integrate into our monorepo tooling.

Since it currently requires Node.js v12 to be built, I've manually
built, copied, and committed the package as it exists now so that we can
publish a stable v1 of `@vercel/gatsby-plugin-vercel-analytics`.

After work completes on adding support for Gatsby v4, I will come back
to this package and update it to Node.js v16 so that it can be
integrated properly into the repository's tooling.

üö® DO NOT SQUASH MERGE üö®",2023,1
f15988418dc11f541493c22e4cfd2af7a080993c,Ethan Arrowood,2023-01-09 22:03:22+00:00,Ethan Arrowood,2023-01-09 22:03:22+00:00,migrate gatsby-plugin-vercel to @vercel/gatsby-plugin-vercel-analytics,2023,1
5b88f673f89c44b9e91e44247e29be6bed43805a,Ethan Arrowood,2023-01-09 21:56:25+00:00,Ethan Arrowood,2023-01-09 21:56:25+00:00,"Add 'packages/gatsby-plugin-vercel-analytics/' from commit 'afa64cb2086ff1caa739eb4b585b50ed08ae8941'

git-subtree-dir: packages/gatsby-plugin-vercel-analytics
git-subtree-mainline: e28c5f9733e45883d98e63fcdf721f5bb3a38677
git-subtree-split: afa64cb2086ff1caa739eb4b585b50ed08ae8941",2023,1
e28c5f9733e45883d98e63fcdf721f5bb3a38677,Ethan Arrowood,2023-01-09 20:59:29+00:00,GitHub,2023-01-09 20:59:29+00:00,"[static-build] add support for gatsby esm config (#9183)

Adds support for auto injection into Gatsby's new ESM config format. Only injects if the `gatsby-config.mjs` is present, and continues to default generation of `gatsby-config.js`",2023,1
afa64cb2086ff1caa739eb4b585b50ed08ae8941,Tobias Lins,2023-01-09 16:27:44+00:00,GitHub,2023-01-09 16:27:44+00:00,ci: use elevated npm token (#12),2023,1
8572cc653a9695111e3d2abe18decba28e49f3d1,Douglas Parsons,2023-01-09 15:10:53+00:00,GitHub,2023-01-09 15:10:53+00:00,fix: run prettier + force new version (#11),2023,1
10841e8b0672628f47a8c80a765c011965390a40,Tobias Lins,2023-01-09 15:03:36+00:00,GitHub,2023-01-09 15:03:36+00:00,"Use GITHUB_TOKEN instead of GH_TOKEN (#10)

* Use GITHUB_TOKEN instead of GH_TOKEN

* ci: use GITHUB_TOKEN instead of GH_TOKEN",2023,1
1e13a6ca48809e07f9ce9ae1442a760a3f9af317,Mitchell Nally,2023-01-06 23:55:54+00:00,GitHub,2023-01-06 23:55:54+00:00,"[build-utils] Add fix for windows git bash to check path is set (#9163)

Co-authored-by: Chris Barber <chris.barber@vercel.com>
Co-authored-by: Steven <steven@ceriously.com>",2023,1
976e082c4417fb69ff22c7205086f349d5f30c60,Ethan Arrowood,2023-01-06 22:42:38+00:00,GitHub,2023-01-06 22:42:38+00:00,"[tests] Fix monorepo tests so they are less flaky (#9181)

This PR generates lockfiles for the various monorepo build tests and updates the package versions to their latest within the major. This should help make these tests less flaky.",2023,1
82d21f2ac8058a93c8544a07cc89aeca9eb2cf50,Steven,2023-01-06 20:22:16+00:00,GitHub,2023-01-06 20:22:16+00:00,"[tests] Update bot username/email of cron job (#9179)

Related to https://github.com/vercel/front/pull/18685",2023,1
f145540fe6f8d09aa7c5b8c542d41edc2c392c41,Grace Yun,2023-01-06 20:04:50+00:00,GitHub,2023-01-06 20:04:50+00:00,"[frameworks] Update screenshot for Next.js example (#9177)

Related issue: https://vercel.slack.com/archives/C017QMYC5FB/p1673025728939139

Updates the screenshot used for the Next.js template that shows up on the import/new project flow. The asset has been updated on Cloudinary (`/front/import/nextjs`) and this PR updates the version # of the url.",2023,1
02d15eb0c44572ee409ffe207e130d983d5b0e1f,Tobias Lins,2023-01-06 14:44:48+00:00,GitHub,2023-01-06 14:44:48+00:00,ci: bump node to 16 (#8),2023,1
0088873a6ec1ca39127cf6c54afd78c9d5e0fc42,Douglas Parsons,2023-01-06 14:30:56+00:00,GitHub,2023-01-06 14:30:56+00:00,"Upgrade semantic-release to latest (#6)

Hoping this fixes the CI failure.",2023,1
fc0e6872e51d53fffc137658c95acf2a249ec926,Steven,2023-01-05 21:27:06+00:00,Steven,2023-01-05 21:27:06+00:00,"Publish Stable

 - vercel@28.10.3
 - @vercel/frameworks@1.1.17
 - @vercel/fs-detectors@3.6.0
 - @vercel/next@3.3.7
 - @vercel/node-bridge@3.1.3
 - @vercel/node@2.8.4
 - @vercel/redwood@1.0.43
 - @vercel/remix@1.1.5
 - @vercel/static-build@1.0.46",2023,1
d800d9cd681958c7c202d8add0eee3df501711ba,Ethan Arrowood,2023-01-05 21:16:03+00:00,GitHub,2023-01-05 21:16:03+00:00,"[fs-detectors][cli] move monorepo default setting code to fs-detectors (#9101)

Makes the monorepo default setting logic reusable by API and includes a `commandForIgnoringBuildStep` setting for Turbo projects.",2023,1
9c8f6aa70f88d8ab8861954e896afd644861e11a,Steven,2023-01-05 20:37:57+00:00,GitHub,2023-01-05 20:37:57+00:00,"[tests] Replace `::set-output` with `>> $GITHUB_OUTPUT` in gh actions (#9170)

This PR fixes a deprecation warning we have been seeing in GitHub Actions for a few months. See [example](https://github.com/vercel/vercel/actions/runs/3849500423/jobs/6558559310#step:7:453).

> Warning: The `set-output` command is deprecated and will be disabled soon. Please upgrade to using Environment Files. For more information see: https://github.blog/changelog/2022-10-11-github-actions-deprecating-save-state-and-set-output-commands/",2023,1
feceeef7b70e7532cd85f1c6dfcc00474a006aeb,Steven,2023-01-05 20:25:32+00:00,GitHub,2023-01-05 20:25:32+00:00,"[node] Fix ESM output from TS source (#7954)

- Depends on https://github.com/vercel/nft/pull/297
- Fixes #7908 
- Fixes #6194 

This PR bumps `@vercel/nft` (for production) and `ts-node` (for
development) to fix ESM behavior.

Because Node.js cannot dynamically set [loader
hooks](https://nodejs.org/docs/latest-v18.x/api/esm.html#loaders) once a
process is started, I had to change the way `ts-node` is registered by
using environment variables such as `NODE_OPTIONS`. Most of the logic
for TS and ESM was pulled out of the child process and into the parent.

Co-authored-by: Ethan Arrowood <ethan.arrowood@vercel.com>",2023,1
6215c516e7ef4ae1a94041e15ef875cdad0c749d,Steven,2023-01-05 20:12:59+00:00,GitHub,2023-01-05 20:12:59+00:00,"[tests] Turbo should use full logs when listing tests (#9172)

In PR #9168, the output mode was changed so it doesnt print logs when the result is cached. However, we need the output for the dry run where we list all relevant tests. So the flag was added to that one script only to avoid this skipped problem:

![skipped](https://user-images.githubusercontent.com/229881/210870102-a597d1b9-f007-41ba-8e1d-f53aa765b740.png)",2023,1
ada1ad384022a43088c783eb8fdcb47df056a7e6,Steven,2023-01-05 18:02:05+00:00,GitHub,2023-01-05 18:02:05+00:00,"[tests] Bump turbo and update turbo.json (#9168)

This PR does a few things
- Revert https://github.com/vercel/vercel/pull/8264 because it was causing some tests not to run (for example, modifying `@vercel/build-utils` should run tests for all packages)
- Bump `turbo` to version 1.6.3
- Update [`outputMode`](https://turbo.build/repo/docs/reference/configuration#outputmode) to new-only
- Update [`dependsOn`](https://turbo.build/repo/docs/reference/configuration#dependson) to `^` to ensure all dependencies are considered",2023,1
fe184618f48b3a17db84537ac0966580df0ea6f0,Sean Massa,2023-01-05 16:29:39+00:00,GitHub,2023-01-05 16:29:39+00:00,"[frameworks] fix blitzjs detection (#9166)

The framework detectors do not support this syntax:

```
path: 'blitz.config.(js|ts)',
```

This PR fixes framework detection for ""Blitz.js (Legacy)"".",2023,1
de21cf9b629e2a3ae97450848d7be49c1d16eec8,Tobias Lins,2023-01-05 13:00:58+00:00,GitHub,2023-01-05 13:00:58+00:00,Track data also when page name cant be resolved (#5),2023,1
c9c5e148f7720b1bf8f3e87b0a8e6e0e14533f8b,Kiko Beats,2023-01-04 13:23:01+00:00,GitHub,2023-01-04 13:23:01+00:00,"[tests] use assert.strictEqual (#9162)

assert.equal is deprecated",2023,1
8115582e250cf37ac2f82a29f5eb05e0e2006fb7,Andy McKay,2023-01-04 04:11:08+00:00,GitHub,2023-01-04 04:11:08+00:00,"[frameworks] Fix vitepress screenshot (#9158)

When you are on this page, creating a project the image here is the screenshot of an example project in the `Vercel Examples` enterprise. However that was not working:

<img width=""1060"" alt=""Screen Shot 2023-01-03 at 2 26 58 PM"" src=""https://user-images.githubusercontent.com/74699/210451850-8208f42b-de43-4ac4-a1fe-b90d88fe86d8.png"">

It does this by hitting the API. In this case the problem is that there is a trailing slash on the domain name, causing the API to fail:

<img width=""477"" alt=""Screen Shot 2023-01-03 at 2 29 48 PM"" src=""https://user-images.githubusercontent.com/74699/210452032-2e32ae61-df29-48b4-b79f-93f5bcf299d3.png"">

So this removes that trailing, but I'll see if I can tighten this up as well so in the future it doesn't matter if there is a `/` there.

FYI: this passes unit tests in framework, because it passes the URL in demo through to `URL` and grabs the hostname, which strips out the `protocol` and trailing `/`. Perhaps we should do the same on front.",2023,1
3e3f92e6d3d6b746a26891b77d2bd5b0b7de9578,JJ Kasper,2023-01-04 01:26:50+00:00,GitHub,2023-01-04 01:26:50+00:00,"[next] Lock test fixture dependency (#9159)

This locks the test dependency down for this fixture since the version of Next.js doesn't support the `node:` prefixed imports added in the latest version of `isomorphic-unfetch`. 

Fixes: https://github.com/vercel/vercel/actions/runs/3833489157/jobs/6525280122#step:9:6013",2023,1
d6cccd70f28969eec48b484b0e74b0942de9b6cd,Steven,2023-01-03 22:31:50+00:00,Steven,2023-01-03 22:31:50+00:00,"Publish Stable

 - @vercel/build-utils@5.7.3
 - vercel@28.10.2
 - @vercel/client@12.2.24
 - @vercel/fs-detectors@3.5.7
 - @vercel/go@2.2.22
 - @vercel/hydrogen@0.0.36
 - @vercel/next@3.3.6
 - @vercel/node@2.8.3
 - @vercel/python@3.1.32
 - @vercel/redwood@1.0.42
 - @vercel/remix@1.1.4
 - @vercel/ruby@1.3.48
 - @vercel/static-build@1.0.45",2023,1
3a68c7349624a74972d899205d394b32148a9498,Sean Massa,2023-01-03 22:29:27+00:00,GitHub,2023-01-03 22:29:27+00:00,"[build-utils] Revert ""Support empty directory entries for `glob()` and `download()`"" (#9157)

Reverts vercel/vercel#9103

We believe the original PR is the cause of errors like:

> Error: EISDIR: illegal operation on a directory, read",2023,1
